//>>built
(function(c,d){var a,f,j,l=function(){},i=function(b){for(var a in b)return 0;return 1},k={}.toString,g=function(b){return"[object Function]"==k.call(b)},b=function(b){return"[object String]"==k.call(b)},e=function(b){return"[object Array]"==k.call(b)},h=function(b,a){if(b)for(var c=0;c<b.length;)a(b[c++])},m=function(b,a){for(var c in a)b[c]=a[c];return b},n=function(b,a){return m(Error(b),{src:"dojoLoader",info:a})},s=1,p=function(){return"_"+s++},o=function(b,a,c){return ja(b,a,c,0,o)},v=this,
K=v.document,L=K&&K.createElement("DiV"),q=o.has=function(b){return g(r[b])?r[b]=r[b](v,K,L):r[b]},r=q.cache=d.hasCache;q.add=function(b,a,c,e){(void 0===r[b]||e)&&(r[b]=a);return c&&q(b)};for(var u in c.has)q.add(u,c.has[u],0,1);o.async=1;var D=new Function("return eval(arguments[0]);");o.eval=function(b,a){return D(b+"\r\n////@ sourceURL="+a)};var z={},w=o.signal=function(b,a){var c=z[b];h(c&&c.slice(0),function(b){b.apply(null,e(a)?a:[a])})},V=o.on=function(b,a){var c=z[b]||(z[b]=[]);c.push(a);
return{remove:function(){for(var b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}}}},G=[],qa={},ka=[],$={},W=o.map={},O=[],A={},X="",M={},Y={};u={};var H=function(b){var a,c,e,h;for(a in Y)c=Y[a],(e=a.match(/^url\:(.+)/))?M["url:"+Ja(e[1],b)]=c:"*now"==a?h=c:"*noref"!=a&&(e=ra(a,b),M[e.mid]=M["url:"+e.url]=c);h&&h(J(b));Y={}},aa=function(b){return b.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(b){return"\\"+b})},ba=function(b,a){a.splice(0,a.length);for(var c in b)a.push([c,b[c],RegExp("^"+
aa(c)+"(/|$)"),c.length]);a.sort(function(b,a){return a[3]-b[3]});return a},ca=function(b){var a=b.name;a||(a=b,b={name:a});b=m({main:"main"},b);b.location=b.location?b.location:a;if(b.packageMap)W[a]=b.packageMap;if(!b.main.indexOf("./"))b.main=b.main.substring(2);$[a]=b},la=[],N=function(a,c,e){for(var d in a){if("waitSeconds"==d)o.waitms=1E3*(a[d]||0);"cacheBust"==d&&(X=a[d]?b(a[d])?a[d]:(new Date).getTime()+"":"");if("baseUrl"==d||"combo"==d)o[d]=a[d];a[d]!==r&&(o.rawConfig[d]=a[d],"has"!=d&&
q.add("config-"+d,a[d],0,c))}if(!o.baseUrl)o.baseUrl="./";/\/$/.test(o.baseUrl)||(o.baseUrl+="/");for(d in a.has)q.add(d,a.has[d],0,c);h(a.packages,ca);for(j in a.packagePaths)h(a.packagePaths[j],function(a){var c=j+"/"+a;b(a)&&(a={name:a});a.location=c;ca(a)});ba(m(W,a.map),O);h(O,function(b){b[1]=ba(b[1],[]);if("*"==b[0])O.star=b});ba(m(qa,a.paths),ka);h(a.aliases,function(a){b(a[0])&&(a[0]=RegExp("^"+aa(a[0])+"$"));G.push(a)});if(c)la.push({config:a.config});else for(d in a.config)c=Z(d,e),c.config=
m(c.config||{},a.config[d]);if(a.cache)H(),Y=a.cache,a.cache["*noref"]&&H();w("config",[a,o.rawConfig])};o.rawConfig={};N(d,1);N(c,1);N(u,1);var F=function(b){B(function(){h(b.deps,La)})},ja=function(a,c,h,d,i){var g;if(b(a)){if((g=Z(a,d,!0))&&g.executed)return g.result;throw n("undefinedModule",a);}e(a)||(N(a,0,d),a=c,c=h);if(e(a))if(a.length){for(var h="require*"+p(),f,j=[],k=0;k<a.length;)f=a[k++],j.push(Z(f,d));g=m(sa("",h,0,""),{injected:2,deps:j,def:c||l,require:d?d.require:o,gc:1});A[g.mid]=
g;F(g);var s=da&&0!="sync";B(function(){ma(g,s)});g.executed||I.push(g);y()}else c&&c();return i},J=function(b){if(!b)return o;var a=b.require;if(!a)a=function(c,e,h){return ja(c,e,h,b,a)},b.require=m(a,o),a.module=b,a.toUrl=function(a){return Ja(a,b)},a.toAbsMid=function(a){return ea(a,b)};return a},I=[],C=[],t={},ua=function(b){b.injected=1;t[b.mid]=1;b.url&&(t[b.url]=b.pack||1);ta()},oa=function(b){b.injected=2;delete t[b.mid];b.url&&delete t[b.url];i(t)&&na()},Wa=o.idle=function(){return!C.length&&
i(t)&&!I.length&&!da},Ea=function(b,a){if(a)for(var c=0;c<a.length;c++)if(a[c][2].test(b))return a[c];return 0},Ma=function(b){for(var a=[],c,e,b=b.replace(/\\/g,"/").split("/");b.length;)c=b.shift(),".."==c&&a.length&&".."!=e?(a.pop(),e=a[a.length-1]):"."!=c&&a.push(e=c);return a.join("/")},sa=function(b,a,c,e){return{pid:b,mid:a,pack:c,url:e,executed:0,def:0}},Na=function(b,c,e,d,m,l,i,f){var j,k,s,t;t=/^\./.test(b);if(/(^\/)|(\:)|(\.js$)/.test(b)||t&&!c)return sa(0,b,0,b);b=Ma(t?c.mid+"/../"+b:
b);if(/^\./.test(b))throw n("irrationalPath",b);c&&(s=Ea(c.mid,l));(s=(s=s||l.star)&&Ea(b,s[1]))&&(b=s[1]+b.substring(s[3]));c=(a=b.match(/^([^\/]+)(\/(.+))?$/))?a[1]:"";(j=e[c])?b=c+"/"+(k=a[3]||j.main):c="";var o=0;h(G,function(a){var c=b.match(a[0]);c&&0<c.length&&(o=g(a[1])?b.replace(a[0],a[1]):a[1])});if(o)return Na(o,0,e,d,m,l,i,f);if(e=d[b])return f?sa(e.pid,e.mid,e.pack,e.url):d[b];d=(s=Ea(b,i))?s[1]+b.substring(s[3]):c?j.location+"/"+k:b;/(^\/)|(\:)/.test(d)||(d=m+d);return sa(c,b,j,Ma(d+
".js"))},ra=function(b,a){return Na(b,a,$,A,o.baseUrl,O,ka)},Oa=function(b,a,c){return b.normalize?b.normalize(a,function(b){return ea(b,c)}):ea(a,c)},Pa=0,Z=function(b,a,c){var e,h;(e=b.match(/^(.+?)\!(.*)$/))?(h=Z(e[1],a,c),5===h.executed&&!h.load&&fa(h),h.load?(e=Oa(h,e[2],a),b=h.mid+"!"+(h.dynamic?++Pa+"!":"")+e):(e=e[2],b=h.mid+"!"+ ++Pa+"!waitingForPlugin"),b={plugin:h,mid:b,req:J(a),prid:e}):b=ra(b,a);return A[b.mid]||!c&&(A[b.mid]=b)},ea=o.toAbsMid=function(b,a){return ra(b,a).mid},Ja=o.toUrl=
function(b,a){var c=ra(b+"/x",a),e=c.url;return S(0===c.pid?b:e.substring(0,e.length-5))},Fa={injected:2,executed:5,def:3,result:3},P=function(b){return A[b]=m({mid:b},Fa)},Xa=P("require"),Ya=P("exports"),Qa=P("module"),va={},Ga=0,fa=function(b){var a=b.result;b.dynamic=a.dynamic;b.normalize=a.normalize;b.load=a.load;return b},Ra=function(b){var a={};h(b.loadQ,function(c){var e=Oa(b,c.prid,c.req.module),h=b.dynamic?c.mid.replace(/waitingForPlugin$/,e):b.mid+"!"+e,e=m(m({},c),{mid:h,prid:e,injected:0});
A[h]||wa(A[h]=e);a[c.mid]=A[h];oa(c);delete A[c.mid]});b.loadQ=0;var c=function(b){for(var c=b.deps||[],e=0;e<c.length;e++)(b=a[c[e].mid])&&(c[e]=b)},e;for(e in A)c(A[e]);h(I,c)},T=function(b){o.trace("loader-finish-exec",[b.mid]);b.executed=5;b.defOrder=Ga++;b.loadQ&&(fa(b),Ra(b));for(f=0;f<I.length;)I[f]===b?I.splice(f,1):f++;/^require\*/.test(b.mid)&&delete A[b.mid]},E=[],ma=function(b,a){if(4===b.executed)return o.trace("loader-circular-dependency",[E.concat(b.mid).join("->")]),!b.def||a?va:b.cjs&&
b.cjs.exports;if(!b.executed){if(!b.def)return va;var c=b.mid,e=b.deps||[],h,d=[],m=0;for(b.executed=4;m<e.length;){h=e[m++];h=h===Xa?J(b):h===Ya?b.cjs.exports:h===Qa?b.cjs:ma(h,a);if(h===va)return b.executed=0,o.trace("loader-exec-module",["abort",c]),va;d.push(h)}o.trace("loader-run-factory",[b.mid]);c=b.def;d=g(c)?c.apply(null,d):c;b.result=void 0===d&&b.cjs?b.cjs.exports:d;T(b)}return b.result},da=0,B=function(b){try{da++,b()}finally{da--}Wa()&&w("idle",[])},y=function(){da||B(function(){for(var b,
a,c=0;c<I.length;)b=Ga,a=I[c],ma(a),b!=Ga?c=0:c++})};void 0===q("dojo-loader-eval-hint-url")&&q.add("dojo-loader-eval-hint-url",1);var S=function(b){b+="";return b+(X?(/\?/.test(b)?"&":"?")+X:"")},wa=function(b){var a=b.plugin;5===a.executed&&!a.load&&fa(a);var c=function(a){b.result=a;oa(b);T(b);y()};a.load?a.load(b.prid,b.req,c):a.loadQ?a.loadQ.push(b):(a.loadQ=[b],I.unshift(a),La(a))},xa=0,Ha=0,Q=0,ya=function(b,a){q("config-stripStrict")&&(b=b.replace(/"use strict"/g,""));Q=1;b===xa?xa.call(null):
o.eval(b,q("dojo-loader-eval-hint-url")?a.url:a.mid);Q=0},La=function(b){var a=b.mid,c=b.url;if(!b.executed&&!b.injected&&!(t[a]||b.url&&(b.pack&&t[b.url]===b.pack||1==t[b.url])))if(ua(b),b.plugin)wa(b);else{var e=function(){za(b);2!==b.injected&&(oa(b),m(b,Fa),o.trace("loader-define-nonmodule",[b.url]));y()};(xa=M[a]||M["url:"+b.url])?(o.trace("loader-inject",["cache",b.mid,c]),ya(xa,b),e()):(o.trace("loader-inject",["script",b.mid,c]),Ha=b,o.injectUrl(S(c),e,b),Ha=0)}},Aa=function(b,a,c){o.trace("loader-define-module",
[b.mid,a]);if(2===b.injected)return w("error",n("multipleDefine",b)),b;m(b,{deps:a,def:c,cjs:{id:b.mid,uri:b.url,exports:b.result={},setExports:function(a){b.cjs.exports=a},config:function(){return b.config}}});for(var e=0;e<a.length;e++)a[e]=Z(a[e],b);oa(b);if(!g(c)&&!a.length)b.result=c,T(b);return b},za=function(b,a){for(var c=[],e,d;C.length;)d=C.shift(),a&&(d[0]=a.shift()),e=d[0]&&Z(d[0])||b,c.push([e,d[1],d[2]]);H(b);h(c,function(b){F(Aa.apply(null,b))})},na=l,ta=l;q.add("ie-event-behavior",
!!K.attachEvent&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var ga=function(b,a,c,e){if(q("ie-event-behavior"))return b.attachEvent(c,e),function(){b.detachEvent(c,e)};b.addEventListener(a,e,!1);return function(){b.removeEventListener(a,e,!1)}},pa=ga(window,"load","onload",function(){o.pageLoaded=1;"complete"!=K.readyState&&(K.readyState="complete");pa()}),ha=K.getElementsByTagName("script")[0],Ba=ha.parentNode;o.injectUrl=function(b,a,c){var c=c.node=K.createElement("script"),
e=ga(c,"load","onreadystatechange",function(b){var b=b||window.event,c=b.target||b.srcElement;if("load"===b.type||/complete|loaded/.test(c.readyState))e(),h(),a&&a()}),h=ga(c,"error","onerror",function(a){e();h();w("error",n("scriptError",[b,a]))});c.type="text/javascript";c.charset="utf-8";c.src=b;Ba.insertBefore(c,ha);return c};o.log=l;o.trace=l;P=function(a,c,e){var h=arguments.length,d=["require","exports","module"],m=[0,a,c];1==h?m=[0,g(a)?d:[],a]:2==h&&b(a)?m=[a,g(c)?d:[],c]:3==h&&(m=[a,c,e]);
o.trace("loader-define",m.slice(0,2));if((h=m[0]&&Z(m[0]))&&!t[h.mid])F(Aa(h,m[1],m[2]));else if(!q("ie-event-behavior")||Q)C.push(m);else{h=h||Ha;if(!h)for(a in t)if((d=A[a])&&d.node&&"interactive"===d.node.readyState){h=d;break}h?(H(h),F(Aa(h,m[1],m[2]))):w("error",n("ieDefineFailed",m[0]));y()}};P.amd={vendor:"dojotoolkit.org"};m(m(o,d.loaderPatch),c.loaderPatch);V("error",function(b){try{if(console.error(b),b instanceof Error)for(var a in b);}catch(c){}});m(o,{uid:p,cache:M,packs:$});if(!v.define)v.define=
P,v.require=o,h(la,function(b){N(b)}),V=u.deps||c.deps||d.deps,u=u.callback||c.callback||d.callback,o.boot=V||u?[V||[],u]:0})(this.dojoConfig||this.djConfig||this.require||{},{async:1,baseUrl:"./",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../frozen-editor",name:"frozen-editor"},{location:".",name:"dojo"},{location:"../dcl",main:"dcl",name:"dcl"},{location:"../frozen",main:"GameCore",name:"frozen"},
{location:"../lodash",main:"lodash",name:"lodash"},{location:"../game",main:"game",name:"game"}]});
require({cache:{"dist/game":function(){define([],1)},"game/game":function(){define("./state,./handleInput,./update,./draw,frozen/GameCore,./ui/CanvasDND,./ui/events".split(","),function(c,d,a,f,j,l){d=new j({canvasId:"canvas",handleInput:d,update:a,draw:f});c.game=d;new l;d.run()})},"game/state":function(){define(["./box","./StateManager","dojo/dom"],function(c,d,a){return new d({entities:{},jsonObjs:[],undoObjs:[],geometries:[],tool:"rectangle",toolType:"static",runSimulation:!0,showStatic:!0,box:c,
backImg:null,game:null,codeMirror:CodeMirror.fromTextArea(a.byId("output"),{theme:"frozen",matchBrackets:!0,lineWrapping:!0,mode:"application/json"})})})},"game/box":function(){define(["./ui/getGravity","frozen/box2d/Box"],function(c,d){var a=c();return new d({gravityY:a.y,gravityX:a.x})})},"game/ui/getGravity":function(){define(["dojo/dom","dojo/domReady!"],function(c){var d=c.byId("gravityX"),a=c.byId("gravityY");return function(){return{x:parseFloat(d.value,10),y:parseFloat(a.value,10)}}})},"dojo/dom":function(){define(["./sniff",
"./_base/window"],function(c,d){if(7>=c("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}var f={};f.byId=c("ie")?function(a,c){if("string"!=typeof a)return a;var f=c||d.doc,g=a&&f.getElementById(a);if(g&&(g.attributes.id.value==a||g.id==a))return g;f=f.all[a];if(!f||f.nodeName)f=[f];for(var b=0;g=f[b++];)if(g.attributes&&g.attributes.id&&g.attributes.id.value==a||g.id==a)return g}:function(a,c){return("string"==typeof a?(c||d.doc).getElementById(a):a)||null};f.isDescendant=function(a,
c){try{a=f.byId(a);for(c=f.byId(c);a;){if(a==c)return!0;a=a.parentNode}}catch(d){}return!1};c.add("css-user-select",function(a,c,d){if(!d)return!1;var a=d.style,c=["Khtml","O","ms","Moz","Webkit"],d=c.length,g="userSelect";do if("undefined"!==typeof a[g])return g;while(d--&&(g=c[d]+"UserSelect"));return!1});var j=c("css-user-select");f.setSelectable=j?function(a,c){f.byId(a).style[j]=c?"":"none"}:function(a,c){var a=f.byId(a),d=a.getElementsByTagName("*"),g=d.length;if(c)for(a.removeAttribute("unselectable");g--;)d[g].removeAttribute("unselectable");
else for(a.setAttribute("unselectable","on");g--;)d[g].setAttribute("unselectable","on")};return f})},"dojo/sniff":function(){define(["./has"],function(c){var d=navigator,a=d.userAgent,d=d.appVersion,f=parseFloat(d);c.add("air",0<=a.indexOf("AdobeAIR"));c.add("khtml",0<=d.indexOf("Konqueror")?f:void 0);c.add("webkit",parseFloat(a.split("WebKit/")[1])||void 0);c.add("chrome",parseFloat(a.split("Chrome/")[1])||void 0);c.add("safari",0<=d.indexOf("Safari")&&!c("chrome")?parseFloat(d.split("Version/")[1]):
void 0);c.add("mac",0<=d.indexOf("Macintosh"));c.add("quirks","BackCompat"==document.compatMode);c.add("ios",/iPhone|iPod|iPad/.test(a));c.add("android",parseFloat(a.split("Android ")[1])||void 0);if(!c("webkit")){0<=a.indexOf("Opera")&&c.add("opera",9.8<=f?parseFloat(a.split("Version/")[1])||f:f);0<=a.indexOf("Gecko")&&!c("khtml")&&!c("webkit")&&c.add("mozilla",f);c("mozilla")&&c.add("ff",parseFloat(a.split("Firefox/")[1]||a.split("Minefield/")[1])||void 0);if(document.all&&!c("opera"))a=parseFloat(d.split("MSIE ")[1])||
void 0,(d=document.documentMode)&&5!=d&&Math.floor(a)!=d&&(a=d),c.add("ie",a);c.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return c})},"dojo/has":function(){define(["require","module"],function(c){var d=c.has||function(){};d.add("touch","ontouchstart"in document);d.add("device-width",screen.availWidth||innerWidth);c=document.createElement("form");d.add("dom-attributes-explicit",0==c.attributes.length);d.add("dom-attributes-specified-flag",0<c.attributes.length&&40>c.attributes.length);
d.clearElement=function(a){a.innerHTML="";return a};d.normalize=function(a,c){var j=a.match(/[\?:]|[^:\?]*/g),l=0,i=function(a){var c=j[l++];if(":"==c)return 0;if("?"==j[l++]){if(!a&&d(c))return i();i(!0);return i(a)}return c||0};return(a=i())&&c(a)};d.load=function(a,c,d){a?c([a],d):d()};return d})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(c,d,a){var f={global:c.global,doc:this.document||null,body:function(a){a=a||c.doc;return a.body||a.getElementsByTagName("body")[0]},
setContext:function(a,d){c.global=f.global=a;c.doc=f.doc=d},withGlobal:function(a,d,i,k){var g=c.global;try{return c.global=f.global=a,f.withDoc.call(null,a.document,d,i,k)}finally{c.global=f.global=g}},withDoc:function(d,l,i,k){var g=f.doc,b=a("quirks"),e=a("ie"),h,m,n;try{c.doc=f.doc=d;c.isQuirks=a.add("quirks","BackCompat"==c.doc.compatMode,!0,!0);if(a("ie")&&(n=d.parentWindow)&&n.navigator)h=parseFloat(n.navigator.appVersion.split("MSIE ")[1])||void 0,(m=d.documentMode)&&5!=m&&Math.floor(h)!=
m&&(h=m),c.isIE=a.add("ie",h,!0,!0);i&&"string"==typeof l&&(l=i[l]);return l.apply(i,k||[])}finally{c.doc=f.doc=g,c.isQuirks=a.add("quirks",b,!0,!0),c.isIE=a.add("ie",e,!0,!0)}}};d.mixin(c,f);return f})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(c,d,a,f){var j,c={},l={},i={config:d,global:this,dijit:c,dojox:l},c={dojo:["dojo",i],dijit:["dijit",c],dojox:["dojox",l]},f=a.map&&a.map[f.id.match(/[^\/]+/)[0]];for(j in f)c[j]?c[j][0]=f[j]:c[j]=[f[j],{}];for(j in c)f=
c[j],f[1]._scopeName=f[0],d.noGlobals||(this[f[0]]=f[1]);i.scopeMap=c;i.baseUrl=i.config.baseUrl=a.baseUrl;i.isAsync=a.async;i.locale=d.locale;d="$Rev: 30226 $".match(/\d+/);i.version={major:1,minor:8,patch:3,flag:"",revision:d?+d[0]:NaN,toString:function(){var a=i.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(i);i.exit=function(){};i.deprecated=i.experimental=
function(){};i._hasResource={};return i})},"dojo/_base/config":function(){define(["../has","require"],function(c,d){var a={},f=d.rawConfig,j;for(j in f)a[j]=f[j];return a})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(c,d){d.add("bug-for-in-skips-shadowed",function(){for(var b in{toString:1})return 0;return 1});var a=d("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],f=a.length,
j=function(b,a,h){var d,n=0,g=c.global;if(!h)if(b.length){d=b[n++];try{h=c.scopeMap[d]&&c.scopeMap[d][1]}catch(f){}h=h||(d in g?g[d]:a?g[d]={}:void 0)}else return g;for(;h&&(d=b[n++]);)h=d in h?h[d]:a?h[d]={}:void 0;return h},l=Object.prototype.toString,i=function(b,a,c){return(c||[]).concat(Array.prototype.slice.call(b,a||0))},k=/\{([^\}]+)\}/g,g={_extraNames:a,_mixin:function(b,c,h){var m,n,g,i={};for(m in c)if(n=c[m],!(m in b)||b[m]!==n&&(!(m in i)||i[m]!==n))b[m]=h?h(n):n;if(d("bug-for-in-skips-shadowed")&&
c)for(g=0;g<f;++g)if(m=a[g],n=c[m],!(m in b)||b[m]!==n&&(!(m in i)||i[m]!==n))b[m]=h?h(n):n;return b},mixin:function(b,a){b||(b={});for(var c=1,d=arguments.length;c<d;c++)g._mixin(b,arguments[c]);return b},setObject:function(b,a,c){var d=b.split("."),b=d.pop();return(c=j(d,!0,c))&&b?c[b]=a:void 0},getObject:function(b,a,c){return j(b.split("."),a,c)},exists:function(b,a){return void 0!==g.getObject(b,!1,a)},isString:function(b){return"string"==typeof b||b instanceof String},isArray:function(b){return b&&
(b instanceof Array||"array"==typeof b)},isFunction:function(b){return"[object Function]"===l.call(b)},isObject:function(b){return void 0!==b&&(null===b||"object"==typeof b||g.isArray(b)||g.isFunction(b))},isArrayLike:function(b){return b&&void 0!==b&&!g.isString(b)&&!g.isFunction(b)&&!(b.tagName&&"form"==b.tagName.toLowerCase())&&(g.isArray(b)||isFinite(b.length))},isAlien:function(b){return b&&!g.isFunction(b)&&/\{\s*\[native code\]\s*\}/.test(""+b)},extend:function(b,a){for(var c=1,d=arguments.length;c<
d;c++)g._mixin(b.prototype,arguments[c]);return b},_hitchArgs:function(b,a){var d=g._toArray(arguments,2),m=g.isString(a);return function(){var n=g._toArray(arguments),f=m?(b||c.global)[a]:a;return f&&f.apply(b||this,d.concat(n))}},hitch:function(b,a){if(2<arguments.length)return g._hitchArgs.apply(c,arguments);a||(a=b,b=null);if(g.isString(a)){b=b||c.global;if(!b[a])throw['lang.hitch: scope["',a,'"] is null (scope="',b,'")'].join("");return function(){return b[a].apply(b,arguments||[])}}return!b?
a:function(){return a.apply(b,arguments||[])}},delegate:function(){function b(){}return function(a,c){b.prototype=a;var d=new b;b.prototype=null;c&&g._mixin(d,c);return d}}(),_toArray:d("ie")?function(){function b(b,a,c){c=c||[];for(a=a||0;a<b.length;a++)c.push(b[a]);return c}return function(a){return(a.item?b:i).apply(this,arguments)}}():i,partial:function(b){return g.hitch.apply(c,[null].concat(g._toArray(arguments)))},clone:function(b){if(!b||"object"!=typeof b||g.isFunction(b))return b;if(b.nodeType&&
"cloneNode"in b)return b.cloneNode(!0);if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp)return RegExp(b);var a,c,d;if(g.isArray(b)){a=[];for(c=0,d=b.length;c<d;++c)c in b&&a.push(g.clone(b[c]))}else a=b.constructor?new b.constructor:{};return g._mixin(a,b,g.clone)},trim:String.prototype.trim?function(b){return b.trim()}:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(b,a,c){return b.replace(c||k,g.isFunction(a)?a:function(b,c){return g.getObject(c,
!1,a)})}};g.mixin(c,g);return g})},"dojo/domReady":function(){define(["./has"],function(){function c(b){l?b(a):i.push(b)}var d=this,a=document,f={loaded:1,complete:1},j="string"!=typeof a.readyState,l=!!f[a.readyState];if(j)a.readyState="loading";if(!l){var i=[],k=[],g=function(b){b=b||d.event;if(!(l||"readystatechange"==b.type&&!f[a.readyState])){l=1;if(j)a.readyState="complete";for(;i.length;)i.shift()(a)}},b=function(b,a){b.addEventListener(a,g,!1);i.push(function(){b.removeEventListener(a,g,!1)})};
b(a,"DOMContentLoaded");b(d,"load");"onreadystatechange"in a?b(a,"readystatechange"):j||k.push(function(){return f[a.readyState]});if(k.length){var e=function(){if(!l){for(var b=k.length;b--;)if(k[b]()){g("poller");return}setTimeout(e,30)}};e()}}c.load=function(b,a,d){c(d)};return c})},"frozen/box2d/Box":function(){define(["dcl","dcl/bases/Mixer","dojo/_base/lang"],function(c,d){var a=Box2D.Common.Math.b2Vec2,f=Box2D.Dynamics.b2BodyDef,j=Box2D.Dynamics.b2Body,l=Box2D.Dynamics.b2FixtureDef,i=Box2D.Dynamics.b2World,
k=Box2D.Collision.Shapes.b2PolygonShape,g=Box2D.Collision.Shapes.b2CircleShape;return c(d,{intervalRate:60,adaptive:!1,bodiesMap:null,fixturesMap:null,jointsMap:null,b2World:null,gravityX:0,gravityY:9.8,allowSleep:!0,resolveCollisions:!1,contactListener:null,collisions:null,scale:30,constructor:function(b){if(b&&b.intervalRate)this.intervalRate=parseInt(b.intervalRate,10);this.bodiesMap={};this.fixturesMap={};this.jointsMap={};this.b2World=new i(new a(this.gravityX,this.gravityY),this.allowSleep);
this.resolveCollisions&&this.addContactListener(this.contactListener||this)},update:function(b){if(this.resolveCollisions)this.collisions={};var a=Date.now();b?this.b2World.Step(b/1E3,10,10):this.b2World.Step(this.adaptive?(a-this.lastTimestamp)/1E3:1/this.intervalRate,10,10);this.b2World.ClearForces();return Date.now()-a},getState:function(){for(var b={},a=this.b2World.GetBodyList();a;a=a.m_next)if(a.IsActive()&&"undefined"!==typeof a.GetUserData()&&null!==a.GetUserData()&&(b[a.GetUserData()]={x:a.GetPosition().x,
y:a.GetPosition().y,angle:a.GetAngle(),center:{x:a.GetWorldCenter().x,y:a.GetWorldCenter().y},linearVelocity:a.m_linearVelocity,angularVelocity:a.m_angularVelocity},this.resolveCollisions))b[a.GetUserData()].collisions=this.collisions[a.GetUserData()]||null;return b},updateExternalState:function(b){var a=this.getState(),c;for(c in a){var d=b[c];d&&!d.staticBody&&d.update(a[c])}},setBodies:function(b){for(var a in b)this.addBody(b[a]);this.ready=!0},addBody:function(b){if(!b.alreadyScaled)b.scaleShape(1/
this.scale),b.scale=this.scale;var c=new f,d=new l,i,n,s,p;d.restitution=b.restitution;d.density=b.density;d.friction=b.friction;if(b.hasOwnProperty("maskBits"))d.filter.maskBits=b.maskBits;if(b.hasOwnProperty("categoryBits"))d.filter.categoryBits=b.categoryBits;if(b.hasOwnProperty("groupIndex"))d.filter.groupIndex=b.groupIndex;c.type=b.staticBody?j.b2_staticBody:j.b2_dynamicBody;c.position.x=b.x;c.position.y=b.y;c.userData=b.id;c.angle=b.angle;c.linearDamping=b.linearDamping;c.angularDamping=b.angularDamping;
var o=this.b2World.CreateBody(c);if(b.radius)d.shape=new g(b.radius),o.CreateFixture(d);else if(b.points){n=[];for(c=0;c<b.points.length;c++)s=new a,s.Set(b.points[c].x,b.points[c].y),n[c]=s;d.shape=new k;d.shape.SetAsArray(n,n.length);o.CreateFixture(d)}else if(b.polys)for(i=0;i<b.polys.length;i++){n=b.polys[i];p=[];for(c=0;c<n.length;c++)s=new a,s.Set(n[c].x,n[c].y),p[c]=s;d.shape=new k;d.shape.SetAsArray(p,p.length);o.CreateFixture(d)}else d.shape=new k,d.shape.SetAsBox(b.halfWidth,b.halfHeight),
o.CreateFixture(d);this.bodiesMap[b.id]=o},setPosition:function(b,c,d){this.bodiesMap[b].SetPosition(new a(c,d))},setAngle:function(b,a){this.bodiesMap[b].SetAngle(a)},setLinearVelocity:function(b,c,d){this.bodiesMap[b].SetLinearVelocity(new a(c,d))},applyImpulseDegrees:function(b,c,d){b=this.bodiesMap[b];b.ApplyImpulse(new a(Math.sin(c*(Math.PI/180))*d,-1*Math.cos(c*(Math.PI/180))*d),b.GetWorldCenter())},applyForceDegrees:function(b,c,d){b=this.bodiesMap[b];b.ApplyForce(new a(Math.sin(c*(Math.PI/
180))*d,-1*Math.cos(c*(Math.PI/180))*d),b.GetWorldCenter())},applyImpulse:function(b,c,d){b=this.bodiesMap[b];b.ApplyImpulse(new a(Math.sin(c)*d,-1*Math.cos(c)*d),b.GetWorldCenter())},applyForce:function(b,c,d){b=this.bodiesMap[b];b.ApplyForce(new a(Math.sin(c)*d,-1*Math.cos(c)*d),b.GetWorldCenter())},applyTorque:function(b,a){this.bodiesMap[b].ApplyTorque(a)},setGravity:function(b){this.b2World.SetGravity(new a(b.x,b.y))},removeBody:function(b){this.bodiesMap[b]&&(this.fixturesMap[b]&&this.bodiesMap[b].DestroyFixture(this.fixturesMap[b]),
this.b2World.DestroyBody(this.bodiesMap[b]),delete this.bodiesMap[b])},wakeUpBody:function(b){this.bodiesMap[b]&&this.bodiesMap[b].SetAwake(!0)},addContactListener:function(b){var a=new Box2D.Dynamics.b2ContactListener;if(b.beginContact)a.BeginContact=function(a){b.beginContact(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData())};if(b.EndContact)a.endContact=function(a){b.endContact(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData())};if(b.postSolve)a.PostSolve=
function(a,c){b.postSolve(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData(),c.normalImpulses[0])};this.b2World.SetContactListener(a)},destroyJoint:function(b){this.jointsMap[b]&&(this.b2World.DestroyJoint(this.jointsMap[b]),delete this.jointsMap[b])},addJoint:function(b){if(b&&b.id&&!this.jointsMap[b.id]){var a=b.createB2Joint(this);a&&(this.jointsMap[b.id]=a)}},beginContact:function(){},endContact:function(){},postSolve:function(b,a,c){this.collisions[b]=this.collisions[b]||
[];this.collisions[b].push({id:a,impulse:c});this.collisions[a]=this.collisions[a]||[];this.collisions[a].push({id:b,impulse:c})}})})},"dcl/dcl":function(){(function(c){"undefined"!=typeof define?define(["./mini"],c):"undefined"!=typeof module?module.exports=c(require("./mini")):dcl=c(dcl)})(function(c){function d(){}function a(a,c,f){var g=a||d,b=c||d,e=f||d,h=function(){var a;g.apply(this,arguments);try{a=e.apply(this,arguments)}catch(c){a=c}b.call(this,arguments,a);if(a instanceof Error)throw a;
return a};h.advices={b:a,a:c,f:f};return h}function f(a){return function(d,f){var g=d._m,b;g&&((b=+g.w[f]||0)&&b!=a&&c._e("set chaining",f,d,a,b),g.w[f]=a)}}var j=c(c.Super,{constructor:function(){this.b=this.f.before;this.a=this.f.after;this.f=this.f.around}});c.mix(c,{Advice:j,advise:function(a){return new j(a)},before:function(a){return new j({before:a})},after:function(a){return new j({after:a})},around:c.superCall,chainBefore:f(1),chainAfter:f(2),isInstanceOf:function(a,c){if(a instanceof c)return!0;
var d=a.constructor._m,f;if(d)for(d=d.b,f=d.length-1;0<=f;--f)if(d[f]===c)return!0;return!1},_sb:function(d,f,j,g){var g=g[j]=c._ec(f,j,"f"),b=c._ec(f,j,"b").reverse(),f=c._ec(f,j,"a"),g=d?c._st(g,1==d?function(a){return c._sc(a.reverse())}:c._sc,j):c._ss(g,j);return!b.length&&!f.length?g||function(){}:a(c._sc(b),c._sc(f),g)}});return c})},"dcl/mini":function(){(function(c){"undefined"!=typeof define?define([],c):"undefined"!=typeof module?module.exports=c():dcl=c()})(function(){function c(b,d){var e=
[0],h,i,m,k,q,r,u,D,z=0,w;if(b)if(b instanceof Array){k={};u=b.slice(0).reverse();for(D=u.length-1;0<=D;--D)if(i=u[D],i._u=i._u||f++,h=i._m){for(r=h.b,z=r.length-1;0<z;--z)w=r[z]._u,k[w]=(k[w]||0)+1;u[D]=r.slice(0)}else u[D]=[i];q={};a:for(;u.length;){for(D=0;D<u.length;++D)if(r=u[D],i=r[0],w=i._u,!k[w]){q[w]||(e.push(i),q[w]=1);r.shift();r.length?--k[r[0]._u]:u.splice(D,1);continue a}c._e("cycle",d,u)}b=b[0];z=e.length-((k=b._m)&&b===e[e.length-(z=k.b.length)]?z:1)-1}else b._u=b._u||f++,e=e.concat((k=
b._m)?k.b:b);h=b?c.delegate(b[l]):{};for(r=b&&(k=b._m)?c.delegate(k.w):{constructor:2};0<z;--z)if(i=e[z],k=i._m,g(h,k&&k.h||i[l]),k)for(w in u=k.w)r[w]=(+r[w]||0)|u[w];for(w in d)a(k=d[w])?r[w]=+r[w]||0:h[w]=k;q={b:e,h:d,w:r,c:{}};e[0]={_m:q,prototype:h};i=h;k=q.w;r=q.b;u=q.c;for(m in k)i[m]=c._sb(k[m],r,m,u);m=h[j];m._m=q;m[l]=h;e[0]=m;return c._p(m)}function d(b){this.f=b}function a(b){return b instanceof d}var f=0,j="constructor",l="prototype",i=function(){},k={},g,b,e,h,m;(g=function(b,a){for(var c in a)b[c]=
a[c]})(c,{mix:g,delegate:function(b){i[l]=b;b=new i;i[l]=null;return b},Super:d,superCall:function(b){return new d(b)},_p:function(b){return b},_e:function(b){throw Error("dcl: "+b);},_f:function(b,a){var c=b.f(a);c.ctr=b.ctr;return c},_ec:b=function(b,c,d){for(var e=b.length-1,h=[],f,g,i="f"==d;f=b[e];--e)if((g=f._m)?(g=g.h).hasOwnProperty(c)&&(a(g=g[c])?i?g.f:g=g[d]:i):i&&(g=f[l][c])&&g!==k[c])g.ctr=f,h.push(g);return h},_sc:h=function(b){var a=b.length,c;return!a?0:1==a?(c=b[0],function(){c.apply(this,
arguments)}):function(){for(var c=0;c<a;++c)b[c].apply(this,arguments)}},_ss:e=function(b,d){for(var e=0,h,f=k[d];h=b[e];++e)f=a(h)?b[e]=c._f(h,f,d):h;return d!=j?f:function(){f.apply(this,arguments)}},_st:m=function(b,d,e){for(var h=0,f,g,i=0;f=b[h];++h)a(f)&&(g=h-i,b[h]=c._f(f,!g?0:1==g?b[i]:d(b.slice(i,h)),e),i=h);g=h-i;return!g?0:1==g&&e!=j?b[i]:d(i?b.slice(i):b)},_sb:function(a,c,d,f){c=f[d]=b(c,d,"f");return(a?m(c,h,d):e(c,d))||function(){}}});return c})},"dcl/bases/Mixer":function(){(function(c){"undefined"!=
typeof define?define(["../mini"],c):"undefined"!=typeof module?module.exports=c(require("../mini")):dclBasesMixer=c(dcl)})(function(c){return c(null,{declaredClass:"dcl/bases/Mixer",constructor:function(d){c.mix(this,d)}})})},"game/StateManager":function(){define(["dcl","dcl/bases/Mixer"],function(c,d){return c(d,{})})},"game/handleInput":function(){define("./state,./createBodies,./createJSON/main,./utils/insideCanvas,dojo/dom,frozen/utils".split(","),function(c,d,a,f,j,l){var i=j.byId("xdisp"),k=
j.byId("ydisp"),g;return function(b){if(b.mouseAction.position)i.innerHTML=b.mouseAction.position.x,k.innerHTML=b.mouseAction.position.y;if(b.mouseAction.isPressed()&&f(b.mouseAction.startPosition,this)&&!g)g=b.mouseAction.startPosition,c.geometries.push(g);if(!b.mouseAction.isPressed()&&b.mouseAction.endPosition&&g){g=b.mouseAction.endPosition;if(!("polygon"===c.tool&&10!==c.geometries.length&&(1>=c.geometries.length||4<l.distance(c.geometries[0],g))))c.geometries.push(g),c.jsonObjs.push(a[c.tool](c.geometries)),
d(),c.geometries=[],b.mouseAction.endPosition=null;g=null}}})},"game/createBodies":function(){define("./state,./Entities,./ui/getGravity,./ui/displayJSON,./ui/toggleUndo,lodash,dojo/dom-class,frozen/box2d/Box".split(","),function(c,d,a,f,j,l,i,k){var g=0;return function(){var b=!1,e=a();c.box=new k({gravityX:e.x,gravityY:e.y});c.entities={};(e=l.chain(c.jsonObjs).map(function(b){b=parseInt(b.id,10);return"undefined"===typeof b||null===b||isNaN(b)?-1:b}).max().value())&&(g=e+1);l.forEach(c.jsonObjs,
function(a){if(!a.staticBody&&!a.zone)a.color=a.color||"rgba(0,255,0,0.4)";if(a.zone)a.color=a.color||"rgba(255,0,0,0.2)";if("undefined"===typeof a.id||null===a.id)a.id=g,g++;if(c.entities[a.id])b=!0;else{var e=new d[a.type](a);c.entities[a.id]=e;a.zone||c.box.addBody(e)}});b?i.remove("duplicate-ids","hide"):i.add("duplicate-ids","hide");f(c.jsonObjs);j()}})},"game/Entities":function(){define(["frozen/box2d/RectangleEntity","frozen/box2d/PolygonEntity","frozen/box2d/CircleEntity"],function(c,d,a){return{Rectangle:c,
Polygon:d,Circle:a}})},"frozen/box2d/RectangleEntity":function(){define(["dcl","dcl/bases/Mixer","./Entity"],function(c,d,a){return c([d,a],{halfWidth:1,halfHeight:1,draw:c.superCall(function(a){return function(c,d){var d=d||this.scale||1,i=c.lineWidth;c.lineWidth=this.lineWidth;c.save();c.translate(this.x*d,this.y*d);c.rotate(this.angle);c.translate(-this.x*d,-this.y*d);c.fillStyle=this.color;c.strokeStyle=this.strokeColor;c.fillRect((this.x-this.halfWidth)*d,(this.y-this.halfHeight)*d,2*this.halfWidth*
d,2*this.halfHeight*d);c.strokeRect((this.x-this.halfWidth)*d,(this.y-this.halfHeight)*d,2*this.halfWidth*d,2*this.halfHeight*d);c.restore();c.lineWidth=i;a.apply(this,[c,d])}}),scaleShape:c.superCall(function(a){return function(c){this.halfHeight*=c;this.halfWidth*=c;a.apply(this,[c])}}),pointInShape:function(a){return a.x>=this.x-this.halfWidth&&a.x<=this.x+this.halfWidth&&a.y>=this.y-this.halfHeight&&a.y<=this.y+this.halfHeight}})})},"frozen/box2d/Entity":function(){define(["dcl","dcl/bases/Mixer",
"dojo/_base/lang"],function(c,d,a){return c(d,{id:0,x:0,y:0,scale:null,angle:0,center:null,restitution:0.3,density:1,friction:0.9,linearDamping:0,linearVelocity:null,angularVelocity:0,angularDamping:0,staticBody:!1,color:"rgba(128,128,128,0.5)",strokeColor:"#000",lineWidth:1,hidden:!1,maskBits:null,categoryBits:null,groupIndex:null,update:function(c){a.mixin(this,c)},draw:function(a,c){var c=c||this.scale||1,d=a.lineWidth;a.lineWidth=this.lineWidth;a.fillStyle=this.strokeColor;a.beginPath();a.arc(this.x*
c,this.y*c,4,0,2*Math.PI,!0);a.closePath();a.fill();if(this.center)a.fillStyle="yellow",a.beginPath(),a.arc(this.center.x*c,this.center.y*c,2,0,2*Math.PI,!0),a.closePath(),a.fill();a.lineWidth=d},scaleShape:function(a){this.x*=a;this.y*=a;this.alreadyScaled=!0}})})},"frozen/box2d/PolygonEntity":function(){define("dcl,dcl/bases/Mixer,./Entity,../utils/scalePoints,../utils/pointInPolygon,../utils/translatePoints".split(","),function(c,d,a,f,j,l){return c([d,a],{points:[],draw:c.superCall(function(a){return function(c,
d){var d=d||this.scale||1,b=c.lineWidth;c.lineWidth=this.lineWidth;c.save();c.translate(this.x*d,this.y*d);c.rotate(this.angle);c.translate(-this.x*d,-this.y*d);c.fillStyle=this.color;c.strokeStyle=this.strokeColor;c.beginPath();c.moveTo((this.x+this.points[0].x)*d,(this.y+this.points[0].y)*d);for(var e=1;e<this.points.length;e++)c.lineTo((this.points[e].x+this.x)*d,(this.points[e].y+this.y)*d);c.lineTo((this.x+this.points[0].x)*d,(this.y+this.points[0].y)*d);c.closePath();c.fill();c.stroke();c.restore();
c.lineWidth=b;a.apply(this,[c,d])}}),scaleShape:c.superCall(function(a){return function(c){this.points=f(this.points,c);a.apply(this,[c])}}),pointInShape:function(a){return j(a,l(this.points,this))}})})},"frozen/utils/scalePoints":function(){define(["dojo/_base/lang"],function(c){var d=function(a,f){if(c.isArray(a)){var j=[];a.forEach(function(a){j.push(d(a,f))});a=j}else a="object"===typeof f?{x:a.x*f.x,y:a.y*f.y}:{x:a.x*f,y:a.y*f};return a};return d})},"frozen/utils/pointInPolygon":function(){define(function(){return function(c,
d){if(!c||!d)return!1;for(var a=d.points||d,f=!1,j=a.length-1,l=0;l<a.length;j=l++){var i=a[l].x,k=a[l].y,g=a[j].x,j=a[j].y;k>c.y!==j>c.y&&c.x<(g-i)*(c.y-k)/(j-k)+i&&(f=!f)}return f}})},"frozen/utils/translatePoints":function(){define(["dojo/_base/lang"],function(c){var d=function(a,f){if(c.isArray(a)){var j=[];a.forEach(function(a){j.push(d(a,f))});a=j}else a={x:a.x,y:a.y},f.hasOwnProperty("x")&&(a.x+=f.x),f.hasOwnProperty("y")&&(a.y+=f.y);return a};return d})},"frozen/box2d/CircleEntity":function(){define(["dcl",
"dcl/bases/Mixer","./Entity","../utils/distance"],function(c,d,a,f){return c([d,a],{radius:1,draw:c.superCall(function(a){return function(c,d){var d=d||this.scale||1,f=c.lineWidth;c.lineWidth=this.lineWidth;c.fillStyle=this.color;c.strokeStyle=this.strokeColor;c.beginPath();c.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI,!0);c.closePath();c.fill();c.stroke();this.staticBody||(c.save(),c.translate(this.x*d,this.y*d),c.rotate(this.angle),c.translate(-this.x*d,-this.y*d),c.beginPath(),c.moveTo(this.x*
d,this.y*d),c.lineTo(this.x*d,this.y*d-this.radius*d),c.closePath(),c.stroke(),c.restore());c.lineWidth=f;a.apply(this,[c,d])}}),scaleShape:c.superCall(function(a){return function(c){this.radius*=c;a.apply(this,[c])}}),pointInShape:function(a){return f(a,this)<=this.radius}})})},"frozen/utils/distance":function(){define(function(){return function(c,d){return Math.sqrt((d.x-c.x)*(d.x-c.x)+(d.y-c.y)*(d.y-c.y))}})},"game/ui/displayJSON":function(){define(["../state","dojo/dom"],function(c){return function(d){c.codeMirror.setValue(JSON.stringify({objs:d,
canvas:{height:c.game?c.game.height:null,width:c.game?c.game.width:null},backImg:c.backImg?c.backImg.src:null},null,"  "))}})},"game/ui/toggleUndo":function(){define(["../state","dojo/dom"],function(c,d){var a=d.byId("undoBtn");return function(){a.disabled=c.jsonObjs.length?!1:!0}})},"lodash/lodash":function(){(function(c,d){function a(b){if(b&&b.__wrapped__)return b;if(!(this instanceof a))return new a(b);this.__wrapped__=b}function f(a,b,c){b||(b=0);var d=a.length,e=d-b>=(c||Wa);if(e)for(var h=
{},c=b-1;++c<d;){var f=a[c]+"";(E.call(h,f)?h[f]:h[f]=[]).push(a[c])}return function(c){if(e){var d=c+"";return E.call(h,d)&&-1<H(h[d],c)}return-1<H(a,c,b)}}function j(a){return a.charCodeAt(0)}function l(a,b){var c=a.index,e=b.index,a=a.criteria,b=b.criteria;if(a!==b){if(a>b||a===d)return 1;if(a<b||b===d)return-1}return c<e?-1:1}function i(a,b,c){function d(){var i=arguments,m=f?this:b;e||(a=b[g]);c.length&&(i=i.length?c.concat(B.call(i)):c);return this instanceof d?(h.prototype=a.prototype,m=new h,
i=a.apply(m,i),r(i)?i:m):a.apply(m,i)}var e=q(a),f=!c,g=b;f&&(c=b);e||(b=a);return d}function k(a,b){return!a?N:"function"!=typeof a?function(b){return b[a]}:b!==d?function(c,d,e){return a.call(b,c,d,e)}:a}function g(){for(var a={arrayLoop:"",bottom:"",hasDontEnumBug:Va,isKeysFast:lb,objectLoop:"",noArgsEnum:cb,noCharByIndex:db,shadowed:Qa,top:"",useHas:!0},b,c=0;b=arguments[c];c++)for(var d in b)a[d]=b[d];b=a.args;a.firstArg=/^[^,]+/.exec(b)[0];return Function("createCallback, hasOwnProperty, isArguments, isString, objectTypes, nativeKeys, propertyIsEnumerable",
"return function("+b+") {\n"+fb(a)+"\n}")(k,E,n,u,gb,Q,da)}function b(a){return"\\"+nb[a]}function e(a){return hb[a]}function h(){}function m(a){return ob[a]}function n(a){return y.call(a)==za}function s(a){var b=!1;if(!(a&&"object"==typeof a)||n(a))return b;var c=a.constructor;if((!eb||!("function"!=typeof a.toString&&"string"==typeof(a+"")))&&(!q(c)||c instanceof c)){if(bb)return Ca(a,function(a,c,d){b=!E.call(d,c);return!1}),!1===b;Ca(a,function(a,c){b=c});return!1===b||E.call(a,b)}return b}function p(a){var b=
[];ia(a,function(a,c){b.push(c)});return b}function o(a,b,c,d,e){if(null==a)return a;c&&(b=!1);if(c=r(a)){var h=y.call(a);if(!R[h]||Ka&&n(a))return a;var f=h==na,c=f||(h==ha?Ta(a):c)}if(!c||!b)return c?f?B.call(a):Za({},a):a;c=a.constructor;switch(h){case ta:case ga:return new c(+a);case pa:case Da:return new c(a);case Ba:return c(a.source,Pa.exec(a))}d||(d=[]);e||(e=[]);for(h=d.length;h--;)if(d[h]==a)return e[h];var g=f?c(a.length):{};d.push(a);e.push(g);(f?x:ia)(a,function(a,c){g[c]=o(a,b,null,
d,e)});return g}function v(a){var b=[];Ca(a,function(a,c){q(a)&&b.push(c)});return b.sort()}function K(a){var b={};ia(a,function(a,c){b[a]=c});return b}function L(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;var e=y.call(a);if(e!=y.call(b))return!1;switch(e){case ta:case ga:return+a==+b;case pa:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case Ba:case Da:return a==b+""}var h=e==na||e==za;if(Ka&&!h&&(h=n(a))&&!n(b))return!1;if(!h){if(a.__wrapped__||b.__wrapped__)return L(a.__wrapped__||
a,b.__wrapped__||b);if(e!=ha||eb&&("function"!=typeof a.toString&&"string"==typeof(a+"")||"function"!=typeof b.toString&&"string"==typeof(b+"")))return!1;var e=a.constructor,f=b.constructor;if(e!=f&&(!q(e)||!(e instanceof e&&q(f)&&f instanceof f)))return!1}c||(c=[]);d||(d=[]);for(e=c.length;e--;)if(c[e]==a)return d[e]==b;var e=-1,f=!0,g=0;c.push(a);d.push(b);if(h){g=a.length;if(f=g==b.length)for(;g--&&(f=L(a[g],b[g],c,d)););return f}for(var i in a)if(E.call(a,i)&&(g++,!E.call(b,i)||!L(a[i],b[i],c,
d)))return!1;for(i in b)if(E.call(b,i)&&!g--)return!1;if(Va)for(;7>++e;)if(i=Qa[e],E.call(a,i)&&(!E.call(b,i)||!L(a[i],b[i],c,d)))return!1;return!0}function q(a){return"function"==typeof a}function r(a){return a?gb[typeof a]:!1}function u(a){return y.call(a)==Da}function D(a,b,c){var d=arguments,e=0,h=2,f=d[3],g=d[4];if(c!==oa&&(f=[],g=[],"number"!=typeof c))h=d.length;for(;++e<h;)ia(d[e],function(b,c){var d,e,h;if(b&&((e=U(b))||Ta(b))){for(var i=f.length;i--&&!(d=f[i]==b););d?a[c]=g[i]:(f.push(b),
g.push(h=(h=a[c],e)?U(h)?h:[]:Ta(h)?h:{}),a[c]=D(h,b,oa,f,g))}else null!=b&&(a[c]=b)});return a}function z(a){var b=[];ia(a,function(a){b.push(a)});return b}function w(a,b,c){var d=-1,e=a?a.length:0,h=!1,c=(0>c?ya(0,e+c):c)||0;"number"==typeof e?h=-1<(u(a)?a.indexOf(b,c):H(a,b,c)):x(a,function(a){if(++d>=c)return!(h=a===b)});return h}function V(a,b,c){var d=!0,b=k(b,c);if(U(a))for(var c=-1,e=a.length;++c<e&&(d=!!b(a[c],c,a)););else x(a,function(a,c,e){return d=!!b(a,c,e)});return d}function G(a,b,
c){var d=[],b=k(b,c);if(U(a))for(var c=-1,e=a.length;++c<e;){var h=a[c];b(h,c,a)&&d.push(h)}else x(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d}function qa(a,b,c){var d,b=k(b,c);x(a,function(a,c,e){if(b(a,c,e))return d=a,!1});return d}function ka(a,b,c){var d=-1,e=a?a.length:0,h=Array("number"==typeof e?e:0),b=k(b,c);if(U(a))for(;++d<e;)h[d]=b(a[d],d,a);else x(a,function(a,c,e){h[++d]=b(a,c,e)});return h}function $(a,b,c){var d=-Infinity,e=-1,h=a?a.length:0,f=d;if(b||!U(a))b=!b&&u(a)?j:k(b,c),
x(a,function(a,c,e){c=b(a,c,e);c>d&&(d=c,f=a)});else for(;++e<h;)a[e]>f&&(f=a[e]);return f}function W(a,b){var c=[];x(a,function(a){c.push(a[b])});return c}function O(a,b,c,d){var e=3>arguments.length,b=k(b,d);x(a,function(a,d,h){c=e?(e=!1,a):b(c,a,d,h)});return c}function A(a,b,c,d){var e=a,h=a?a.length:0,f=3>arguments.length;if("number"!=typeof h)var g=Ua(a),h=g.length;else db&&u(a)&&(e=a.split(""));x(a,function(a,Sa,i){Sa=g?g[--h]:--h;c=f?(f=!1,e[Sa]):b.call(d,c,e[Sa],Sa,i)});return c}function X(a,
b,c){var d,b=k(b,c);if(U(a))for(var c=-1,e=a.length;++c<e&&!(d=b(a[c],c,a)););else x(a,function(a,c,e){return!(d=b(a,c,e))});return!!d}function M(a,b,c){if(a)return null==b||c?a[0]:B.call(a,0,b)}function Y(a,b){for(var c=-1,d=a?a.length:0,e=[];++c<d;){var h=a[c];U(h)?ma.apply(e,b?h:Y(h)):e.push(h)}return e}function H(a,b,c){var d=-1,e=a?a.length:0;if("number"==typeof c)d=(0>c?ya(0,e+c):c||0)-1;else if(c)return d=ba(a,b),a[d]===b?d:-1;for(;++d<e;)if(a[d]===b)return d;return-1}function aa(a,b,c){return a?
B.call(a,null==b||c?1:b):[]}function ba(a,b,c,d){for(var e=0,h=a?a.length:e,c=c?k(c,d):N,b=c(b);e<h;)d=e+h>>>1,c(a[d])<b?e=d+1:h=d;return e}function ca(a,b,c,d){var e=-1,h=a?a.length:0,f=[],g=f;"function"==typeof b&&(d=c,c=b,b=!1);var i=!b&&74<h;if(i)var m={};c&&(g=[],c=k(c,d));for(;++e<h;){var d=a[e],t=c?c(d,e,a):d;i&&(g=E.call(m,t+"")?m[t]:m[t]=[]);if(b?!e||g[g.length-1]!==t:0>H(g,t))(c||i)&&g.push(t),f.push(d)}return f}function la(a,b){return kb||S&&2<arguments.length?S.call.apply(S,arguments):
i(a,b,B.call(arguments,2))}function N(a){return a}function F(b){x(v(b),function(c){var d=a[c]=b[c];a.prototype[c]=function(){var b=[this.__wrapped__];ma.apply(b,arguments);b=d.apply(a,b);if(this.__chain__)b=new a(b),b.__chain__=!0;return b}})}function ja(c,d,e){c||(c="");e||(e={});var h,f,g=a.templateSettings,i=0,m=e.interpolate||g.interpolate||P,t="__p += '",n=e.variable||g.variable,j=n;c.replace(RegExp((e.escape||g.escape||P).source+"|"+m.source+"|"+(m===Fa?Ja:P).source+"|"+(e.evaluate||g.evaluate||
P).source+"|$","g"),function(a,d,e,f,g,m){e||(e=f);t+=c.slice(i,m).replace(Ya,b);t+=d?"' +\n__e("+d+") +\n'":g?"';\n"+g+";\n__p += '":e?"' +\n((__t = ("+e+")) == null ? '' : __t) +\n'":"";h||(h=g||Ma.test(d||e));i=m+a.length});t+="';\n";j||(n="obj",t=h?"with ("+n+") {\n"+t+"\n}\n":t.replace(Z,"$&"+n+".").replace(RegExp("(\\(\\s*)"+n+"\\."+n+"\\b","g"),"$1__d"));t=(h?t.replace(Na,""):t).replace(ra,"$1").replace(Oa,"$1;");t="function("+n+") {\n"+(j?"":n+" || ("+n+" = {});\n")+"var __t, __p = '', __e = _.escape"+
(h?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(j?"":", __d = "+n+"."+n+" || "+n)+";\n")+t+"return __p\n}";e=mb?"\n//@ sourceURL="+(e.sourceURL||"/lodash/template/source["+va++ +"]"):"";try{f=Function("_","return "+t+e)(a)}catch(ua){throw ua.source=t,ua;}if(d)return f(d);f.source=t;return f}var J="object"==typeof exports&&exports,I="object"==typeof global&&global;I.global===I&&(c=I);var C=[],t=new function(){},ua=0,oa=t,Wa=30,Ea=c._,Ma=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,
sa=/&(?:amp|lt|gt|quot|#x27);/g,Na=/\b__p \+= '';/g,ra=/\b(__p \+=) '' \+/g,Oa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pa=/\w*$/,Z=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,ea=RegExp("^"+(t.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ja=/\$\{((?:(?=\\?)\\?[\s\S])*?)}/g,Fa=/<%=([\s\S]+?)%>/g,P=/($^)/,Xa=/[&<>"']/g,Ya=/['\n\r\t\u2028\u2029\\]/g,Qa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),va=
0,Ga=Math.ceil,fa=C.concat,Ra=Math.floor,T=ea.test(T=Object.getPrototypeOf)&&T,E=t.hasOwnProperty,ma=C.push,da=t.propertyIsEnumerable,B=C.slice,y=t.toString,S=ea.test(S=B.bind)&&S,wa=ea.test(wa=Array.isArray)&&wa,xa=c.isFinite,Ha=c.isNaN,Q=ea.test(Q=Object.keys)&&Q,ya=Math.max,La=Math.min,Aa=Math.random,za="[object Arguments]",na="[object Array]",ta="[object Boolean]",ga="[object Date]",pa="[object Number]",ha="[object Object]",Ba="[object RegExp]",Da="[object String]",Va,bb,Ia=(Ia={"0":1,length:1},
C.splice.call(Ia,0,1),Ia[0]),cb=!0;(function(){function a(){this.x=1}var b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);for(c in arguments)cb=!c;Va=!/valueOf/.test(b);bb="x"!=b[0]})(1);var Ka=!n(arguments),jb="x"!=B.call("x")[0],db="xx"!="x"[0]+Object("x")[0];try{var eb=y.call(c.document||0)==ha}catch(qb){}var kb=S&&/\n|Opera/.test(S+y.call(c.opera)),lb=Q&&/^.+$|true/.test(Q+!!c.attachEvent);try{var mb=(Function("//@")(),!c.attachEvent)}catch(rb){}var R={};R[za]=R["[object Function]"]=
!1;R[na]=R[ta]=R[ga]=R[pa]=R[ha]=R[Ba]=R[Da]=!0;var gb={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},nb={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};a.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Fa,variable:""};var fb=ja("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (isString(iteratee)) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),
$a={args:"object, source, guard",top:"for (var argsIndex = 1, argsLength = typeof guard == 'number' ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if ((iteratee = arguments[argsIndex])) {",objectLoop:"result[index] = value",bottom:"  }\n}"},ab={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},
ib={arrayLoop:null},Za=g($a);Ka&&(n=function(a){return a?E.call(a,"callee"):!1});var Ca=g(ab,ib,{useHas:!1}),ia=g(ab,ib),hb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ob=K(hb),pb=g($a,{objectLoop:"if (result[index] == null) "+$a.objectLoop}),U=wa||function(a){return y.call(a)==na};q(/x/)&&(q=function(a){return"[object Function]"==y.call(a)});var Ta=!T?s:function(a){if(!(a&&"object"==typeof a))return!1;var b=a.valueOf,c="function"==typeof b&&(c=T(b))&&T(c);return c?a==c||T(a)==c&&
!n(a):s(a)},Ua=!Q?p:function(a){return"function"==typeof a&&da.call(a,"prototype")?p(a):r(a)?Q(a):[]},x=g(ab);a.VERSION="0.10.0";a.assign=Za;a.after=function(a,b){return 1>a?b():function(){if(1>--a)return b.apply(this,arguments)}};a.bind=la;a.bindAll=function(a){for(var b=arguments,c=1<b.length?0:(b=v(a),-1),d=b.length;++c<d;){var e=b[c];a[e]=la(a[e],a)}return a};a.bindKey=function(a,b){return i(a,b,B.call(arguments,2))};a.chain=function(b){b=new a(b);b.__chain__=!0;return b};a.clone=o;a.compact=
function(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d};a.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}};a.contains=w;a.countBy=function(a,b,c){var d={},b=k(b,c);x(a,function(a,c,e){c=b(a,c,e);E.call(d,c)?d[c]++:d[c]=1});return d};a.debounce=function(a,b,c){function d(){g=null;c||(h=a.apply(f,e))}var e,h,f,g;return function(){var i=c&&!g;e=arguments;f=this;clearTimeout(g);g=setTimeout(d,b);
i&&(h=a.apply(f,e));return h}};a.defaults=pb;a.defer=function(a){var b=B.call(arguments,1);return setTimeout(function(){a.apply(d,b)},1)};a.delay=function(a,b){var c=B.call(arguments,2);return setTimeout(function(){a.apply(d,c)},b)};a.difference=function(a){for(var b=-1,c=a?a.length:0,d=fa.apply(C,arguments),d=f(d,c),e=[];++b<c;){var h=a[b];d(h)||e.push(h)}return e};a.escape=function(a){return null==a?"":(a+"").replace(Xa,e)};a.every=V;a.filter=G;a.find=qa;a.first=M;a.flatten=Y;a.forEach=x;a.forIn=
Ca;a.forOwn=ia;a.functions=v;a.groupBy=function(a,b,c){var d={},b=k(b,c);x(a,function(a,c,e){c=b(a,c,e);(E.call(d,c)?d[c]:d[c]=[]).push(a)});return d};a.has=function(a,b){return a?E.call(a,b):!1};a.identity=N;a.indexOf=H;a.initial=function(a,b,c){return a?B.call(a,0,-(null==b||c?1:b)):[]};a.intersection=function(a){var b=arguments,c=b.length,d={},e=[];x(a,function(a){if(0>H(e,a)){for(var h=c;--h;)if(!(d[h]||(d[h]=f(b[h])))(a))return;e.push(a)}});return e};a.invert=K;a.invoke=function(a,b){var c=B.call(arguments,
2),d="function"==typeof b,e=[];x(a,function(a){e.push((d?b:a[b]).apply(a,c))});return e};a.isArguments=n;a.isArray=U;a.isBoolean=function(a){return!0===a||!1===a||y.call(a)==ta};a.isDate=function(a){return y.call(a)==ga};a.isElement=function(a){return a?1===a.nodeType:!1};a.isEmpty=function(a){var b=!0;if(!a)return b;var c=y.call(a),d=a.length;if(c==na||c==Da||c==za||Ka&&n(a)||c==ha&&"number"==typeof d&&q(a.splice))return!d;ia(a,function(){return b=!1});return b};a.isEqual=L;a.isFinite=function(a){return xa(a)&&
!Ha(parseFloat(a))};a.isFunction=q;a.isNaN=function(a){return y.call(a)==pa&&a!=+a};a.isNull=function(a){return null===a};a.isNumber=function(a){return y.call(a)==pa};a.isObject=r;a.isPlainObject=Ta;a.isRegExp=function(a){return y.call(a)==Ba};a.isString=u;a.isUndefined=function(a){return a===d};a.keys=Ua;a.last=function(a,b,c){if(a){var d=a.length;return null==b||c?a[d-1]:B.call(a,-b||d)}};a.lastIndexOf=function(a,b,c){var d=a?a.length:0;for("number"==typeof c&&(d=(0>c?ya(0,d+c):La(c,d-1))+1);d--;)if(a[d]===
b)return d;return-1};a.map=ka;a.max=$;a.memoize=function(a,b){var c={};return function(){var d=b?b.apply(this,arguments):arguments[0];return E.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}};a.merge=D;a.min=function(a,b,c){var d=Infinity,e=-1,h=a?a.length:0,f=d;if(b||!U(a))b=!b&&u(a)?j:k(b,c),x(a,function(a,c,e){c=b(a,c,e);c<d&&(d=c,f=a)});else for(;++e<h;)a[e]<f&&(f=a[e]);return f};a.mixin=F;a.noConflict=function(){c._=Ea;return this};a.object=function(a,b){for(var c=-1,d=a?a.length:0,e={};++c<d;){var h=
a[c];b?e[h]=b[c]:e[h[0]]=h[1]}return e};a.omit=function(a,b,c){var d="function"==typeof b,e={};if(d)b=k(b,c);else var h=fa.apply(C,arguments);Ca(a,function(a,c,f){if(d?!b(a,c,f):0>H(h,c,1))e[c]=a});return e};a.once=function(a){var b,c=!1;return function(){if(c)return b;c=!0;b=a.apply(this,arguments);a=null;return b}};a.pairs=function(a){var b=[];ia(a,function(a,c){b.push([c,a])});return b};a.partial=function(a){return i(a,B.call(arguments,1))};a.pick=function(a,b,c){var d={};if("function"!=typeof b)for(var e=
0,h=fa.apply(C,arguments),f=h.length;++e<f;){var g=h[e];g in a&&(d[g]=a[g])}else b=k(b,c),Ca(a,function(a,c,e){b(a,c,e)&&(d[c]=a)});return d};a.pluck=W;a.random=function(a,b){null==a&&null==b&&(b=1);a=+a||0;null==b&&(b=a,a=0);return a+Ra(Aa()*((+b||0)-a+1))};a.range=function(a,b,c){a=+a||0;c=+c||1;null==b&&(b=a,a=0);for(var d=-1,b=ya(0,Ga((b-a)/c)),e=Array(b);++d<b;)e[d]=a,a+=c;return e};a.reduce=O;a.reduceRight=A;a.reject=function(a,b,c){b=k(b,c);return G(a,function(a,c,d){return!b(a,c,d)})};a.rest=
aa;a.result=function(a,b){var c=a?a[b]:null;return q(c)?a[b]():c};a.shuffle=function(a){var b=-1,c=Array(a?a.length:0);x(a,function(a){var d=Ra(Aa()*(++b+1));c[b]=c[d];c[d]=a});return c};a.size=function(a){var b=a?a.length:0;return"number"==typeof b?b:Ua(a).length};a.some=X;a.sortBy=function(a,b,c){var d=[],b=k(b,c);x(a,function(a,c,e){d.push({criteria:b(a,c,e),index:c,value:a})});a=d.length;for(d.sort(l);a--;)d[a]=d[a].value;return d};a.sortedIndex=ba;a.tap=function(a,b){b(a);return a};a.template=
ja;a.throttle=function(a,b){function c(){g=new Date;f=null;e=a.apply(h,d)}var d,e,h,f,g=0;return function(){var i=new Date,m=b-(i-g);d=arguments;h=this;0>=m?(clearTimeout(f),g=i,e=a.apply(h,d)):f||(f=setTimeout(c,m));return e}};a.times=function(a,b,c){for(var a=+a||0,d=-1,e=Array(a);++d<a;)e[d]=b.call(c,d);return e};a.toArray=function(a){return a&&"number"==typeof a.length?(jb?u(a):"string"==typeof a)?a.split(""):B.call(a):z(a)};a.unescape=function(a){return null==a?"":(a+"").replace(sa,m)};a.union=
function(){return ca(fa.apply(C,arguments))};a.uniq=ca;a.uniqueId=function(a){var b=ua++;return a?a+b:b};a.values=z;a.where=function(a,b){var c=Ua(b);return G(a,function(a){for(var d=c.length;d--;){var e=a[c[d]]===b[c[d]];if(!e)break}return!!e})};a.without=function(a){for(var b=-1,c=a?a.length:0,d=f(arguments,1,20),e=[];++b<c;){var h=a[b];d(h)||e.push(h)}return e};a.wrap=function(a,b){return function(){var c=[a];ma.apply(c,arguments);return b.apply(this,c)}};a.zip=function(a){for(var b=-1,c=a?$(W(arguments,
"length")):0,d=Array(c);++b<c;)d[b]=W(arguments,b);return d};a.all=V;a.any=X;a.collect=ka;a.detect=qa;a.drop=aa;a.each=x;a.extend=Za;a.foldl=O;a.foldr=A;a.head=M;a.include=w;a.inject=O;a.methods=v;a.select=G;a.tail=aa;a.take=M;a.unique=ca;a._iteratorTemplate=fb;F(a);a.prototype.chain=function(){this.__chain__=!0;return this};a.prototype.value=function(){return this.__wrapped__};x("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var c=C[b];a.prototype[b]=function(){var b=this.__wrapped__;
c.apply(b,arguments);Ia&&0===b.length&&delete b[0];if(this.__chain__)b=new a(b),b.__chain__=!0;return b}});x(["concat","join","slice"],function(b){var c=C[b];a.prototype[b]=function(){var b=c.apply(this.__wrapped__,arguments);if(this.__chain__)b=new a(b),b.__chain__=!0;return b}});"function"==typeof define&&"object"==typeof define.amd&&define.amd?(c._=a,define(function(){return a})):J?"object"==typeof module&&module&&module.exports==J?(module.exports=a)._=a:J._=a:c._=a})(this)},"dojo/dom-class":function(){define(["./_base/lang",
"./_base/array","./dom"],function(c,d,a){function f(a){if("string"==typeof a||a instanceof String){if(a&&!l.test(a))return i[0]=a,i;a=a.split(l);a.length&&!a[0]&&a.shift();a.length&&!a[a.length-1]&&a.pop();return a}return!a?[]:d.filter(a,function(a){return a})}var j,l=/\s+/,i=[""],k={};return j={contains:function(c,b){return 0<=(" "+a.byId(c).className+" ").indexOf(" "+b+" ")},add:function(c,b){var c=a.byId(c),b=f(b),d=c.className,h,d=d?" "+d+" ":" ";h=d.length;for(var i=0,n=b.length,j;i<n;++i)(j=
b[i])&&0>d.indexOf(" "+j+" ")&&(d+=j+" ");h<d.length&&(c.className=d.substr(1,d.length-2))},remove:function(d,b){var d=a.byId(d),e;if(void 0!==b){b=f(b);e=" "+d.className+" ";for(var h=0,i=b.length;h<i;++h)e=e.replace(" "+b[h]+" "," ");e=c.trim(e)}else e="";d.className!=e&&(d.className=e)},replace:function(c,b,d){c=a.byId(c);k.className=c.className;j.remove(k,d);j.add(k,b);c.className!==k.className&&(c.className=k.className)},toggle:function(c,b,d){c=a.byId(c);if(void 0===d)for(var b=f(b),h=0,i=b.length,
n;h<i;++h)n=b[h],j[j.contains(c,n)?"remove":"add"](c,n);else j[d?"add":"remove"](c,b);return d}}})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(c,d,a){function f(a){return i[a]=new Function("item","index","array",a)}function j(a){var c=!a;return function(d,g,n){var j=0,k=d&&d.length||0,o;k&&"string"==typeof d&&(d=d.split(""));"string"==typeof g&&(g=i[g]||f(g));if(n)for(;j<k;++j){if(o=!g.call(n,d[j],j,d),a^o)return!o}else for(;j<k;++j)if(o=!g(d[j],j,d),a^o)return!o;
return c}}function l(a){var c=1,d=0,f=0;a||(c=d=f=-1);return function(i,j,l,o){if(o&&0<c)return g.lastIndexOf(i,j,l);var o=i&&i.length||0,v=a?o+f:d;l===k?l=a?d:o+f:0>l?(l=o+l,0>l&&(l=d)):l=l>=o?o+f:l;for(o&&"string"==typeof i&&(i=i.split(""));l!=v;l+=c)if(i[l]==j)return l;return-1}}var i={},k,g={every:j(!1),some:j(!0),indexOf:l(!0),lastIndexOf:l(!1),forEach:function(a,c,d){var g=0,j=a&&a.length||0;j&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=i[c]||f(c));if(d)for(;g<j;++g)c.call(d,
a[g],g,a);else for(;g<j;++g)c(a[g],g,a)},map:function(a,c,d,g){var j=0,l=a&&a.length||0,g=new (g||Array)(l);l&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=i[c]||f(c));if(d)for(;j<l;++j)g[j]=c.call(d,a[j],j,a);else for(;j<l;++j)g[j]=c(a[j],j,a);return g},filter:function(a,c,d){var g=0,j=a&&a.length||0,l=[],k;j&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=i[c]||f(c));if(d)for(;g<j;++g)k=a[g],c.call(d,k,g,a)&&l.push(k);else for(;g<j;++g)k=a[g],c(k,g,a)&&l.push(k);return l},
clearCache:function(){i={}}};a.mixin(c,g);return g})},"game/createJSON/main":function(){define(["./poly","./circle","./rect"],function(c,d,a){return{polygon:c,circle:d,rectangle:a}})},"game/createJSON/poly":function(){define(["../state","../utils/convexHull","frozen/utils"],function(c,d,a){return function(f){if(f&&2<f.length){var f={points:d(f)},j=a.averagePoints(f.points);f.x=j.x;f.y=j.y;f.points=a.translatePoints(f.points,{x:-f.x,y:-f.y});f.staticBody="static"===c.toolType;f.zone="zone"===c.toolType;
f.type="Polygon";return f}}})},"game/utils/convexHull":function(){define(function(){return function(c){var d,a,f,j,l=[],i=function(a,c){var d;l.push(a);var f=[];d=0;var g=null,j=[],k;for(k in c){var o=c[k],v=(a[0].y-a[1].y)*(o.x-a[0].x)+(a[1].x-a[0].x)*(o.y-a[0].y);0<v&&(j.push(o),v>d&&(d=v,g=o))}return(d=g)?(f=f.concat(i([a[0],d],j)),f=f.concat(i([d,a[1]],j))):[a]},k;for(k in c){var g=c[k];if(g.x>d||!d)f=g,d=g.x;if(g.x<a||!a)j=g,a=g.x}c=[].concat(i([j,f],c),i([f,j],c));d=[];for(a=0;a<c.length;a++)d.push(c[a][0]);
d.reverse();return d}})},"frozen/utils":function(){define("./utils/averagePoints,./utils/degreesToRadians,./utils/radiansToDegrees,./utils/pointInPolygon,./utils/distance,./utils/degreesFromCenter,./utils/radiansFromCenter,./utils/scalePoints,./utils/translatePoints,./utils/insideCanvas".split(","),function(c,d,a,f,j,l,i,k,g,b){return{averagePoints:c,degreesToRadians:d,radiansToDegrees:a,pointInPolygon:f,distance:j,degreesFromCenter:l,radiansFromCenter:i,scalePoints:k,translatePoints:g,insideCanvas:b}})},
"frozen/utils/averagePoints":function(){define(function(){return function(c){var d={x:0,y:0};c.forEach(function(a){d.x+=a.x;d.y+=a.y});d.x/=c.length;d.y/=c.length;return d}})},"frozen/utils/degreesToRadians":function(){define(function(){var c=Math.PI/180;return function(d){return d*c}})},"frozen/utils/radiansToDegrees":function(){define(function(){var c=180/Math.PI;return function(d){return d*c}})},"frozen/utils/degreesFromCenter":function(){define(["./radiansToDegrees","./radiansFromCenter"],function(c,
d){return function(a,f){return c(d(a,f))}})},"frozen/utils/radiansFromCenter":function(){define(function(){var c={x:0,y:0};return function(d,a){d=d||c;return d.x===a.x&&d.y===a.y?0:d.x===a.x?d.y>a.y?0:Math.PI:d.y===a.y?d.x>a.x?1.5*Math.PI:Math.PI/2:d.x<a.x&&d.y>a.y?Math.atan((a.x-d.x)/(d.y-a.y)):d.x<a.x&&d.y<a.y?Math.PI/2+Math.atan((a.y-d.y)/(a.x-d.x)):d.x>a.x&&d.y<a.y?Math.PI+Math.atan((d.x-a.x)/(a.y-d.y)):1.5*Math.PI+Math.atan((d.y-a.y)/(d.x-a.x))}})},"frozen/utils/insideCanvas":function(){define(function(){return function(c,
d){return 0>c.x||c.x>d.width||0>c.y||c.y>d.height?!1:!0}})},"game/createJSON/circle":function(){define(["../state","frozen/utils"],function(c,d){return function(a){if(a&&2===a.length){var f=d.distance(a[0],a[1]),a={x:a[0].x,y:a[0].y,radius:f};a.staticBody="static"===c.toolType;a.zone="zone"===c.toolType;a.type="Circle";return a}}})},"game/createJSON/rect":function(){define(["../state","../utils/orderRectPts"],function(c,d){return function(a){if(a&&2===a.length)return a=d(a),a={x:(a[1].x-a[0].x)/2+
a[0].x,y:(a[1].y-a[0].y)/2+a[0].y,halfWidth:Math.abs((a[1].x-a[0].x)/2)||0.5,halfHeight:Math.abs((a[1].y-a[0].y)/2)||0.5},a.staticBody="static"===c.toolType,a.zone="zone"===c.toolType,a.type="Rectangle",a}})},"game/utils/orderRectPts":function(){define(function(){return function(c){var d=[],a;c[1].x<c[0].x?(a=c[1],c=c[0]):(a=c[0],c=c[1]);d.push(a);d.push(c);return d}})},"game/utils/insideCanvas":function(){define(function(){return function(c,d){return 0>c.x||c.x>d.width||0>c.y||c.y>d.height?!1:!0}})},
"game/update":function(){define(["./state"],function(c){return function(d){c.runSimulation&&(c.box.update(d),c.box.updateExternalState(c.entities))}})},"game/draw":function(){define(["./draw/shape","./state","lodash"],function(c,d,a){return function(f){d.backImg?f.drawImage(d.backImg,0,0,this.canvas.width,d.backImg.height):f.clearRect(0,0,this.canvas.width,this.canvas.height);a.forEach(d.entities,function(a){(!a.staticBody||d.showStatic)&&a.draw(f)},this);if(d.geometries.length)c[d.tool](f,this.inputManager,
d.geometries)}})},"game/draw/shape":function(){define(["./poly","./circle","./rect"],function(c,d,a){return{polygon:c,circle:d,rectangle:a}})},"game/draw/poly":function(){define(["lodash","frozen/utils"],function(c,d){return function(a,f,j){a.fillStyle="white";a.strokeStyle="black";c.forEach(j,function(c){a.beginPath();a.arc(c.x,c.y,4,0,2*Math.PI,!0);a.closePath();a.fill();a.stroke()});if(1<j.length&&f.mouseAction.position&&4>=d.distance(j[0],f.mouseAction.position))a.strokeStyle="yellow",a.fillStyle=
"black",a.lineWidth=4,a.beginPath(),a.arc(j[0].x,j[0].y,4,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke(),a.lineWidth=1;a.strokeStyle="red";a.beginPath();c.forEach(j,function(c,d){0<d&&(a.moveTo(j[d-1].x,j[d-1].y),a.lineTo(c.x,c.y))});f.mouseAction.position&&(a.moveTo(j[j.length-1].x,j[j.length-1].y),a.lineTo(f.mouseAction.position.x,f.mouseAction.position.y));a.stroke();a.closePath()}})},"game/draw/circle":function(){define(["frozen/utils"],function(c){return function(d,a,f){a=c.distance(f[0],
a.mouseAction.position);d.strokeStyle="red";d.beginPath();d.arc(f[0].x,f[0].y,a,0,2*Math.PI,!0);d.closePath();d.stroke()}})},"game/draw/rect":function(){define(["../utils/orderRectPts"],function(c){return function(d,a,f){a=c([f[0],a.mouseAction.position]);d.strokeStyle="red";d.strokeRect(a[0].x,a[0].y,a[1].x-a[0].x,a[1].y-a[0].y)}})},"frozen/GameCore":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/dom,./InputManager,./ResourceManager,./shims/RAF".split(","),function(c,d,a,f,j,l){return c(d,
{statics:{FONT_SIZE:24},isRunning:!1,canvasId:null,maxStep:40,contextType:"2d",height:0,width:0,resourceManager:null,inputManager:null,loadingForeground:"#00F",loadingBackground:"#FFF",gameAreaId:null,canvasPercentage:0,setHeight:function(a){this.height=a;this.canvas.height=a},setWidth:function(a){this.width=a;this.canvas.width=a},stop:function(){this.isRunning=!1},run:function(){this.isRunning||(this.init(),this.loadResources(this.resourceManager),this.initInput(this.inputManager),this.launchLoop())},
loadResources:function(){},init:function(){if(!this.canvas)this.canvas=f.byId(this.canvasId);if(this.canvas){if(!this.context)this.context=this.canvas.getContext(this.contextType);if(this.context){this.setHeight(this.height||this.canvas.height);this.setWidth(this.width||this.canvas.width);if(!this.inputManager)this.inputManager=this.gameAreaId&&this.canvasPercentage?new j({canvas:this.canvas,gameArea:f.byId(this.gameAreaId),canvasPercentage:this.canvasPercentage}):new j({canvas:this.canvas});this.inputManager.resize();
if(!this.resourceManager)this.resourceManager=new l;this.loadResources(this.resourceManager);this.isRunning=!0}else alert("Sorry, your browser does not support a "+this.contextType+" drawing surface on canvas.  I recommend any browser but Internet Explorer")}else alert("Sorry, your browser does not support canvas.  I recommend any browser but Internet Explorer")},initInput:function(){},handleInput:function(){},gameLoop:function(){this.currTime=(new Date).getTime();this.elapsedTime=Math.min(this.currTime-
this.prevTime,this.maxStep);this.prevTime=this.currTime;this.resourceManager&&!this.resourceManager.resourcesReady()?(this.updateLoadingScreen(this.elapsedTime),this.drawLoadingScreen(this.context)):(this.handleInput(this.inputManager,this.elapsedTime),this.paused||this.update(this.elapsedTime),this.context.save(),this.draw(this.context),this.context.restore())},launchLoop:function(){this.elapsedTime=0;var c=Date.now();this.prevTime=this.currTime=c;this.loopRunner=a.hitch(this,this.loopRunner);window.requestAnimationFrame(this.loopRunner)},
loopRunner:function(){this.gameLoop();window.requestAnimationFrame(this.loopRunner)},update:function(){},updateLoadingScreen:function(){},draw:function(a){if("2d"===this.contextType)a.font="14px sans-serif",a.fillText("This game does not have its own draw function!",10,50)},drawLoadingScreen:function(a){if(this.resourceManager&&"2d"===this.contextType)a.fillStyle=this.loadingBackground,a.fillRect(0,0,this.width,this.height),a.fillStyle=this.loadingForeground,a.strokeStyle=this.loadingForeground,a.font=
"bold "+Math.floor(this.height/12)+"px sans-serif",a.fillText("Loading... "+this.resourceManager.getPercentComplete()+"%",0.1*this.width,0.55*this.height),a.strokeRect(0.1*this.width,0.7*this.height,0.8*this.width,0.1*this.height),a.fillRect(0.1*this.width,0.7*this.height,0.8*this.width*this.resourceManager.getPercentComplete()/100,0.1*this.height),a.lineWidth=4}})})},"frozen/InputManager":function(){define("./GameAction,./MouseAction,./utils/insideCanvas,dcl,dcl/bases/Mixer,dojo/has,dojo/on,dojo/dom-style,dojo/dom-geometry,dojo/_base/lang,dojo/domReady!".split(","),
function(c,d,a,f,j,l,i,k,g,b){return f(j,{keyActions:[],mouseAction:null,touchAction:null,canvas:null,handleMouse:!0,handleTouch:!0,handleKeys:!0,gameArea:null,canvasPercentage:null,constructor:function(){this.handleKeys&&(i(document,"keydown",b.hitch(this,"keyDown")),i(document,"keyup",b.hitch(this,"keyReleased")));this.handleMouse&&!l("touch")&&(i(document,"mousedown",b.hitch(this,"mouseDown")),i(document,"mousemove",b.hitch(this,"mouseMove")),i(document,"mouseup",b.hitch(this,"mouseUp")));this.handleTouch&&
l("touch")&&(i(document,"touchstart",b.hitch(this,"touchStart")),i(document,"touchmove",b.hitch(this,"touchMove")),i(document,"touchend",b.hitch(this,"touchEnd")));if(!this.mouseAction)this.mouseAction=new d;if(!this.touchAction)this.touchAction=new d;this.gameArea&&this.canvasPercentage&&(i(window,"resize",b.hitch(this,"resize")),i(window,"orientationchange",b.hitch(this,"resize")))},mapToKey:function(a,b){if(!this.keyActions)this.keyActions=[];this.keyActions[b]=a},addKeyAction:function(a,b){var d=
new c;if(b)d.behavior=d.statics.DETECT_INITAL_PRESS_ONLY;this.mapToKey(d,a);return d},setMouseAction:function(a){this.mouseAction=a},setTouchAction:function(a){this.touchAction=a},mouseUp:function(a){this.mouseAction.release();this.mouseAction.endPosition=this.getMouseLoc(a)},mouseDown:function(b){b=this.getMouseLoc(b);this.mouseAction.endPosition=null;this.mouseAction.insideCanvas=a(b,this.canvas);this.mouseAction.insideCanvas?(this.mouseAction.press(),this.mouseAction.startPosition=b,this.mouseAction.position=
b):this.mouseAction.startPosition=null},mouseMove:function(a){this.mouseAction.position=this.getMouseLoc(a)},touchStart:function(b){b=this.getMouseLoc(b.changedTouches[0]);this.touchAction.endPosition=null;this.touchAction.insideCanvas=a(b,this.canvas);this.touchAction.insideCanvas?(this.touchAction.press(),this.touchAction.startPosition=b,this.touchAction.position=b):this.touchAction.startPosition=null},touchEnd:function(a){this.touchAction.release();this.touchAction.endPosition=this.getMouseLoc(a.changedTouches[0])},
touchMove:function(a){this.touchAction.position=this.getMouseLoc(a.changedTouches[0]);this.touchAction.startPosition&&a.preventDefault()},getKeyAction:function(a){return this.keyActions.length?this.keyActions[a.keyCode]||this.keyActions[String.fromCharCode(a.keyCode)]:null},keyPressed:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyDown:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyReleased:function(a){(a=this.getKeyAction(a))&&a.release()},getMouseLoc:function(a){var b=
g.position(this.canvas);return this.zoomRatio?{x:Math.round((a.clientX-b.x)/this.zoomRatio),y:Math.round((a.clientY-b.y)/this.zoomRatio)}:{x:Math.round(a.clientX-b.x),y:Math.round(a.clientY-b.y)}},resize:function(){if(this.gameArea&&this.canvasPercentage&&this.canvas){var a=this.canvas.width,b=this.canvas.height,c=g.getMarginExtents(document.body),d=window.innerWidth-c.w,c=window.innerHeight-c.h,b=a/b,f="",i="";d/c>b?(d=c*b,f=d+"px"):i=Math.round(d/b)+"px";this.zoomRatio=d/a*this.canvasPercentage;
k.set(this.gameArea,{width:f,height:i});a=Math.floor(100*this.canvasPercentage)+"%";k.set(this.canvas,{width:a,height:a,display:"block",marginLeft:"auto",marginRight:"auto"})}}})})},"frozen/GameAction":function(){define(["dcl","dcl/bases/Mixer"],function(c,d){return c(d,{name:null,behavior:0,amount:0,state:0,statics:{NORMAL:0,DETECT_INITAL_PRESS_ONLY:1,STATE_RELEASED:0,STATE_PRESSED:1,STATE_WAITING_FOR_RELEASE:2,STATE_MOVED:3},constructor:function(){this.reset()},getName:function(){return this.name},
reset:function(){this.state=this.statics.STATE_RELEASED;this.amount=0},tap:function(){this.press();this.release()},press:function(){this.state=this.statics.STATE_PRESSED;this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY&&this.pressAmt(1)},pressAmt:function(a){if(this.state!==this.statics.STATE_WAITING_FOR_RELEASE)this.amount+=a,this.state=this.statics.STATE_WAITING_FOR_RELEASE},release:function(){this.state=this.statics.STATE_RELEASED},isPressed:function(){return this.state===this.statics.STATE_PRESSED?
!0:!1},getAmount:function(){var a=this.amount;if(0!==a)if(this.state===this.statics.STATE_RELEASED)this.amount=0;else if(this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY)this.state=this.statics.STATE_WAITING_FOR_RELEASE,this.amount=0;return a}})})},"frozen/MouseAction":function(){define(["dcl","dcl/bases/Mixer","./GameAction"],function(c,d,a){return c([d,a],{startPosition:null,endPosition:null,position:null})})},"dojo/on":function(){define(["require","./_base/kernel","./has"],function(c,d,a){function f(b,
c,d,h,f){if(h=c.match(/(.*):(.*)/))return c=h[2],h=h[1],i.selector(h,c).call(f,b,d);a("touch")&&(k.test(c)&&(d=p(d)),!a("event-orientationchange")&&"orientationchange"==c&&(c="resize",b=window,d=p(d)));m&&(d=m(d));if(b.addEventListener){var g=c in e,j=g?e[c]:c;b.addEventListener(j,d,g);return{remove:function(){b.removeEventListener(j,d,g)}}}c="on"+c;throw Error("Target must be an event emitter");}function j(){this.cancelable=!1}function l(){this.bubbles=!1}c=window.ScriptEngineMajorVersion;a.add("jscript",
c&&c()+ScriptEngineMinorVersion()/10);a.add("event-orientationchange",a("touch")&&!a("android"));a.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);var i=function(a,b,c,d){return"function"==typeof a.on&&"function"!=typeof b?a.on(b,c):i.parse(a,b,c,f,d,this)};i.pausable=function(a,b,c,d){var e,a=i(a,b,function(){if(!e)return c.apply(this,arguments)},d);a.pause=function(){e=!0};a.resume=function(){e=!1};return a};i.once=
function(a,b,c){var d=i(a,b,function(){d.remove();return c.apply(this,arguments)});return d};i.parse=function(a,b,c,d,e,h){if(b.call)return b.call(h,a,c);if(-1<b.indexOf(",")){for(var b=b.split(/\s*,\s*/),f=[],g=0,i;i=b[g++];)f.push(d(a,i,c,e,h));f.remove=function(){for(var a=0;a<f.length;a++)f[a].remove()};return f}return d(a,b,c,e,h)};var k=/^touch/;i.selector=function(a,b,c){return function(e,h){function f(b){for(g=g&&g.matches?g:d.query;!g.matches(b,a,e);)if(b==e||!1===c||!(b=b.parentNode)||1!=
b.nodeType)return;return b}var g="function"==typeof a?{matches:a}:this,j=b.bubble;return j?i(e,j(f),h):i(e,b,function(a){var b=f(a.target);return b&&h.call(b,a)})}};var g=[].slice,b=i.emit=function(a,b,c){var d=g.call(arguments,2),e="on"+b;if("parentNode"in a){var h=d[0]={},f;for(f in c)h[f]=c[f];h.preventDefault=j;h.stopPropagation=l;h.target=a;h.type=b;c=h}do a[e]&&a[e].apply(a,d);while(c&&c.bubbles&&(a=a.parentNode));return c&&c.cancelable&&c},e={};if(!a("event-stopimmediatepropagation"))var h=
function(){this.modified=this.immediatelyStopped=!0},m=function(a){return function(b){if(!b.immediatelyStopped)return b.stopImmediatePropagation=h,a.apply(this,arguments)}};e={focusin:"focus",focusout:"blur"};i.emit=function(a,c,d){if(a.dispatchEvent&&document.createEvent){var e=a.ownerDocument.createEvent("HTMLEvents");e.initEvent(c,!!d.bubbles,!!d.cancelable);for(var h in d)h in e||(e[h]=d[h]);return a.dispatchEvent(e)&&e}return b.apply(i,arguments)};if(a("touch"))var n=function(){},s=window.orientation,
p=function(a){return function(b){var c=b.corrected;if(!c){var d=b.type;try{delete b.type}catch(e){}b.type?(n.prototype=b,c=new n,c.preventDefault=function(){b.preventDefault()},c.stopPropagation=function(){b.stopPropagation()}):(c=b,c.type=d);b.corrected=c;if("resize"==d){if(s==window.orientation)return null;s=window.orientation;c.type="orientationchange";return a.call(this,c)}if(!("rotation"in c))c.rotation=0,c.scale=1;var d=c.changedTouches[0],h;for(h in d)delete c[h],c[h]=d[h]}return a.call(this,
c)}};return i})},"dojo/dom-style":function(){define("dojo/dom-style",["./sniff","./dom"],function(c,d){function a(a,d,h){d=d.toLowerCase();if(c("ie")){if("auto"==h){if("height"==d)return a.offsetHeight;if("width"==d)return a.offsetWidth}if("fontweight"==d)switch(h){case 700:return"bold";default:return"normal"}}d in b||(b[d]=e.test(d));return b[d]?l(a,h):h}var f,j={};f=c("webkit")?function(a){var b;if(1==a.nodeType){var c=a.ownerDocument.defaultView;b=c.getComputedStyle(a,null);if(!b&&a.style)a.style.display=
"",b=c.getComputedStyle(a,null)}return b||{}}:c("ie")&&(9>c("ie")||c("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1==a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};j.getComputedStyle=f;var l;l=c("ie")?function(a,b){if(!b)return 0;if("medium"==b)return 4;if(b.slice&&"px"==b.slice(-2))return parseFloat(b);var c=a.style,d=a.runtimeStyle,e=c.left,h=d.left;d.left=a.currentStyle.left;try{c.left=b,b=c.pixelLeft}catch(f){b=0}c.left=
e;d.left=h;return b}:function(a,b){return parseFloat(b)||0};j.toPixelValue=l;var i=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(c){return b?{}:null}},k=9>c("ie")||10>c("ie")&&c("quirks")?function(a){try{return i(a).Opacity/100}catch(b){return 1}}:function(a){return f(a).opacity},g=9>c("ie")||10>c("ie")&&c("quirks")?function(a,b){var c=100*b,d=1==b;a.style.zoom=d?"":1;if(i(a))i(a,1).Opacity=c;else{if(d)return b;a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+
c+")"}i(a,1).Enabled=!d;if("tr"==a.tagName.toLowerCase())for(c=a.firstChild;c;c=c.nextSibling)"td"==c.tagName.toLowerCase()&&g(c,b);return b}:function(a,b){return a.style.opacity=b},b={left:!0,top:!0},e=/margin|padding|width|height|max|min|offset/,h=c("ie")?"styleFloat":"cssFloat",m={cssFloat:h,styleFloat:h,"float":h};j.get=function(b,c){var e=d.byId(b),h=arguments.length;if(2==h&&"opacity"==c)return k(e);var c=m[c]||c,f=j.getComputedStyle(e);return 1==h?f:a(e,c,f[c]||e.style[c])};j.set=function(a,
b,c){var e=d.byId(a),h=arguments.length,f="opacity"==b,b=m[b]||b;if(3==h)return f?g(e,c):e.style[b]=c;for(var i in b)j.set(a,i,b[i]);return j.getComputedStyle(e)};return j})},"dojo/dom-geometry":function(){define("dojo/dom-geometry",["./sniff","./_base/window","./dom","./dom-style"],function(c,d,a,f){function j(a,c,d,f,g,i){i=i||"px";a=a.style;if(!isNaN(c))a.left=c+i;if(!isNaN(d))a.top=d+i;if(0<=f)a.width=f+i;if(0<=g)a.height=g+i}function l(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&
"button"==(a.getAttribute("type")||"").toLowerCase()}function i(a){return"border-box"==k.boxModel||"table"==a.tagName.toLowerCase()||l(a)}var k={boxModel:"content-box"};if(c("ie"))k.boxModel="BackCompat"==document.compatMode?"border-box":"content-box";k.getPadExtents=function(b,c){var b=a.byId(b),d=c||f.getComputedStyle(b),g=f.toPixelValue,i=g(b,d.paddingLeft),j=g(b,d.paddingTop),k=g(b,d.paddingRight),d=g(b,d.paddingBottom);return{l:i,t:j,r:k,b:d,w:i+k,h:j+d}};k.getBorderExtents=function(b,c){var b=
a.byId(b),d=f.toPixelValue,g=c||f.getComputedStyle(b),i="none"!=g.borderLeftStyle?d(b,g.borderLeftWidth):0,j="none"!=g.borderTopStyle?d(b,g.borderTopWidth):0,k="none"!=g.borderRightStyle?d(b,g.borderRightWidth):0,d="none"!=g.borderBottomStyle?d(b,g.borderBottomWidth):0;return{l:i,t:j,r:k,b:d,w:i+k,h:j+d}};k.getPadBorderExtents=function(b,c){var b=a.byId(b),d=c||f.getComputedStyle(b),g=k.getPadExtents(b,d),d=k.getBorderExtents(b,d);return{l:g.l+d.l,t:g.t+d.t,r:g.r+d.r,b:g.b+d.b,w:g.w+d.w,h:g.h+d.h}};
k.getMarginExtents=function(b,c){var b=a.byId(b),d=c||f.getComputedStyle(b),g=f.toPixelValue,i=g(b,d.marginLeft),j=g(b,d.marginTop),k=g(b,d.marginRight),d=g(b,d.marginBottom);return{l:i,t:j,r:k,b:d,w:i+k,h:j+d}};k.getMarginBox=function(b,d){var b=a.byId(b),h=d||f.getComputedStyle(b),g=k.getMarginExtents(b,h),i=b.offsetLeft-g.l,j=b.offsetTop-g.t,l=b.parentNode,o=f.toPixelValue;if(c("mozilla")){var v=parseFloat(h.left),h=parseFloat(h.top);!isNaN(v)&&!isNaN(h)?(i=v,j=h):l&&l.style&&(l=f.getComputedStyle(l),
"visible"!=l.overflow&&(i+="none"!=l.borderLeftStyle?o(b,l.borderLeftWidth):0,j+="none"!=l.borderTopStyle?o(b,l.borderTopWidth):0))}else if((c("opera")||8==c("ie")&&!c("quirks"))&&l)l=f.getComputedStyle(l),i-="none"!=l.borderLeftStyle?o(b,l.borderLeftWidth):0,j-="none"!=l.borderTopStyle?o(b,l.borderTopWidth):0;return{l:i,t:j,w:b.offsetWidth+g.w,h:b.offsetHeight+g.h}};k.getContentBox=function(b,d){var b=a.byId(b),g=d||f.getComputedStyle(b),i=b.clientWidth,j=k.getPadExtents(b,g),l=k.getBorderExtents(b,
g);i?(g=b.clientHeight,l.w=l.h=0):(i=b.offsetWidth,g=b.offsetHeight);c("opera")&&(j.l+=l.l,j.t+=l.t);return{l:j.l,t:j.t,w:i-j.w-l.w,h:g-j.h-l.h}};k.setContentSize=function(b,c,d){var b=a.byId(b),f=c.w,c=c.h;i(b)&&(d=k.getPadBorderExtents(b,d),0<=f&&(f+=d.w),0<=c&&(c+=d.h));j(b,NaN,NaN,f,c)};var g={l:0,t:0,w:0,h:0};k.setMarginBox=function(b,d,h){var b=a.byId(b),m=h||f.getComputedStyle(b),h=d.w,n=d.h,s=i(b)?g:k.getPadBorderExtents(b,m),m=k.getMarginExtents(b,m);if(c("webkit")&&l(b)){var p=b.style;if(0<=
h&&!p.width)p.width="4px";if(0<=n&&!p.height)p.height="4px"}0<=h&&(h=Math.max(h-s.w-m.w,0));0<=n&&(n=Math.max(n-s.h-m.h,0));j(b,d.l,d.t,h,n)};k.isBodyLtr=function(a){a=a||d.doc;return"ltr"==(d.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};k.docScroll=function(a){var a=a||d.doc,e=d.doc.parentWindow||d.doc.defaultView;return"pageXOffset"in e?{x:e.pageXOffset,y:e.pageYOffset}:(e=c("quirks")?d.body(a):a.documentElement)&&{x:k.fixIeBiDiScrollLeft(e.scrollLeft||0,a),y:e.scrollTop||0}};if(c("ie"))k.getIeDocumentElementOffset=
function(a){a=a||d.doc;a=a.documentElement;if(8>c("ie")){var e=a.getBoundingClientRect(),f=e.left,e=e.top;7>c("ie")&&(f+=a.clientLeft,e+=a.clientTop);return{x:0>f?0:f,y:0>e?0:e}}return{x:0,y:0}};k.fixIeBiDiScrollLeft=function(a,e){var e=e||d.doc,f=c("ie");if(f&&!k.isBodyLtr(e)){var g=c("quirks"),i=g?d.body(e):e.documentElement,j=d.global;6==f&&!g&&j.frameElement&&i.scrollHeight>i.clientHeight&&(a+=i.clientLeft);return 8>f||g?a+i.clientWidth-i.scrollWidth:-a}return a};k.position=function(b,e){var b=
a.byId(b),f=d.body(b.ownerDocument),g=b.getBoundingClientRect(),g={x:g.left,y:g.top,w:g.right-g.left,h:g.bottom-g.top};if(9>c("ie")){var i=k.getIeDocumentElementOffset(b.ownerDocument);g.x-=i.x+(c("quirks")?f.clientLeft+f.offsetLeft:0);g.y-=i.y+(c("quirks")?f.clientTop+f.offsetTop:0)}e&&(f=k.docScroll(b.ownerDocument),g.x+=f.x,g.y+=f.y);return g};k.getMarginSize=function(b,c){var b=a.byId(b),d=k.getMarginExtents(b,c||f.getComputedStyle(b)),g=b.getBoundingClientRect();return{w:g.right-g.left+d.w,h:g.bottom-
g.top+d.h}};k.normalizeEvent=function(a){if(!("layerX"in a))a.layerX=a.offsetX,a.layerY=a.offsetY};return k})},"frozen/ResourceManager":function(){define(["./sounds/Sound!","dcl","dcl/bases/Mixer","dojo/_base/lang","dojo/on"],function(c,d,a,f,j){function l(a,c){var d=c;a&&(d=[a,c].join("/"));return d.replace(/\/{2,}/g,"/")}return d(a,{imageCount:0,loadedImages:0,allLoaded:!1,imageDir:null,soundDir:null,resourceList:{},loadImage:function(a){var c=!1;if(!Array.isArray(a))if("string"===typeof a)c=!0,
a=[a];else if("object"!==typeof a)return;for(var d in a)if(a.hasOwnProperty(d)){var b=l(this.imageDir,a[d]);if(this.resourceList[b])a[d]=this.resourceList[b].img;else{this.allLoaded=!1;var e=new Image,h={name:b,img:e,complete:!1},m=f.partial(function(a){a.complete=!0},h);j(e,"load",m);e.src=b;this.resourceList[b]=h;a[d]=e}}return c?a[0]:a},loadSound:function(a){var d=!1;if(!Array.isArray(a))if("string"===typeof a)d=!0,a=[a];else if("object"!==typeof a)return;for(var f in a)if(a.hasOwnProperty(f)){var b=
l(this.soundDir,a[f]);if(this.resourceList[b])a[f]=this.resourceList[b];else{this.allLoaded=!1;var e=new c(b);this.resourceList[b]=e;a[f]=e}}return d?a[0]:a},playSound:function(a,c,d,b){a&&(c?a.loop(b):a.play(b,d||0))},resourcesReady:function(){if(!this.allLoaded){for(var a in this.resourceList)if(!this.resourceList[a].complete)return!1;this.allLoaded=!0}return!0},getPercentComplete:function(){var a=0,c=0,d;for(d in this.resourceList){var b=this.resourceList[d];c++;b.complete&&(a+=1)}return 0===c?
0:Math.round(100*(a/c))}})})},"frozen/sounds/Sound":function(){define(["require","dojo/has","../shims/AudioContext"],function(c,d){d.add("WebAudio",function(a){return!!a.AudioContext});return{load:function(a,f,j){c([d("WebAudio")?"./WebAudio":"./HTML5Audio"],function(a){j(a)})}}})},"frozen/shims/AudioContext":function(){define(function(){for(var c=["ms","moz","webkit","o"],d=0;d<c.length&&!window.AudioContext;++d)window.AudioContext=window[c[d]+"AudioContext"]})},"frozen/shims/RAF":function(){define(function(){for(var c=
0,d=["ms","moz","webkit","o"],a=0;a<d.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[d[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[a]+"CancelAnimationFrame"]||window[d[a]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame)window.requestAnimationFrame=function(a){var d=(new Date).getTime(),l=Math.max(0,16-(d-c)),i=window.setTimeout(function(){a(d+l)},l);c=d+l;return i};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(a){clearTimeout(a)}})},
"game/ui/CanvasDND":function(){define(["../state","../createBodies","./DNDFileController","dcl"],function(c,d,a,f){return f([a],{id:"canvas",drop:function(a){try{var f=a.dataTransfer.files;if(f&&1===f.length&&f[0].type.match(/image.*/)){var i=f[0],k=new FileReader;k.onerror=function(){};k.onload=function(a){if(a.target.readyState===FileReader.DONE){var e=new Image;e.onload=function(){c.game.stop();c.backImg=e;c.game.height=e.height;c.game.canvas.height=e.height;c.game.width=e.width;c.game.canvas.width=
e.width;d();c.game.run()};e.src=a.target.result}};k.readAsDataURL(i);this.dragleave(a)}}catch(g){}}})})},"game/ui/DNDFileController":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/on,dojo/dom,dojo/domReady!".split(","),function(c,d,a,f,j){return c([d],{node:null,borderStyle:null,borderDropStyle:"3px dashed red",constructor:function(){if(!this.node)this.node=j.byId(this.id);f(this.node,"dragenter",a.hitch(this,"dragenter"));f(this.node,"dragover",a.hitch(this,"dragover"));f(this.node,
"dragleave",a.hitch(this,"dragleave"));f(this.node,"drop",a.hitch(this,"drop"));this.borderStyle=this.node.style.border},dragenter:function(a){a.stopPropagation();a.preventDefault();this.node.style.border=this.borderDropStyle},dragover:function(a){a.stopPropagation();a.preventDefault()},dragleave:function(a){a.stopPropagation();a.preventDefault();this.node.style.border=this.borderStyle},preDrop:function(a){this.node.style.border=this.borderStyle;a.stopPropagation();a.preventDefault();this.drop(a)},
drop:function(a){var c=function(){},d=function(){return function(){}};try{for(var f=a.dataTransfer.files,a=0;a<f.length;a++){var b=new FileReader;b.onerror=c;b.onload=d(f[a]);b.readAsDataURL(f[a])}return!1}catch(e){}}})})},"game/ui/events":function(){define("../state,../createBodies,./toggleRedo,lodash,dojo/on,dojo/query,dojo/domReady!".split(","),function(c,d,a,f,j){j(document,"#toolForm:change",function(a){c.geometries=[];if("tool"===a.target.name)c.tool=a.target.value;if("toolType"===a.target.name)c.toolType=
a.target.value});j(document,"#load:click",function(){try{var a=JSON.parse(c.codeMirror.getValue());c.jsonObjs=a.objs;if(a.backImg)c.backImg=new Image,c.backImg.src=a.backImg;c.game.height=a.canvas.height;c.game.canvas.height=a.canvas.height;c.game.width=a.canvas.width;c.game.canvas.width=a.canvas.width;d()}catch(f){}});j(document,"#undoBtn:click",function(){c.jsonObjs.length&&(c.undoObjs.push(c.jsonObjs.pop()),d());a()});j(document,"#redoBtn:click",function(){c.undoObjs.length&&(c.jsonObjs.push(c.undoObjs.pop()),
d());a()});j(document,".gravity:change",f.debounce(d,500));j(document,"#runSimulation:change",function(a){c.runSimulation=a.target.checked});j(document,"#showStatic:change",function(a){c.showStatic=a.target.checked});j(document,"selectstart",function(a){a.preventDefault()})})},"game/ui/toggleRedo":function(){define(["../state","dojo/dom"],function(c,d){var a=d.byId("redoBtn");return function(){a.disabled=c.undoObjs.length?!1:!0}})},"dojo/query":function(){define("dojo/query","./_base/kernel,./has,./dom,./on,./_base/array,./_base/lang,./selector/_loader,./selector/_loader!default".split(","),
function(c,d,a,f,j,l,i,k){function g(b,c){var d=function(d,e){if("string"==typeof e&&(e=a.byId(e),!e))return new c([]);var f="string"==typeof d?b(d,e):d?d.orphan?d:[d]:[];return f.orphan?f:new c(f)};d.matches=b.match||function(a,b,c){return 0<d.filter([a],b,c).length};d.filter=b.filter||function(a,b,c){return d(b,c).filter(function(b){return-1<j.indexOf(a,b)})};if("function"!=typeof b)var e=b.search,b=function(a,b){return e(b||document,a)};return d}d.add("array-extensible",function(){return 1==l.delegate([],
{length:1}).length&&!d("bug-for-in-skips-shadowed")});var b=Array.prototype,e=b.slice,h=b.concat,m=j.forEach,n=function(a,b,d){b=[0].concat(e.call(b,0));d=d||c.global;return function(c){b[0]=c;return a.apply(d,b)}},s=function(a){var b=this instanceof p&&d("array-extensible");"number"==typeof a&&(a=Array(a));var c=a&&"length"in a?a:arguments;if(b||!c.sort){for(var e=b?this:[],f=e.length=c.length,g=0;g<f;g++)e[g]=c[g];if(b)return e;c=e}l._mixin(c,o);c._NodeListCtor=function(a){return p(a)};return c},
p=s,o=p.prototype=d("array-extensible")?[]:{};p._wrap=o._wrap=function(a,b,c){a=new (c||this._NodeListCtor||p)(a);return b?a._stash(b):a};p._adaptAsMap=function(a,b){return function(){return this.map(n(a,arguments,b))}};p._adaptAsForEach=function(a,b){return function(){this.forEach(n(a,arguments,b));return this}};p._adaptAsFilter=function(a,b){return function(){return this.filter(n(a,arguments,b))}};p._adaptWithCondition=function(a,b,d){return function(){var e=arguments,f=n(a,e,d);if(b.call(d||c.global,
e))return this.map(f);this.forEach(f);return this}};m(["slice","splice"],function(a){var c=b[a];o[a]=function(){return this._wrap(c.apply(this,arguments),"slice"==a?this:null)}});m(["indexOf","lastIndexOf","every","some"],function(a){var b=j[a];o[a]=function(){return b.apply(c,[this].concat(e.call(arguments,0)))}});l.extend(s,{constructor:p,_NodeListCtor:p,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,b){var c=this.map(function(c){return f(c,
a,b)});c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()};return c},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},concat:function(a){var b=e.call(this,0),c=j.map(arguments,function(a){return e.call(a,0)});return this._wrap(h.apply(b,c),this)},map:function(a,b){return this._wrap(j.map(this,a,b),this)},forEach:function(a,b){m(this,a,b);return this},filter:function(a){var b=arguments,c=this,d=0;if("string"==typeof a){c=v._filterResult(this,b[0]);if(1==b.length)return c._stash(this);
d=1}return this._wrap(j.filter(c,b[d],b[d+1]),this)},instantiate:function(a,b){var c=l.isFunction(a)?a:l.getObject(a),b=b||{};return this.forEach(function(a){new c(b,a)})},at:function(){var a=new this._NodeListCtor(0);m(arguments,function(b){0>b&&(b=this.length+b);this[b]&&a.push(this[b])},this);return a._stash(this)}});var v=g(k,s);c.query=g(k,function(a){return s(a)});v.load=function(a,b,c){i.load(a,b,function(a){c(g(a,s))})};c._filterQueryResult=v._filterResult=function(a,b,c){return new s(v.filter(a,
b,c))};c.NodeList=v.NodeList=s;return v})},"dojo/selector/_loader":function(){define(["../has","require"],function(c,d){var a=document.createElement("div");c.add("dom-qsa2.1",!!a.querySelectorAll);c.add("dom-qsa3",function(){try{return a.innerHTML="<p class='TEST'></p>",1==a.querySelectorAll(".TEST:empty").length}catch(c){}});var f;return{load:function(a,l,i){var k=d,a="default"==a?c("config-selectorEngine")||"css3":a,a="css2"==a||"lite"==a?"./lite":"css2.1"==a?c("dom-qsa2.1")?"./lite":"./acme":"css3"==
a?c("dom-qsa3")?"./lite":"./acme":"acme"==a?"./acme":(k=l)&&a;if("?"==a.charAt(a.length-1))var a=a.substring(0,a.length-1),g=!0;if(g&&(c("dom-compliant-qsa")||f))return i(f);k([a],function(b){"./lite"!=a&&(f=b);i(b)})}}})},"dojo/selector/acme":function(){define(["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],function(c,d,a,f,j){var l=f.trim,i=a.forEach,k="BackCompat"==j.doc.compatMode,g=!1,b=function(){return!0},e=function(a){for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":
a+" ",b=function(b,c){return l(a.slice(b,c))},c=[],d=-1,e=-1,f=-1,h=-1,i=-1,j=-1,k=-1,m,o="",n="",s,q=0,u=a.length,p=null,r=null,v=function(){if(0<=j)p.id=b(j,q).replace(/\\/g,""),j=-1;if(0<=k){var a=k==q?null:b(k,q);p[0>">~+".indexOf(a)?"tag":"oper"]=a;k=-1}0<=i&&(p.classes.push(b(i+1,q).replace(/\\/g,"")),i=-1)};o=n,n=a.charAt(q),q<u;q++)if("\\"!=o)if(p||(s=q,p={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return g?this.otag:this.tag}},k=q),m)n==m&&(m=null);
else if("'"==n||'"'==n)m=n;else if(0<=d)if("]"==n){r.attr?r.matchFor=b(f||d+1,q):r.attr=b(d+1,q);if((d=r.matchFor)&&('"'==d.charAt(0)||"'"==d.charAt(0)))r.matchFor=d.slice(1,-1);if(r.matchFor)r.matchFor=r.matchFor.replace(/\\/g,"");p.attrs.push(r);r=null;d=f=-1}else{if("="==n)f=0<="|~^$*".indexOf(o)?o:"",r.type=f+n,r.attr=b(d+1,q-f.length),f=q+1}else if(0<=e){if(")"==n){if(0<=h)r.value=b(e+1,q);h=e=-1}}else if("#"==n)v(),j=q+1;else if("."==n)v(),i=q;else if(":"==n)v(),h=q;else if("["==n)v(),d=q,r=
{};else if("("==n)0<=h&&(r={name:b(h+1,q),value:null},p.pseudos.push(r)),e=q;else if(" "==n&&o!=n){v();0<=h&&p.pseudos.push({name:b(h+1,q)});p.loops=p.pseudos.length||p.attrs.length||p.classes.length;p.oquery=p.query=b(s,q);p.otag=p.tag=p.oper?null:p.tag||"*";if(p.tag)p.tag=p.tag.toUpperCase();if(c.length&&c[c.length-1].oper)p.infixOper=c.pop(),p.query=p.infixOper.query+" "+p.query;c.push(p);p=null}return c},h=function(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,
arguments)}},m=function(a,b){var c=b||[];a&&c.push(a);return c},n=function(a){return 1==a.nodeType},s=function(a,b){return!a?"":"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(g?a.getAttribute(b):a.getAttribute(b,2))||""},p={"*=":function(a,b){return function(c){return 0<=s(c,a).indexOf(b)}},"^=":function(a,b){return function(c){return 0==s(c,a).indexOf(b)}},"$=":function(a,b){return function(c){var c=" "+s(c,a),d=c.lastIndexOf(b);return-1<d&&d==c.length-b.length}},
"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+s(b,a)+" ").indexOf(c)}},"|=":function(a,b){var c=b+"-";return function(d){d=s(d,a);return d==b||0==d.indexOf(c)}},"=":function(a,b){return function(c){return s(c,a)==b}}},o="undefined"==typeof j.doc.firstChild.nextElementSibling,v=!o?"nextElementSibling":"nextSibling",K=!o?"previousElementSibling":"previousSibling",L=o?n:b,q=function(a){for(;a=a[K];)if(L(a))return!1;return!0},r=function(a){for(;a=a[v];)if(L(a))return!1;return!0},
u=function(a){var b=a.parentNode,b=7!=b.nodeType?b:b.nextSibling,c=0,e=b.children||b.childNodes,f=a._i||a.getAttribute("_i")||-1,g=b._l||("undefined"!==typeof b.getAttribute?b.getAttribute("_l"):-1);if(!e)return-1;e=e.length;if(g==e&&0<=f&&0<=g)return f;d("ie")&&"undefined"!==typeof b.setAttribute?b.setAttribute("_l",e):b._l=e;f=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[v])if(L(b))d("ie")?b.setAttribute("_i",++c):b._i=++c,a===b&&(f=c);return f},D=function(a){return!(u(a)%2)},z=function(a){return u(a)%
2},w={checked:function(){return function(a){return!!("checked"in a?a.checked:a.selected)}},disabled:function(){return function(a){return a.disabled}},enabled:function(){return function(a){return!a.disabled}},"first-child":function(){return q},"last-child":function(){return r},"only-child":function(){return function(a){return q(a)&&r(a)}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return!1}return!0}},contains:function(a,
b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},not:function(a,b){var c=e(b)[0],d={el:1};if("*"!=c.tag)d.tag=1;if(!c.classes.length)d.classes=1;var f=G(c,d);return function(a){return!f(a)}},"nth-child":function(a,b){var c=parseInt;if("odd"==b)return z;if("even"==b)return D;if(-1!=b.indexOf("n")){var d=b.split("n",2),e=d[0]?"-"==d[0]?-1:c(d[0]):1,f=d[1]?c(d[1]):0,g=0,h=-1;0<e?0>f?f=f%e&&e+f%e:0<f&&(f>=e&&(g=f-f%e),f%=e):0>e&&(e*=-1,0<f&&
(h=f,f%=e));if(0<e)return function(a){a=u(a);return a>=g&&(0>h||a<=h)&&a%e==f};b=f}var i=c(b);return function(a){return u(a)==i}}},V=9>d("ie")||9==d("ie")&&d("quirks")?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return g?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},G=function(a,c){if(!a)return b;var c=c||{},d=null;"el"in c||(d=h(d,n));"tag"in c||"*"!=a.tag&&(d=h(d,function(b){return b&&(g?b.tagName:
b.tagName.toUpperCase())==a.getTag()}));"classes"in c||i(a.classes,function(a,b){var c=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");d=h(d,function(a){return c.test(a.className)});d.count=b});"pseudos"in c||i(a.pseudos,function(a){var b=a.name;w[b]&&(d=h(d,w[b](b,a.value)))});"attrs"in c||i(a.attrs,function(a){var b,c=a.attr;a.type&&p[a.type]?b=p[a.type](c,a.matchFor):c.length&&(b=V(c));b&&(d=h(d,b))});"id"in c||a.id&&(d=h(d,function(b){return!!b&&b.id==a.id}));d||"default"in c||(d=b);return d},qa=function(a){return function(b,
c,d){for(;b=b[v];)if(!o||n(b)){(!d||J(b,d))&&a(b)&&c.push(b);break}return c}},ka=function(a){return function(b,c,d){for(b=b[v];b;){if(L(b)){if(d&&!J(b,d))break;a(b)&&c.push(b)}b=b[v]}return c}},$=function(a){a=a||b;return function(b,c,d){for(var e=0,f=b.children||b.childNodes;b=f[e++];)L(b)&&(!d||J(b,d))&&a(b,e)&&c.push(b);return c}},W={},O=function(a){var d=W[a.query];if(d)return d;var e=a.infixOper,e=e?e.oper:"",f=G(a,{el:1}),g="*"==a.tag,h=j.doc.getElementsByClassName;if(e){h={el:1};if(g)h.tag=
1;f=G(a,h);"+"==e?d=qa(f):"~"==e?d=ka(f):">"==e&&(d=$(f))}else if(a.id)f=!a.loops&&g?b:G(a,{el:1,id:1}),d=function(b,d){var e=c.byId(a.id,b.ownerDocument||b);if(e&&f(e)){if(9==b.nodeType)return m(e,d);for(var g=e.parentNode;g&&!(g==b);)g=g.parentNode;if(g)return m(e,d)}};else if(h&&/\{\s*\[native code\]\s*\}/.test(""+h)&&a.classes.length&&!k)var f=G(a,{el:1,classes:1,id:1}),i=a.classes.join(" "),d=function(a,b,c){for(var b=m(0,b),d,e=0,g=a.getElementsByClassName(i);d=g[e++];)f(d,a)&&J(d,c)&&b.push(d);
return b};else!g&&!a.loops?d=function(b,c,d){for(var c=m(0,c),e=0,f=a.getTag(),f=f?b.getElementsByTagName(f):[];b=f[e++];)J(b,d)&&c.push(b);return c}:(f=G(a,{el:1,tag:1,id:1}),d=function(b,c,d){for(var c=m(0,c),e,g=0,h=(e=a.getTag())?b.getElementsByTagName(e):[];e=h[g++];)f(e,b)&&J(e,d)&&c.push(e);return c});return W[a.query]=d},A={},X={},M=function(a){var b=e(l(a));if(1==b.length){var c=O(b[0]);return function(a){if(a=c(a,[]))a.nozip=!0;return a}}return function(a){for(var a=m(a),c,d,e=b.length,
f,g,h=0;h<e;h++){g=[];c=b[h];d=a.length-1;if(0<d)f={},g.nozip=!0;d=O(c);for(var i=0;c=a[i];i++)d(c,g,f);if(!g.length)break;a=g}return g}},Y=d("ie")?"commentStrip":"nozip",H=!!j.doc.querySelectorAll,aa=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,ba=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},ca=/([^[]*)([^\]]*])?/g,la=function(a,b,c){return b.replace(aa,ba)+(c||"")},N=function(a,b){a=a.replace(ca,la);if(H){var c=X[a];if(c&&!b)return c}if(c=A[a])return c;var c=a.charAt(0),e=-1==a.indexOf(" ");
0<=a.indexOf("#")&&e&&(b=!0);if(H&&!b&&-1==">~+".indexOf(c)&&(!d("ie")||-1==a.indexOf(":"))&&!(k&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf(":checked")&&-1==a.indexOf("|=")){var f=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return X[a]=function(b){try{if(!(9==b.nodeType||e))throw"";var c=b.querySelectorAll(f);c[Y]=!0;return c}catch(d){return N(a,!0)(b)}}}var g=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return A[a]=2>g.length?M(a):function(a){for(var b=0,
c=[],d;d=g[b++];)c=c.concat(M(d)(a));return c}},F=0,ja=d("ie")?function(a){return g?a.getAttribute("_uid")||a.setAttribute("_uid",++F)||F:a.uniqueID}:function(a){return a._uid||(a._uid=++F)},J=function(a,b){if(!b)return 1;var c=ja(a);return!b[c]?b[c]=1:0},I=function(a){if(a&&a.nozip)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);if(2>a.length)return b;F++;var c,e;if(d("ie")&&g){var f=F+"";a[0].setAttribute("_zipIdx",f);for(c=1;e=a[c];c++)a[c].getAttribute("_zipIdx")!=f&&b.push(e),
e.setAttribute("_zipIdx",f)}else if(d("ie")&&a.commentStrip)try{for(c=1;e=a[c];c++)n(e)&&b.push(e)}catch(h){}else{a[0]&&(a[0]._zipIdx=F);for(c=1;e=a[c];c++)a[c]._zipIdx!=F&&b.push(e),e._zipIdx=F}return b},C=function(a,b){b=b||j.doc;g="div"===(b.ownerDocument||b).createElement("div").tagName;var c=N(a)(b);return c&&c.nozip?c:I(c)};C.filter=function(b,d,f){for(var g=[],h=e(d),h=1==h.length&&!/[^\w#\.]/.test(d)?G(h[0]):function(b){return-1!=a.indexOf(C(d,c.byId(f)),b)},i=0,j;j=b[i];i++)h(j)&&g.push(j);
return g};return C})}}});(function(){require({cache:{}});require.boot&&require.apply(null,require.boot)})();