//>>built
(function(b,d){var a,e,f,j=function(){},h=function(c){for(var a in c)return 0;return 1},k={}.toString,l=function(c){return"[object Function]"==k.call(c)},c=function(c){return"[object String]"==k.call(c)},g=function(c){return"[object Array]"==k.call(c)},i=function(c,a){if(c)for(var b=0;b<c.length;)a(c[b++])},m=function(c,a){for(var b in a)c[b]=a[b];return c},o=function(c,a){return m(Error(c),{src:"dojoLoader",info:a})},p=1,r=function(){return"_"+p++},n=function(c,a,b){return ja(c,a,b,0,n)},u=this,
K=u.document,L=K&&K.createElement("DiV"),t=n.has=function(c){return l(s[c])?s[c]=s[c](u,K,L):s[c]},s=t.cache=d.hasCache;t.add=function(c,a,b,g){(void 0===s[c]||g)&&(s[c]=a);return b&&t(c)};for(var q in b.has)t.add(q,b.has[q],0,1);n.async=1;var D=new Function("return eval(arguments[0]);");n.eval=function(c,a){return D(c+"\r\n////@ sourceURL="+a)};var z={},w=n.signal=function(c,a){var b=z[c];i(b&&b.slice(0),function(c){c.apply(null,g(a)?a:[a])})},V=n.on=function(c,a){var b=z[c]||(z[c]=[]);b.push(a);
return{remove:function(){for(var c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}}}},G=[],qa={},ka=[],$={},W=n.map={},O=[],A={},X="",M={},Y={};q={};var H=function(c){var a,b,g,i;for(a in Y)b=Y[a],(g=a.match(/^url\:(.+)/))?M["url:"+Ia(g[1],c)]=b:"*now"==a?i=b:"*noref"!=a&&(g=ra(a,c),M[g.mid]=M["url:"+g.url]=b);i&&i(J(c));Y={}},aa=function(c){return c.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(c){return"\\"+c})},ba=function(c,a){a.splice(0,a.length);for(var b in c)a.push([b,c[b],RegExp("^"+
aa(b)+"(/|$)"),b.length]);a.sort(function(c,a){return a[3]-c[3]});return a},ca=function(c){var a=c.name;a||(a=c,c={name:a});c=m({main:"main"},c);c.location=c.location?c.location:a;if(c.packageMap)W[a]=c.packageMap;if(!c.main.indexOf("./"))c.main=c.main.substring(2);$[a]=c},la=[],N=function(a,b,g){for(var d in a){if("waitSeconds"==d)n.waitms=1E3*(a[d]||0);"cacheBust"==d&&(X=a[d]?c(a[d])?a[d]:(new Date).getTime()+"":"");if("baseUrl"==d||"combo"==d)n[d]=a[d];a[d]!==s&&(n.rawConfig[d]=a[d],"has"!=d&&
t.add("config-"+d,a[d],0,b))}if(!n.baseUrl)n.baseUrl="./";/\/$/.test(n.baseUrl)||(n.baseUrl+="/");for(d in a.has)t.add(d,a.has[d],0,b);i(a.packages,ca);for(f in a.packagePaths)i(a.packagePaths[f],function(a){var b=f+"/"+a;c(a)&&(a={name:a});a.location=b;ca(a)});ba(m(W,a.map),O);i(O,function(c){c[1]=ba(c[1],[]);if("*"==c[0])O.star=c});ba(m(qa,a.paths),ka);i(a.aliases,function(a){c(a[0])&&(a[0]=RegExp("^"+aa(a[0])+"$"));G.push(a)});if(b)la.push({config:a.config});else for(d in a.config)b=Z(d,g),b.config=
m(b.config||{},a.config[d]);if(a.cache)H(),Y=a.cache,a.cache["*noref"]&&H();w("config",[a,n.rawConfig])};n.rawConfig={};N(d,1);N(b,1);N(q,1);var F=function(c){B(function(){i(c.deps,Ka)})},ja=function(a,b,i,d,e){var h;if(c(a)){if((h=Z(a,d,!0))&&h.executed)return h.result;throw o("undefinedModule",a);}g(a)||(N(a,0,d),a=b,b=i);if(g(a))if(a.length){for(var i="require*"+r(),f,l=[],k=0;k<a.length;)f=a[k++],l.push(Z(f,d));h=m(sa("",i,0,""),{injected:2,deps:l,def:b||j,require:d?d.require:n,gc:1});A[h.mid]=
h;F(h);var p=da&&0!="sync";B(function(){ma(h,p)});h.executed||I.push(h);y()}else b&&b();return e},J=function(c){if(!c)return n;var a=c.require;if(!a)a=function(b,g,i){return ja(b,g,i,c,a)},c.require=m(a,n),a.module=c,a.toUrl=function(a){return Ia(a,c)},a.toAbsMid=function(a){return ea(a,c)};return a},I=[],C=[],v={},Ua=function(c){c.injected=1;v[c.mid]=1;c.url&&(v[c.url]=c.pack||1);ta()},oa=function(c){c.injected=2;delete v[c.mid];c.url&&delete v[c.url];h(v)&&na()},Va=n.idle=function(){return!C.length&&
h(v)&&!I.length&&!da},Da=function(c,a){if(a)for(var b=0;b<a.length;b++)if(a[b][2].test(c))return a[b];return 0},La=function(c){for(var a=[],b,g,c=c.replace(/\\/g,"/").split("/");c.length;)b=c.shift(),".."==b&&a.length&&".."!=g?(a.pop(),g=a[a.length-1]):"."!=b&&a.push(g=b);return a.join("/")},sa=function(c,a,b,g){return{pid:c,mid:a,pack:b,url:g,executed:0,def:0}},Ma=function(c,b,g,d,j,h,e,f){var m,k,p,v;v=/^\./.test(c);if(/(^\/)|(\:)|(\.js$)/.test(c)||v&&!b)return sa(0,c,0,c);c=La(v?b.mid+"/../"+c:
c);if(/^\./.test(c))throw o("irrationalPath",c);b&&(p=Da(b.mid,h));(p=(p=p||h.star)&&Da(c,p[1]))&&(c=p[1]+c.substring(p[3]));b=(a=c.match(/^([^\/]+)(\/(.+))?$/))?a[1]:"";(m=g[b])?c=b+"/"+(k=a[3]||m.main):b="";var n=0;i(G,function(a){var b=c.match(a[0]);b&&0<b.length&&(n=l(a[1])?c.replace(a[0],a[1]):a[1])});if(n)return Ma(n,0,g,d,j,h,e,f);if(g=d[c])return f?sa(g.pid,g.mid,g.pack,g.url):d[c];d=(p=Da(c,e))?p[1]+c.substring(p[3]):b?m.location+"/"+k:c;/(^\/)|(\:)/.test(d)||(d=j+d);return sa(b,c,m,La(d+
".js"))},ra=function(c,a){return Ma(c,a,$,A,n.baseUrl,O,ka)},Na=function(c,a,b){return c.normalize?c.normalize(a,function(c){return ea(c,b)}):ea(a,b)},Oa=0,Z=function(c,a,b){var g,i;(g=c.match(/^(.+?)\!(.*)$/))?(i=Z(g[1],a,b),5===i.executed&&!i.load&&fa(i),i.load?(g=Na(i,g[2],a),c=i.mid+"!"+(i.dynamic?++Oa+"!":"")+g):(g=g[2],c=i.mid+"!"+ ++Oa+"!waitingForPlugin"),c={plugin:i,mid:c,req:J(a),prid:g}):c=ra(c,a);return A[c.mid]||!b&&(A[c.mid]=c)},ea=n.toAbsMid=function(c,a){return ra(c,a).mid},Ia=n.toUrl=
function(c,a){var b=ra(c+"/x",a),g=b.url;return S(0===b.pid?c:g.substring(0,g.length-5))},Ea={injected:2,executed:5,def:3,result:3},P=function(c){return A[c]=m({mid:c},Ea)},Wa=P("require"),Xa=P("exports"),Pa=P("module"),ua={},Fa=0,fa=function(c){var a=c.result;c.dynamic=a.dynamic;c.normalize=a.normalize;c.load=a.load;return c},Qa=function(c){var a={};i(c.loadQ,function(b){var g=Na(c,b.prid,b.req.module),i=c.dynamic?b.mid.replace(/waitingForPlugin$/,g):c.mid+"!"+g,g=m(m({},b),{mid:i,prid:g,injected:0});
A[i]||va(A[i]=g);a[b.mid]=A[i];oa(b);delete A[b.mid]});c.loadQ=0;var b=function(c){for(var b=c.deps||[],g=0;g<b.length;g++)(c=a[b[g].mid])&&(b[g]=c)},g;for(g in A)b(A[g]);i(I,b)},T=function(c){n.trace("loader-finish-exec",[c.mid]);c.executed=5;c.defOrder=Fa++;c.loadQ&&(fa(c),Qa(c));for(e=0;e<I.length;)I[e]===c?I.splice(e,1):e++;/^require\*/.test(c.mid)&&delete A[c.mid]},E=[],ma=function(c,a){if(4===c.executed)return n.trace("loader-circular-dependency",[E.concat(c.mid).join("->")]),!c.def||a?ua:c.cjs&&
c.cjs.exports;if(!c.executed){if(!c.def)return ua;var b=c.mid,g=c.deps||[],i,d=[],j=0;for(c.executed=4;j<g.length;){i=g[j++];i=i===Wa?J(c):i===Xa?c.cjs.exports:i===Pa?c.cjs:ma(i,a);if(i===ua)return c.executed=0,n.trace("loader-exec-module",["abort",b]),ua;d.push(i)}n.trace("loader-run-factory",[c.mid]);b=c.def;d=l(b)?b.apply(null,d):b;c.result=void 0===d&&c.cjs?c.cjs.exports:d;T(c)}return c.result},da=0,B=function(c){try{da++,c()}finally{da--}Va()&&w("idle",[])},y=function(){da||B(function(){for(var c,
a,b=0;b<I.length;)c=Fa,a=I[b],ma(a),c!=Fa?b=0:b++})};void 0===t("dojo-loader-eval-hint-url")&&t.add("dojo-loader-eval-hint-url",1);var S=function(c){c+="";return c+(X?(/\?/.test(c)?"&":"?")+X:"")},va=function(c){var a=c.plugin;5===a.executed&&!a.load&&fa(a);var b=function(a){c.result=a;oa(c);T(c);y()};a.load?a.load(c.prid,c.req,b):a.loadQ?a.loadQ.push(c):(a.loadQ=[c],I.unshift(a),Ka(a))},wa=0,Ga=0,Q=0,xa=function(c,a){t("config-stripStrict")&&(c=c.replace(/"use strict"/g,""));Q=1;c===wa?wa.call(null):
n.eval(c,t("dojo-loader-eval-hint-url")?a.url:a.mid);Q=0},Ka=function(c){var a=c.mid,b=c.url;if(!c.executed&&!c.injected&&!(v[a]||c.url&&(c.pack&&v[c.url]===c.pack||1==v[c.url])))if(Ua(c),c.plugin)va(c);else{var g=function(){ya(c);2!==c.injected&&(oa(c),m(c,Ea),n.trace("loader-define-nonmodule",[c.url]));y()};(wa=M[a]||M["url:"+c.url])?(n.trace("loader-inject",["cache",c.mid,b]),xa(wa,c),g()):(n.trace("loader-inject",["script",c.mid,b]),Ga=c,n.injectUrl(S(b),g,c),Ga=0)}},za=function(c,a,b){n.trace("loader-define-module",
[c.mid,a]);if(2===c.injected)return w("error",o("multipleDefine",c)),c;m(c,{deps:a,def:b,cjs:{id:c.mid,uri:c.url,exports:c.result={},setExports:function(a){c.cjs.exports=a},config:function(){return c.config}}});for(var g=0;g<a.length;g++)a[g]=Z(a[g],c);oa(c);if(!l(b)&&!a.length)c.result=b,T(c);return c},ya=function(c,a){for(var b=[],g,d;C.length;)d=C.shift(),a&&(d[0]=a.shift()),g=d[0]&&Z(d[0])||c,b.push([g,d[1],d[2]]);H(c);i(b,function(c){F(za.apply(null,c))})},na=j,ta=j;t.add("ie-event-behavior",
!!K.attachEvent&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var ga=function(c,a,b,g){if(t("ie-event-behavior"))return c.attachEvent(b,g),function(){c.detachEvent(b,g)};c.addEventListener(a,g,!1);return function(){c.removeEventListener(a,g,!1)}},pa=ga(window,"load","onload",function(){n.pageLoaded=1;"complete"!=K.readyState&&(K.readyState="complete");pa()}),ha=K.getElementsByTagName("script")[0],Aa=ha.parentNode;n.injectUrl=function(c,a,b){var b=b.node=K.createElement("script"),
g=ga(b,"load","onreadystatechange",function(c){var c=c||window.event,b=c.target||c.srcElement;if("load"===c.type||/complete|loaded/.test(b.readyState))g(),i(),a&&a()}),i=ga(b,"error","onerror",function(a){g();i();w("error",o("scriptError",[c,a]))});b.type="text/javascript";b.charset="utf-8";b.src=c;Aa.insertBefore(b,ha);return b};n.log=j;n.trace=j;P=function(a,b,g){var i=arguments.length,d=["require","exports","module"],j=[0,a,b];1==i?j=[0,l(a)?d:[],a]:2==i&&c(a)?j=[a,l(b)?d:[],b]:3==i&&(j=[a,b,g]);
n.trace("loader-define",j.slice(0,2));if((i=j[0]&&Z(j[0]))&&!v[i.mid])F(za(i,j[1],j[2]));else if(!t("ie-event-behavior")||Q)C.push(j);else{i=i||Ga;if(!i)for(a in v)if((d=A[a])&&d.node&&"interactive"===d.node.readyState){i=d;break}i?(H(i),F(za(i,j[1],j[2]))):w("error",o("ieDefineFailed",j[0]));y()}};P.amd={vendor:"dojotoolkit.org"};m(m(n,d.loaderPatch),b.loaderPatch);V("error",function(c){try{if(console.error(c),c instanceof Error)for(var a in c);}catch(b){}});m(n,{uid:r,cache:M,packs:$});if(!u.define)u.define=
P,u.require=n,i(la,function(c){N(c)}),V=q.deps||b.deps||d.deps,q=q.callback||b.callback||d.callback,n.boot=V||q?[V||[],q]:0})(this.dojoConfig||this.djConfig||this.require||{},{async:1,baseUrl:"./",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../frozen-editor",name:"frozen-editor"},{location:".",name:"dojo"},{location:"../dcl",main:"dcl",name:"dcl"},{location:"../frozen",main:"GameCore",name:"frozen"},
{location:"../lodash",main:"lodash",name:"lodash"},{location:"../game",main:"game",name:"game"}]});
require({cache:{"dist/game":function(){define([],1)},"game/game":function(){define("./state,./handleInput,./draw,frozen/box2d/BoxGame,./ui/CanvasDND,./ui/events".split(","),function(b,d,a,e,f){d=new e({canvasId:"canvas",handleInput:d,draw:a});b.game=d;new f;d.run()})},"game/state":function(){define(["./box","./StateManager","dojo/dom"],function(b,d,a){return new d({entities:{},jsonObjs:[],undoObjs:[],geometries:[],tool:"rectangle",toolType:"static",showStatic:!0,box:b,backImg:null,game:null,codeMirror:CodeMirror.fromTextArea(a.byId("output"),
{theme:"frozen",matchBrackets:!0,lineWrapping:!0,mode:"application/json"})})})},"game/box":function(){define(["./ui/getGravity","frozen/box2d/Box"],function(b,d){var a=b();return new d({gravityY:a.y,gravityX:a.x})})},"game/ui/getGravity":function(){define(["dojo/dom","dojo/domReady!"],function(b){var d=b.byId("gravityX"),a=b.byId("gravityY");return function(){return{x:parseFloat(d.value,10),y:parseFloat(a.value,10)}}})},"dojo/dom":function(){define(["./sniff","./_base/window"],function(b,d){if(7>=
b("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}var e={};e.byId=b("ie")?function(a,b){if("string"!=typeof a)return a;var e=b||d.doc,f=a&&e.getElementById(a);if(f&&(f.attributes.id.value==a||f.id==a))return f;e=e.all[a];if(!e||e.nodeName)e=[e];for(var c=0;f=e[c++];)if(f.attributes&&f.attributes.id&&f.attributes.id.value==a||f.id==a)return f}:function(a,b){return("string"==typeof a?(b||d.doc).getElementById(a):a)||null};e.isDescendant=function(a,b){try{a=e.byId(a);for(b=e.byId(b);a;){if(a==
b)return!0;a=a.parentNode}}catch(d){}return!1};b.add("css-user-select",function(a,b,d){if(!d)return!1;var a=d.style,b=["Khtml","O","ms","Moz","Webkit"],d=b.length,f="userSelect";do if("undefined"!==typeof a[f])return f;while(d--&&(f=b[d]+"UserSelect"));return!1});var f=b("css-user-select");e.setSelectable=f?function(a,b){e.byId(a).style[f]=b?"":"none"}:function(a,b){var a=e.byId(a),d=a.getElementsByTagName("*"),f=d.length;if(b)for(a.removeAttribute("unselectable");f--;)d[f].removeAttribute("unselectable");
else for(a.setAttribute("unselectable","on");f--;)d[f].setAttribute("unselectable","on")};return e})},"dojo/sniff":function(){define(["./has"],function(b){var d=navigator,a=d.userAgent,d=d.appVersion,e=parseFloat(d);b.add("air",0<=a.indexOf("AdobeAIR"));b.add("khtml",0<=d.indexOf("Konqueror")?e:void 0);b.add("webkit",parseFloat(a.split("WebKit/")[1])||void 0);b.add("chrome",parseFloat(a.split("Chrome/")[1])||void 0);b.add("safari",0<=d.indexOf("Safari")&&!b("chrome")?parseFloat(d.split("Version/")[1]):
void 0);b.add("mac",0<=d.indexOf("Macintosh"));b.add("quirks","BackCompat"==document.compatMode);b.add("ios",/iPhone|iPod|iPad/.test(a));b.add("android",parseFloat(a.split("Android ")[1])||void 0);if(!b("webkit")){0<=a.indexOf("Opera")&&b.add("opera",9.8<=e?parseFloat(a.split("Version/")[1])||e:e);0<=a.indexOf("Gecko")&&!b("khtml")&&!b("webkit")&&b.add("mozilla",e);b("mozilla")&&b.add("ff",parseFloat(a.split("Firefox/")[1]||a.split("Minefield/")[1])||void 0);if(document.all&&!b("opera"))a=parseFloat(d.split("MSIE ")[1])||
void 0,(d=document.documentMode)&&5!=d&&Math.floor(a)!=d&&(a=d),b.add("ie",a);b.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return b})},"dojo/has":function(){define(["require","module"],function(b){var d=b.has||function(){};d.add("touch","ontouchstart"in document);d.add("device-width",screen.availWidth||innerWidth);b=document.createElement("form");d.add("dom-attributes-explicit",0==b.attributes.length);d.add("dom-attributes-specified-flag",0<b.attributes.length&&40>b.attributes.length);
d.clearElement=function(a){a.innerHTML="";return a};d.normalize=function(a,b){var f=a.match(/[\?:]|[^:\?]*/g),j=0,h=function(a){var b=f[j++];if(":"==b)return 0;if("?"==f[j++]){if(!a&&d(b))return h();h(!0);return h(a)}return b||0};return(a=h())&&b(a)};d.load=function(a,b,d){a?b([a],d):d()};return d})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(b,d,a){var e={global:b.global,doc:this.document||null,body:function(a){a=a||b.doc;return a.body||a.getElementsByTagName("body")[0]},
setContext:function(a,d){b.global=e.global=a;b.doc=e.doc=d},withGlobal:function(a,d,h,k){var l=b.global;try{return b.global=e.global=a,e.withDoc.call(null,a.document,d,h,k)}finally{b.global=e.global=l}},withDoc:function(d,j,h,k){var l=e.doc,c=a("quirks"),g=a("ie"),i,m,o;try{b.doc=e.doc=d;b.isQuirks=a.add("quirks","BackCompat"==b.doc.compatMode,!0,!0);if(a("ie")&&(o=d.parentWindow)&&o.navigator)i=parseFloat(o.navigator.appVersion.split("MSIE ")[1])||void 0,(m=d.documentMode)&&5!=m&&Math.floor(i)!=
m&&(i=m),b.isIE=a.add("ie",i,!0,!0);h&&"string"==typeof j&&(j=h[j]);return j.apply(h,k||[])}finally{b.doc=e.doc=l,b.isQuirks=a.add("quirks",c,!0,!0),b.isIE=a.add("ie",g,!0,!0)}}};d.mixin(b,e);return e})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(b,d,a,e){var f,b={},j={},h={config:d,global:this,dijit:b,dojox:j},b={dojo:["dojo",h],dijit:["dijit",b],dojox:["dojox",j]},e=a.map&&a.map[e.id.match(/[^\/]+/)[0]];for(f in e)b[f]?b[f][0]=e[f]:b[f]=[e[f],{}];for(f in b)e=
b[f],e[1]._scopeName=e[0],d.noGlobals||(this[e[0]]=e[1]);h.scopeMap=b;h.baseUrl=h.config.baseUrl=a.baseUrl;h.isAsync=a.async;h.locale=d.locale;d="$Rev: 30226 $".match(/\d+/);h.version={major:1,minor:8,patch:3,flag:"",revision:d?+d[0]:NaN,toString:function(){var a=h.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(h);h.exit=function(){};h.deprecated=h.experimental=
function(){};h._hasResource={};return h})},"dojo/_base/config":function(){define(["../has","require"],function(b,d){var a={},e=d.rawConfig,f;for(f in e)a[f]=e[f];return a})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(b,d){d.add("bug-for-in-skips-shadowed",function(){for(var c in{toString:1})return 0;return 1});var a=d("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],e=a.length,
f=function(c,a,i){var d,e=0,f=b.global;if(!i)if(c.length){d=c[e++];try{i=b.scopeMap[d]&&b.scopeMap[d][1]}catch(h){}i=i||(d in f?f[d]:a?f[d]={}:void 0)}else return f;for(;i&&(d=c[e++]);)i=d in i?i[d]:a?i[d]={}:void 0;return i},j=Object.prototype.toString,h=function(c,a,b){return(b||[]).concat(Array.prototype.slice.call(c,a||0))},k=/\{([^\}]+)\}/g,l={_extraNames:a,_mixin:function(c,b,i){var f,h,j,l={};for(f in b)if(h=b[f],!(f in c)||c[f]!==h&&(!(f in l)||l[f]!==h))c[f]=i?i(h):h;if(d("bug-for-in-skips-shadowed")&&
b)for(j=0;j<e;++j)if(f=a[j],h=b[f],!(f in c)||c[f]!==h&&(!(f in l)||l[f]!==h))c[f]=i?i(h):h;return c},mixin:function(c,a){c||(c={});for(var b=1,d=arguments.length;b<d;b++)l._mixin(c,arguments[b]);return c},setObject:function(c,a,b){var d=c.split("."),c=d.pop();return(b=f(d,!0,b))&&c?b[c]=a:void 0},getObject:function(c,a,b){return f(c.split("."),a,b)},exists:function(c,a){return void 0!==l.getObject(c,!1,a)},isString:function(c){return"string"==typeof c||c instanceof String},isArray:function(c){return c&&
(c instanceof Array||"array"==typeof c)},isFunction:function(c){return"[object Function]"===j.call(c)},isObject:function(c){return void 0!==c&&(null===c||"object"==typeof c||l.isArray(c)||l.isFunction(c))},isArrayLike:function(c){return c&&void 0!==c&&!l.isString(c)&&!l.isFunction(c)&&!(c.tagName&&"form"==c.tagName.toLowerCase())&&(l.isArray(c)||isFinite(c.length))},isAlien:function(c){return c&&!l.isFunction(c)&&/\{\s*\[native code\]\s*\}/.test(""+c)},extend:function(c,a){for(var b=1,d=arguments.length;b<
d;b++)l._mixin(c.prototype,arguments[b]);return c},_hitchArgs:function(c,a){var d=l._toArray(arguments,2),f=l.isString(a);return function(){var e=l._toArray(arguments),h=f?(c||b.global)[a]:a;return h&&h.apply(c||this,d.concat(e))}},hitch:function(c,a){if(2<arguments.length)return l._hitchArgs.apply(b,arguments);a||(a=c,c=null);if(l.isString(a)){c=c||b.global;if(!c[a])throw['lang.hitch: scope["',a,'"] is null (scope="',c,'")'].join("");return function(){return c[a].apply(c,arguments||[])}}return!c?
a:function(){return a.apply(c,arguments||[])}},delegate:function(){function c(){}return function(a,b){c.prototype=a;var d=new c;c.prototype=null;b&&l._mixin(d,b);return d}}(),_toArray:d("ie")?function(){function c(c,a,b){b=b||[];for(a=a||0;a<c.length;a++)b.push(c[a]);return b}return function(a){return(a.item?c:h).apply(this,arguments)}}():h,partial:function(c){return l.hitch.apply(b,[null].concat(l._toArray(arguments)))},clone:function(c){if(!c||"object"!=typeof c||l.isFunction(c))return c;if(c.nodeType&&
"cloneNode"in c)return c.cloneNode(!0);if(c instanceof Date)return new Date(c.getTime());if(c instanceof RegExp)return RegExp(c);var a,b,d;if(l.isArray(c)){a=[];for(b=0,d=c.length;b<d;++b)b in c&&a.push(l.clone(c[b]))}else a=c.constructor?new c.constructor:{};return l._mixin(a,c,l.clone)},trim:String.prototype.trim?function(c){return c.trim()}:function(c){return c.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(c,a,b){return c.replace(b||k,l.isFunction(a)?a:function(c,b){return l.getObject(b,
!1,a)})}};l.mixin(b,l);return l})},"dojo/domReady":function(){define(["./has"],function(){function b(c){j?c(a):h.push(c)}var d=this,a=document,e={loaded:1,complete:1},f="string"!=typeof a.readyState,j=!!e[a.readyState];if(f)a.readyState="loading";if(!j){var h=[],k=[],l=function(c){c=c||d.event;if(!(j||"readystatechange"==c.type&&!e[a.readyState])){j=1;if(f)a.readyState="complete";for(;h.length;)h.shift()(a)}},c=function(c,a){c.addEventListener(a,l,!1);h.push(function(){c.removeEventListener(a,l,!1)})};
c(a,"DOMContentLoaded");c(d,"load");"onreadystatechange"in a?c(a,"readystatechange"):f||k.push(function(){return e[a.readyState]});if(k.length){var g=function(){if(!j){for(var c=k.length;c--;)if(k[c]()){l("poller");return}setTimeout(g,30)}};g()}}b.load=function(c,a,d){b(d)};return b})},"frozen/box2d/Box":function(){define(["dcl","dcl/bases/Mixer","dojo/_base/lang"],function(b,d){var a=Box2D.Common.Math.b2Vec2,e=Box2D.Dynamics.b2BodyDef,f=Box2D.Dynamics.b2Body,j=Box2D.Dynamics.b2FixtureDef,h=Box2D.Dynamics.b2World,
k=Box2D.Collision.Shapes.b2PolygonShape,l=Box2D.Collision.Shapes.b2CircleShape;return b(d,{intervalRate:60,adaptive:!1,bodiesMap:null,fixturesMap:null,jointsMap:null,b2World:null,gravityX:0,gravityY:9.8,allowSleep:!0,resolveCollisions:!1,contactListener:null,collisions:null,scale:30,constructor:function(c){if(c&&c.intervalRate)this.intervalRate=parseInt(c.intervalRate,10);this.bodiesMap={};this.fixturesMap={};this.jointsMap={};this.b2World=new h(new a(this.gravityX,this.gravityY),this.allowSleep);
this.resolveCollisions&&this.addContactListener(this.contactListener||this)},update:function(c){if(this.resolveCollisions)this.collisions={};var a=Date.now();c?this.b2World.Step(c/1E3,10,10):this.b2World.Step(this.adaptive?(a-this.lastTimestamp)/1E3:1/this.intervalRate,10,10);this.b2World.ClearForces();return Date.now()-a},getState:function(){for(var c={},a=this.b2World.GetBodyList();a;a=a.m_next)if(a.IsActive()&&"undefined"!==typeof a.GetUserData()&&null!==a.GetUserData()&&(c[a.GetUserData()]={x:a.GetPosition().x,
y:a.GetPosition().y,angle:a.GetAngle(),center:{x:a.GetWorldCenter().x,y:a.GetWorldCenter().y},linearVelocity:a.m_linearVelocity,angularVelocity:a.m_angularVelocity},this.resolveCollisions))c[a.GetUserData()].collisions=this.collisions[a.GetUserData()]||null;return c},updateExternalState:function(c){var a=this.getState(),b;for(b in a){var d=c[b];d&&!d.staticBody&&d.update(a[b])}},setBodies:function(c){for(var a in c)this.addBody(c[a]);this.ready=!0},addBody:function(c){if(!c.alreadyScaled)c.scaleShape(1/
this.scale),c.scale=this.scale;var b=new e,d=new j,h,o,p,r;d.restitution=c.restitution;d.density=c.density;d.friction=c.friction;if(c.hasOwnProperty("maskBits"))d.filter.maskBits=c.maskBits;if(c.hasOwnProperty("categoryBits"))d.filter.categoryBits=c.categoryBits;if(c.hasOwnProperty("groupIndex"))d.filter.groupIndex=c.groupIndex;b.type=c.staticBody?f.b2_staticBody:f.b2_dynamicBody;b.position.x=c.x;b.position.y=c.y;b.userData=c.id;b.angle=c.angle;b.linearDamping=c.linearDamping;b.angularDamping=c.angularDamping;
var n=this.b2World.CreateBody(b);if(c.radius)d.shape=new l(c.radius),n.CreateFixture(d);else if(c.points){o=[];for(b=0;b<c.points.length;b++)p=new a,p.Set(c.points[b].x,c.points[b].y),o[b]=p;d.shape=new k;d.shape.SetAsArray(o,o.length);n.CreateFixture(d)}else if(c.polys)for(h=0;h<c.polys.length;h++){o=c.polys[h];r=[];for(b=0;b<o.length;b++)p=new a,p.Set(o[b].x,o[b].y),r[b]=p;d.shape=new k;d.shape.SetAsArray(r,r.length);n.CreateFixture(d)}else d.shape=new k,d.shape.SetAsBox(c.halfWidth,c.halfHeight),
n.CreateFixture(d);this.bodiesMap[c.id]=n},setPosition:function(c,b,d){this.bodiesMap[c].SetPosition(new a(b,d))},setAngle:function(c,a){this.bodiesMap[c].SetAngle(a)},setLinearVelocity:function(c,b,d){this.bodiesMap[c].SetLinearVelocity(new a(b,d))},applyImpulseDegrees:function(c,b,d){c=this.bodiesMap[c];c.ApplyImpulse(new a(Math.sin(b*(Math.PI/180))*d,-1*Math.cos(b*(Math.PI/180))*d),c.GetWorldCenter())},applyForceDegrees:function(c,b,d){c=this.bodiesMap[c];c.ApplyForce(new a(Math.sin(b*(Math.PI/
180))*d,-1*Math.cos(b*(Math.PI/180))*d),c.GetWorldCenter())},applyImpulse:function(c,b,d){c=this.bodiesMap[c];c.ApplyImpulse(new a(Math.sin(b)*d,-1*Math.cos(b)*d),c.GetWorldCenter())},applyForce:function(c,b,d){c=this.bodiesMap[c];c.ApplyForce(new a(Math.sin(b)*d,-1*Math.cos(b)*d),c.GetWorldCenter())},applyTorque:function(c,a){this.bodiesMap[c].ApplyTorque(a)},setGravity:function(c){this.b2World.SetGravity(new a(c.x,c.y))},removeBody:function(c){this.bodiesMap[c]&&(this.fixturesMap[c]&&this.bodiesMap[c].DestroyFixture(this.fixturesMap[c]),
this.b2World.DestroyBody(this.bodiesMap[c]),delete this.bodiesMap[c])},wakeUpBody:function(c){this.bodiesMap[c]&&this.bodiesMap[c].SetAwake(!0)},addContactListener:function(c){var a=new Box2D.Dynamics.b2ContactListener;if(c.beginContact)a.BeginContact=function(a){c.beginContact(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData())};if(c.EndContact)a.endContact=function(a){c.endContact(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData())};if(c.postSolve)a.PostSolve=
function(a,b){c.postSolve(a.GetFixtureA().GetBody().GetUserData(),a.GetFixtureB().GetBody().GetUserData(),b.normalImpulses[0])};this.b2World.SetContactListener(a)},destroyJoint:function(c){this.jointsMap[c]&&(this.b2World.DestroyJoint(this.jointsMap[c]),delete this.jointsMap[c])},addJoint:function(c){if(c&&c.id&&!this.jointsMap[c.id]){var a=c.createB2Joint(this);a&&(this.jointsMap[c.id]=a)}},beginContact:function(){},endContact:function(){},postSolve:function(c,a,b){this.collisions[c]=this.collisions[c]||
[];this.collisions[c].push({id:a,impulse:b});this.collisions[a]=this.collisions[a]||[];this.collisions[a].push({id:c,impulse:b})}})})},"dcl/dcl":function(){(function(b){"undefined"!=typeof define?define(["./mini"],b):"undefined"!=typeof module?module.exports=b(require("./mini")):dcl=b(dcl)})(function(b){function d(){}function a(a,b,f){var e=a||d,c=b||d,g=f||d,i=function(){var a;e.apply(this,arguments);try{a=g.apply(this,arguments)}catch(b){a=b}c.call(this,arguments,a);if(a instanceof Error)throw a;
return a};i.advices={b:a,a:b,f:f};return i}function e(a){return function(d,f){var e=d._m,c;e&&((c=+e.w[f]||0)&&c!=a&&b._e("set chaining",f,d,a,c),e.w[f]=a)}}var f=b(b.Super,{constructor:function(){this.b=this.f.before;this.a=this.f.after;this.f=this.f.around}});b.mix(b,{Advice:f,advise:function(a){return new f(a)},before:function(a){return new f({before:a})},after:function(a){return new f({after:a})},around:b.superCall,chainBefore:e(1),chainAfter:e(2),isInstanceOf:function(a,b){if(a instanceof b)return!0;
var d=a.constructor._m,f;if(d)for(d=d.b,f=d.length-1;0<=f;--f)if(d[f]===b)return!0;return!1},_sb:function(d,f,e,l){var l=l[e]=b._ec(f,e,"f"),c=b._ec(f,e,"b").reverse(),f=b._ec(f,e,"a"),l=d?b._st(l,1==d?function(a){return b._sc(a.reverse())}:b._sc,e):b._ss(l,e);return!c.length&&!f.length?l||function(){}:a(b._sc(c),b._sc(f),l)}});return b})},"dcl/mini":function(){(function(b){"undefined"!=typeof define?define([],b):"undefined"!=typeof module?module.exports=b():dcl=b()})(function(){function b(c,d){var g=
[0],i,h,m,k,t,s,q,D,z=0,w;if(c)if(c instanceof Array){k={};q=c.slice(0).reverse();for(D=q.length-1;0<=D;--D)if(h=q[D],h._u=h._u||e++,i=h._m){for(s=i.b,z=s.length-1;0<z;--z)w=s[z]._u,k[w]=(k[w]||0)+1;q[D]=s.slice(0)}else q[D]=[h];t={};a:for(;q.length;){for(D=0;D<q.length;++D)if(s=q[D],h=s[0],w=h._u,!k[w]){t[w]||(g.push(h),t[w]=1);s.shift();s.length?--k[s[0]._u]:q.splice(D,1);continue a}b._e("cycle",d,q)}c=c[0];z=g.length-((k=c._m)&&c===g[g.length-(z=k.b.length)]?z:1)-1}else c._u=c._u||e++,g=g.concat((k=
c._m)?k.b:c);i=c?b.delegate(c[j]):{};for(s=c&&(k=c._m)?b.delegate(k.w):{constructor:2};0<z;--z)if(h=g[z],k=h._m,l(i,k&&k.h||h[j]),k)for(w in q=k.w)s[w]=(+s[w]||0)|q[w];for(w in d)a(k=d[w])?s[w]=+s[w]||0:i[w]=k;t={b:g,h:d,w:s,c:{}};g[0]={_m:t,prototype:i};h=i;k=t.w;s=t.b;q=t.c;for(m in k)h[m]=b._sb(k[m],s,m,q);m=i[f];m._m=t;m[j]=i;g[0]=m;return b._p(m)}function d(a){this.f=a}function a(a){return a instanceof d}var e=0,f="constructor",j="prototype",h=function(){},k={},l,c,g,i,m;(l=function(a,c){for(var b in c)a[b]=
c[b]})(b,{mix:l,delegate:function(a){h[j]=a;a=new h;h[j]=null;return a},Super:d,superCall:function(a){return new d(a)},_p:function(a){return a},_e:function(a){throw Error("dcl: "+a);},_f:function(a,c){var b=a.f(c);b.ctr=a.ctr;return b},_ec:c=function(c,b,d){for(var g=c.length-1,f=[],i,e,h="f"==d;i=c[g];--g)if((e=i._m)?(e=e.h).hasOwnProperty(b)&&(a(e=e[b])?h?e.f:e=e[d]:h):h&&(e=i[j][b])&&e!==k[b])e.ctr=i,f.push(e);return f},_sc:i=function(a){var c=a.length,b;return!c?0:1==c?(b=a[0],function(){b.apply(this,
arguments)}):function(){for(var b=0;b<c;++b)a[b].apply(this,arguments)}},_ss:g=function(c,d){for(var g=0,e,i=k[d];e=c[g];++g)i=a(e)?c[g]=b._f(e,i,d):e;return d!=f?i:function(){i.apply(this,arguments)}},_st:m=function(c,d,g){for(var e=0,i,h,j=0;i=c[e];++e)a(i)&&(h=e-j,c[e]=b._f(i,!h?0:1==h?c[j]:d(c.slice(j,e)),g),j=e);h=e-j;return!h?0:1==h&&g!=f?c[j]:d(j?c.slice(j):c)},_sb:function(a,b,d,e){b=e[d]=c(b,d,"f");return(a?m(b,i,d):g(b,d))||function(){}}});return b})},"dcl/bases/Mixer":function(){(function(b){"undefined"!=
typeof define?define(["../mini"],b):"undefined"!=typeof module?module.exports=b(require("../mini")):dclBasesMixer=b(dcl)})(function(b){return b(null,{declaredClass:"dcl/bases/Mixer",constructor:function(d){b.mix(this,d)}})})},"game/StateManager":function(){define(["dcl","dcl/bases/Mixer"],function(b,d){return b(d,{})})},"game/handleInput":function(){define("./state,./createBodies,./createJSON/main,./utils/insideCanvas,dojo/dom,frozen/utils".split(","),function(b,d,a,e,f,j){var h=f.byId("xdisp"),k=
f.byId("ydisp"),l;return function(c){if(c.mouseAction.position)h.innerHTML=c.mouseAction.position.x,k.innerHTML=c.mouseAction.position.y;if(c.mouseAction.isPressed()&&e(c.mouseAction.startPosition,this)&&!l)l=c.mouseAction.startPosition,b.geometries.push(l);if(!c.mouseAction.isPressed()&&c.mouseAction.endPosition&&l){l=c.mouseAction.endPosition;if(!("polygon"===b.tool&&10!==b.geometries.length&&(1>=b.geometries.length||4<j.distance(b.geometries[0],l))))b.geometries.push(l),b.jsonObjs.push(a[b.tool](b.geometries)),
d(),b.geometries=[],c.mouseAction.endPosition=null;l=null}}})},"game/createBodies":function(){define("./state,./Entities,./ui/getGravity,./ui/displayJSON,./ui/toggleUndo,lodash,dojo/dom-class,frozen/box2d/Box".split(","),function(b,d,a,e,f,j,h,k){var l=0;return function(){var c=!1,g=a();b.game.box=new k({gravityX:g.x,gravityY:g.y});b.game.entities={};(g=j.chain(b.jsonObjs).map(function(a){a=parseInt(a.id,10);return"undefined"===typeof a||null===a||isNaN(a)?-1:a}).max().value())&&(l=g+1);j.forEach(b.jsonObjs,
function(a){if(!a.staticBody&&!a.zone)a.color=a.color||"rgba(0,255,0,0.4)";if(a.zone)a.color=a.color||"rgba(255,0,0,0.2)";if("undefined"===typeof a.id||null===a.id)a.id=l,l++;if(b.game.entities[a.id])c=!0;else{var g=new d[a.type](a);b.game.entities[a.id]=g;a.zone||b.game.box.addBody(g)}});c?h.remove("duplicate-ids","hide"):h.add("duplicate-ids","hide");e(b.jsonObjs);f()}})},"game/Entities":function(){define(["frozen/box2d/RectangleEntity","frozen/box2d/PolygonEntity","frozen/box2d/CircleEntity"],
function(b,d,a){return{Rectangle:b,Polygon:d,Circle:a}})},"frozen/box2d/RectangleEntity":function(){define(["dcl","dcl/bases/Mixer","./Entity"],function(b,d,a){return b([d,a],{halfWidth:1,halfHeight:1,draw:b.superCall(function(a){return function(b,d){var d=d||this.scale||1,h=b.lineWidth;b.lineWidth=this.lineWidth;b.save();b.translate(this.x*d,this.y*d);b.rotate(this.angle);b.translate(-this.x*d,-this.y*d);b.fillStyle=this.color;b.strokeStyle=this.strokeColor;b.fillRect((this.x-this.halfWidth)*d,(this.y-
this.halfHeight)*d,2*this.halfWidth*d,2*this.halfHeight*d);b.strokeRect((this.x-this.halfWidth)*d,(this.y-this.halfHeight)*d,2*this.halfWidth*d,2*this.halfHeight*d);b.restore();b.lineWidth=h;a.apply(this,[b,d])}}),scaleShape:b.superCall(function(a){return function(b){this.halfHeight*=b;this.halfWidth*=b;a.apply(this,[b])}}),pointInShape:function(a){return a.x>=this.x-this.halfWidth&&a.x<=this.x+this.halfWidth&&a.y>=this.y-this.halfHeight&&a.y<=this.y+this.halfHeight}})})},"frozen/box2d/Entity":function(){define(["dcl",
"dcl/bases/Mixer","dojo/_base/lang"],function(b,d,a){return b(d,{id:0,x:0,y:0,scale:null,angle:0,center:null,restitution:0.3,density:1,friction:0.9,linearDamping:0,linearVelocity:null,angularVelocity:0,angularDamping:0,staticBody:!1,color:"rgba(128,128,128,0.5)",strokeColor:"#000",lineWidth:1,hidden:!1,maskBits:null,categoryBits:null,groupIndex:null,update:function(b){a.mixin(this,b)},draw:function(a,b){var b=b||this.scale||1,d=a.lineWidth;a.lineWidth=this.lineWidth;a.fillStyle=this.strokeColor;a.beginPath();
a.arc(this.x*b,this.y*b,4,0,2*Math.PI,!0);a.closePath();a.fill();if(this.center)a.fillStyle="yellow",a.beginPath(),a.arc(this.center.x*b,this.center.y*b,2,0,2*Math.PI,!0),a.closePath(),a.fill();a.lineWidth=d},scaleShape:function(a){this.x*=a;this.y*=a;this.alreadyScaled=!0}})})},"frozen/box2d/PolygonEntity":function(){define("dcl,dcl/bases/Mixer,./Entity,../utils/scalePoints,../utils/pointInPolygon,../utils/translatePoints".split(","),function(b,d,a,e,f,j){return b([d,a],{points:[],draw:b.superCall(function(a){return function(b,
d){var d=d||this.scale||1,c=b.lineWidth;b.lineWidth=this.lineWidth;b.save();b.translate(this.x*d,this.y*d);b.rotate(this.angle);b.translate(-this.x*d,-this.y*d);b.fillStyle=this.color;b.strokeStyle=this.strokeColor;b.beginPath();b.moveTo((this.x+this.points[0].x)*d,(this.y+this.points[0].y)*d);for(var g=1;g<this.points.length;g++)b.lineTo((this.points[g].x+this.x)*d,(this.points[g].y+this.y)*d);b.lineTo((this.x+this.points[0].x)*d,(this.y+this.points[0].y)*d);b.closePath();b.fill();b.stroke();b.restore();
b.lineWidth=c;a.apply(this,[b,d])}}),scaleShape:b.superCall(function(a){return function(b){this.points=e(this.points,b);a.apply(this,[b])}}),pointInShape:function(a){return f(a,j(this.points,this))}})})},"frozen/utils/scalePoints":function(){define(["dojo/_base/lang"],function(b){var d=function(a,e){if(b.isArray(a)){var f=[];a.forEach(function(a){f.push(d(a,e))});a=f}else a="object"===typeof e?{x:a.x*e.x,y:a.y*e.y}:{x:a.x*e,y:a.y*e};return a};return d})},"frozen/utils/pointInPolygon":function(){define(function(){return function(b,
d){if(!b||!d)return!1;for(var a=d.points||d,e=!1,f=a.length-1,j=0;j<a.length;f=j++){var h=a[j].x,k=a[j].y,l=a[f].x,f=a[f].y;k>b.y!==f>b.y&&b.x<(l-h)*(b.y-k)/(f-k)+h&&(e=!e)}return e}})},"frozen/utils/translatePoints":function(){define(["dojo/_base/lang"],function(b){var d=function(a,e){if(b.isArray(a)){var f=[];a.forEach(function(a){f.push(d(a,e))});a=f}else a={x:a.x,y:a.y},e.hasOwnProperty("x")&&(a.x+=e.x),e.hasOwnProperty("y")&&(a.y+=e.y);return a};return d})},"frozen/box2d/CircleEntity":function(){define(["dcl",
"dcl/bases/Mixer","./Entity","../utils/distance"],function(b,d,a,e){return b([d,a],{radius:1,draw:b.superCall(function(a){return function(b,d){var d=d||this.scale||1,e=b.lineWidth;b.lineWidth=this.lineWidth;b.fillStyle=this.color;b.strokeStyle=this.strokeColor;b.beginPath();b.arc(this.x*d,this.y*d,this.radius*d,0,2*Math.PI,!0);b.closePath();b.fill();b.stroke();this.staticBody||(b.save(),b.translate(this.x*d,this.y*d),b.rotate(this.angle),b.translate(-this.x*d,-this.y*d),b.beginPath(),b.moveTo(this.x*
d,this.y*d),b.lineTo(this.x*d,this.y*d-this.radius*d),b.closePath(),b.stroke(),b.restore());b.lineWidth=e;a.apply(this,[b,d])}}),scaleShape:b.superCall(function(a){return function(b){this.radius*=b;a.apply(this,[b])}}),pointInShape:function(a){return e(a,this)<=this.radius}})})},"frozen/utils/distance":function(){define(function(){return function(b,d){return Math.sqrt((d.x-b.x)*(d.x-b.x)+(d.y-b.y)*(d.y-b.y))}})},"game/ui/displayJSON":function(){define(["../state","dojo/dom"],function(b){return function(d){b.codeMirror.setValue(JSON.stringify({objs:d,
canvas:{height:b.game?b.game.height:null,width:b.game?b.game.width:null},backImg:b.backImg?b.backImg.src:null},null,"  "))}})},"game/ui/toggleUndo":function(){define(["../state","dojo/dom"],function(b,d){var a=d.byId("undoBtn");return function(){a.disabled=b.jsonObjs.length?!1:!0}})},"lodash/lodash":function(){(function(b,d){function a(c){if(c&&c.__wrapped__)return c;if(!(this instanceof a))return new a(c);this.__wrapped__=c}function e(a,c,b){c||(c=0);var d=a.length,g=d-c>=(b||Va);if(g)for(var e=
{},b=c-1;++b<d;){var i=a[b]+"";(E.call(e,i)?e[i]:e[i]=[]).push(a[b])}return function(b){if(g){var d=b+"";return E.call(e,d)&&-1<H(e[d],b)}return-1<H(a,b,c)}}function f(a){return a.charCodeAt(0)}function j(a,c){var b=a.index,g=c.index,a=a.criteria,c=c.criteria;if(a!==c){if(a>c||a===d)return 1;if(a<c||c===d)return-1}return b<g?-1:1}function h(a,c,b){function d(){var h=arguments,j=e?this:c;g||(a=c[f]);b.length&&(h=h.length?b.concat(B.call(h)):b);return this instanceof d?(i.prototype=a.prototype,j=new i,
h=a.apply(j,h),s(h)?h:j):a.apply(j,h)}var g=t(a),e=!b,f=c;e&&(b=c);g||(c=a);return d}function k(a,c){return!a?N:"function"!=typeof a?function(c){return c[a]}:c!==d?function(b,d,g){return a.call(c,b,d,g)}:a}function l(){for(var a={arrayLoop:"",bottom:"",hasDontEnumBug:Ta,isKeysFast:kb,objectLoop:"",noArgsEnum:bb,noCharByIndex:cb,shadowed:Pa,top:"",useHas:!0},c,b=0;c=arguments[b];b++)for(var d in c)a[d]=c[d];c=a.args;a.firstArg=/^[^,]+/.exec(c)[0];return Function("createCallback, hasOwnProperty, isArguments, isString, objectTypes, nativeKeys, propertyIsEnumerable",
"return function("+c+") {\n"+eb(a)+"\n}")(k,E,o,q,fb,Q,da)}function c(a){return"\\"+nb[a]}function g(a){return gb[a]}function i(){}function m(a){return ob[a]}function o(a){return y.call(a)==ya}function p(a){var c=!1;if(!(a&&"object"==typeof a)||o(a))return c;var b=a.constructor;if((!db||!("function"!=typeof a.toString&&"string"==typeof(a+"")))&&(!t(b)||b instanceof b)){if(ab)return Ba(a,function(a,b,d){c=!E.call(d,b);return!1}),!1===c;Ba(a,function(a,b){c=b});return!1===c||E.call(a,c)}return c}function r(a){var c=
[];ia(a,function(a,b){c.push(b)});return c}function n(a,c,b,d,g){if(null==a)return a;b&&(c=!1);if(b=s(a)){var e=y.call(a);if(!R[e]||Ja&&o(a))return a;var i=e==na,b=i||(e==ha?Ra(a):b)}if(!b||!c)return b?i?B.call(a):Ya({},a):a;b=a.constructor;switch(e){case ta:case ga:return new b(+a);case pa:case Ca:return new b(a);case Aa:return b(a.source,Oa.exec(a))}d||(d=[]);g||(g=[]);for(e=d.length;e--;)if(d[e]==a)return g[e];var f=i?b(a.length):{};d.push(a);g.push(f);(i?x:ia)(a,function(a,b){f[b]=n(a,c,null,
d,g)});return f}function u(a){var c=[];Ba(a,function(a,b){t(a)&&c.push(b)});return c.sort()}function K(a){var c={};ia(a,function(a,b){c[a]=b});return c}function L(a,c,b,d){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;var g=y.call(a);if(g!=y.call(c))return!1;switch(g){case ta:case ga:return+a==+c;case pa:return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case Aa:case Ca:return a==c+""}var e=g==na||g==ya;if(Ja&&!e&&(e=o(a))&&!o(c))return!1;if(!e){if(a.__wrapped__||c.__wrapped__)return L(a.__wrapped__||
a,c.__wrapped__||c);if(g!=ha||db&&("function"!=typeof a.toString&&"string"==typeof(a+"")||"function"!=typeof c.toString&&"string"==typeof(c+"")))return!1;var g=a.constructor,i=c.constructor;if(g!=i&&(!t(g)||!(g instanceof g&&t(i)&&i instanceof i)))return!1}b||(b=[]);d||(d=[]);for(g=b.length;g--;)if(b[g]==a)return d[g]==c;var g=-1,i=!0,f=0;b.push(a);d.push(c);if(e){f=a.length;if(i=f==c.length)for(;f--&&(i=L(a[f],c[f],b,d)););return i}for(var h in a)if(E.call(a,h)&&(f++,!E.call(c,h)||!L(a[h],c[h],b,
d)))return!1;for(h in c)if(E.call(c,h)&&!f--)return!1;if(Ta)for(;7>++g;)if(h=Pa[g],E.call(a,h)&&(!E.call(c,h)||!L(a[h],c[h],b,d)))return!1;return!0}function t(a){return"function"==typeof a}function s(a){return a?fb[typeof a]:!1}function q(a){return y.call(a)==Ca}function D(a,c,b){var d=arguments,g=0,e=2,i=d[3],f=d[4];if(b!==oa&&(i=[],f=[],"number"!=typeof b))e=d.length;for(;++g<e;)ia(d[g],function(c,b){var d,g,e;if(c&&((g=U(c))||Ra(c))){for(var h=i.length;h--&&!(d=i[h]==c););d?a[b]=f[h]:(i.push(c),
f.push(e=(e=a[b],g)?U(e)?e:[]:Ra(e)?e:{}),a[b]=D(e,c,oa,i,f))}else null!=c&&(a[b]=c)});return a}function z(a){var c=[];ia(a,function(a){c.push(a)});return c}function w(a,c,b){var d=-1,g=a?a.length:0,e=!1,b=(0>b?xa(0,g+b):b)||0;"number"==typeof g?e=-1<(q(a)?a.indexOf(c,b):H(a,c,b)):x(a,function(a){if(++d>=b)return!(e=a===c)});return e}function V(a,c,b){var d=!0,c=k(c,b);if(U(a))for(var b=-1,g=a.length;++b<g&&(d=!!c(a[b],b,a)););else x(a,function(a,b,g){return d=!!c(a,b,g)});return d}function G(a,c,
b){var d=[],c=k(c,b);if(U(a))for(var b=-1,g=a.length;++b<g;){var e=a[b];c(e,b,a)&&d.push(e)}else x(a,function(a,b,g){c(a,b,g)&&d.push(a)});return d}function qa(a,c,b){var d,c=k(c,b);x(a,function(a,b,g){if(c(a,b,g))return d=a,!1});return d}function ka(a,c,b){var d=-1,g=a?a.length:0,e=Array("number"==typeof g?g:0),c=k(c,b);if(U(a))for(;++d<g;)e[d]=c(a[d],d,a);else x(a,function(a,b,g){e[++d]=c(a,b,g)});return e}function $(a,c,b){var d=-Infinity,g=-1,e=a?a.length:0,i=d;if(c||!U(a))c=!c&&q(a)?f:k(c,b),
x(a,function(a,b,g){b=c(a,b,g);b>d&&(d=b,i=a)});else for(;++g<e;)a[g]>i&&(i=a[g]);return i}function W(a,c){var b=[];x(a,function(a){b.push(a[c])});return b}function O(a,c,b,d){var g=3>arguments.length,c=k(c,d);x(a,function(a,d,e){b=g?(g=!1,a):c(b,a,d,e)});return b}function A(a,c,b,d){var g=a,e=a?a.length:0,i=3>arguments.length;if("number"!=typeof e)var f=Sa(a),e=f.length;else cb&&q(a)&&(g=a.split(""));x(a,function(a,h,mb){h=f?f[--e]:--e;b=i?(i=!1,g[h]):c.call(d,b,g[h],h,mb)});return b}function X(a,
c,b){var d,c=k(c,b);if(U(a))for(var b=-1,g=a.length;++b<g&&!(d=c(a[b],b,a)););else x(a,function(a,b,g){return!(d=c(a,b,g))});return!!d}function M(a,c,b){if(a)return null==c||b?a[0]:B.call(a,0,c)}function Y(a,c){for(var b=-1,d=a?a.length:0,g=[];++b<d;){var e=a[b];U(e)?ma.apply(g,c?e:Y(e)):g.push(e)}return g}function H(a,c,b){var d=-1,g=a?a.length:0;if("number"==typeof b)d=(0>b?xa(0,g+b):b||0)-1;else if(b)return d=ba(a,c),a[d]===c?d:-1;for(;++d<g;)if(a[d]===c)return d;return-1}function aa(a,c,b){return a?
B.call(a,null==c||b?1:c):[]}function ba(a,c,b,d){for(var g=0,e=a?a.length:g,b=b?k(b,d):N,c=b(c);g<e;)d=g+e>>>1,b(a[d])<c?g=d+1:e=d;return g}function ca(a,c,b,d){var g=-1,e=a?a.length:0,i=[],f=i;"function"==typeof c&&(d=b,b=c,c=!1);var h=!c&&74<e;if(h)var j={};b&&(f=[],b=k(b,d));for(;++g<e;){var d=a[g],m=b?b(d,g,a):d;h&&(f=E.call(j,m+"")?j[m]:j[m]=[]);if(c?!g||f[f.length-1]!==m:0>H(f,m))(b||h)&&f.push(m),i.push(d)}return i}function la(a,c){return jb||S&&2<arguments.length?S.call.apply(S,arguments):
h(a,c,B.call(arguments,2))}function N(a){return a}function F(c){x(u(c),function(b){var d=a[b]=c[b];a.prototype[b]=function(){var c=[this.__wrapped__];ma.apply(c,arguments);c=d.apply(a,c);if(this.__chain__)c=new a(c),c.__chain__=!0;return c}})}function ja(b,d,g){b||(b="");g||(g={});var e,i,f=a.templateSettings,h=0,j=g.interpolate||f.interpolate||P,m="__p += '",v=g.variable||f.variable,l=v;b.replace(RegExp((g.escape||f.escape||P).source+"|"+j.source+"|"+(j===Ea?Ia:P).source+"|"+(g.evaluate||f.evaluate||
P).source+"|$","g"),function(a,d,g,i,f,j){g||(g=i);m+=b.slice(h,j).replace(Xa,c);m+=d?"' +\n__e("+d+") +\n'":f?"';\n"+f+";\n__p += '":g?"' +\n((__t = ("+g+")) == null ? '' : __t) +\n'":"";e||(e=f||La.test(d||g));h=j+a.length});m+="';\n";l||(v="obj",m=e?"with ("+v+") {\n"+m+"\n}\n":m.replace(Z,"$&"+v+".").replace(RegExp("(\\(\\s*)"+v+"\\."+v+"\\b","g"),"$1__d"));m=(e?m.replace(Ma,""):m).replace(ra,"$1").replace(Na,"$1;");m="function("+v+") {\n"+(l?"":v+" || ("+v+" = {});\n")+"var __t, __p = '', __e = _.escape"+
(e?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(l?"":", __d = "+v+"."+v+" || "+v)+";\n")+m+"return __p\n}";g=lb?"\n//@ sourceURL="+(g.sourceURL||"/lodash/template/source["+ua++ +"]"):"";try{i=Function("_","return "+m+g)(a)}catch(o){throw o.source=m,o;}if(d)return i(d);i.source=m;return i}var J="object"==typeof exports&&exports,I="object"==typeof global&&global;I.global===I&&(b=I);var C=[],v=new function(){},Ua=0,oa=v,Va=30,Da=b._,La=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,
sa=/&(?:amp|lt|gt|quot|#x27);/g,Ma=/\b__p \+= '';/g,ra=/\b(__p \+=) '' \+/g,Na=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oa=/\w*$/,Z=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,ea=RegExp("^"+(v.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ia=/\$\{((?:(?=\\?)\\?[\s\S])*?)}/g,Ea=/<%=([\s\S]+?)%>/g,P=/($^)/,Wa=/[&<>"']/g,Xa=/['\n\r\t\u2028\u2029\\]/g,Pa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ua=
0,Fa=Math.ceil,fa=C.concat,Qa=Math.floor,T=ea.test(T=Object.getPrototypeOf)&&T,E=v.hasOwnProperty,ma=C.push,da=v.propertyIsEnumerable,B=C.slice,y=v.toString,S=ea.test(S=B.bind)&&S,va=ea.test(va=Array.isArray)&&va,wa=b.isFinite,Ga=b.isNaN,Q=ea.test(Q=Object.keys)&&Q,xa=Math.max,Ka=Math.min,za=Math.random,ya="[object Arguments]",na="[object Array]",ta="[object Boolean]",ga="[object Date]",pa="[object Number]",ha="[object Object]",Aa="[object RegExp]",Ca="[object String]",Ta,ab,Ha=(Ha={"0":1,length:1},
C.splice.call(Ha,0,1),Ha[0]),bb=!0;(function(){function a(){this.x=1}var c=[];a.prototype={valueOf:1,y:1};for(var b in new a)c.push(b);for(b in arguments)bb=!b;Ta=!/valueOf/.test(c);ab="x"!=c[0]})(1);var Ja=!o(arguments),ib="x"!=B.call("x")[0],cb="xx"!="x"[0]+Object("x")[0];try{var db=y.call(b.document||0)==ha}catch(qb){}var jb=S&&/\n|Opera/.test(S+y.call(b.opera)),kb=Q&&/^.+$|true/.test(Q+!!b.attachEvent);try{var lb=(Function("//@")(),!b.attachEvent)}catch(rb){}var R={};R[ya]=R["[object Function]"]=
!1;R[na]=R[ta]=R[ga]=R[pa]=R[ha]=R[Aa]=R[Ca]=!0;var fb={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},nb={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};a.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Ea,variable:""};var eb=ja("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (isString(iteratee)) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),
Za={args:"object, source, guard",top:"for (var argsIndex = 1, argsLength = typeof guard == 'number' ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if ((iteratee = arguments[argsIndex])) {",objectLoop:"result[index] = value",bottom:"  }\n}"},$a={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},
hb={arrayLoop:null},Ya=l(Za);Ja&&(o=function(a){return a?E.call(a,"callee"):!1});var Ba=l($a,hb,{useHas:!1}),ia=l($a,hb),gb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},ob=K(gb),pb=l(Za,{objectLoop:"if (result[index] == null) "+Za.objectLoop}),U=va||function(a){return y.call(a)==na};t(/x/)&&(t=function(a){return"[object Function]"==y.call(a)});var Ra=!T?p:function(a){if(!(a&&"object"==typeof a))return!1;var c=a.valueOf,b="function"==typeof c&&(b=T(c))&&T(b);return b?a==b||T(a)==b&&
!o(a):p(a)},Sa=!Q?r:function(a){return"function"==typeof a&&da.call(a,"prototype")?r(a):s(a)?Q(a):[]},x=l($a);a.VERSION="0.10.0";a.assign=Ya;a.after=function(a,c){return 1>a?c():function(){if(1>--a)return c.apply(this,arguments)}};a.bind=la;a.bindAll=function(a){for(var c=arguments,b=1<c.length?0:(c=u(a),-1),d=c.length;++b<d;){var g=c[b];a[g]=la(a[g],a)}return a};a.bindKey=function(a,c){return h(a,c,B.call(arguments,2))};a.chain=function(c){c=new a(c);c.__chain__=!0;return c};a.clone=n;a.compact=
function(a){for(var c=-1,b=a?a.length:0,d=[];++c<b;){var g=a[c];g&&d.push(g)}return d};a.compose=function(){var a=arguments;return function(){for(var c=arguments,b=a.length;b--;)c=[a[b].apply(this,c)];return c[0]}};a.contains=w;a.countBy=function(a,c,b){var d={},c=k(c,b);x(a,function(a,b,g){b=c(a,b,g);E.call(d,b)?d[b]++:d[b]=1});return d};a.debounce=function(a,c,b){function d(){f=null;b||(e=a.apply(i,g))}var g,e,i,f;return function(){var h=b&&!f;g=arguments;i=this;clearTimeout(f);f=setTimeout(d,c);
h&&(e=a.apply(i,g));return e}};a.defaults=pb;a.defer=function(a){var c=B.call(arguments,1);return setTimeout(function(){a.apply(d,c)},1)};a.delay=function(a,c){var b=B.call(arguments,2);return setTimeout(function(){a.apply(d,b)},c)};a.difference=function(a){for(var c=-1,b=a?a.length:0,d=fa.apply(C,arguments),d=e(d,b),g=[];++c<b;){var i=a[c];d(i)||g.push(i)}return g};a.escape=function(a){return null==a?"":(a+"").replace(Wa,g)};a.every=V;a.filter=G;a.find=qa;a.first=M;a.flatten=Y;a.forEach=x;a.forIn=
Ba;a.forOwn=ia;a.functions=u;a.groupBy=function(a,c,b){var d={},c=k(c,b);x(a,function(a,b,g){b=c(a,b,g);(E.call(d,b)?d[b]:d[b]=[]).push(a)});return d};a.has=function(a,c){return a?E.call(a,c):!1};a.identity=N;a.indexOf=H;a.initial=function(a,c,b){return a?B.call(a,0,-(null==c||b?1:c)):[]};a.intersection=function(a){var c=arguments,b=c.length,d={},g=[];x(a,function(a){if(0>H(g,a)){for(var i=b;--i;)if(!(d[i]||(d[i]=e(c[i])))(a))return;g.push(a)}});return g};a.invert=K;a.invoke=function(a,c){var b=B.call(arguments,
2),d="function"==typeof c,g=[];x(a,function(a){g.push((d?c:a[c]).apply(a,b))});return g};a.isArguments=o;a.isArray=U;a.isBoolean=function(a){return!0===a||!1===a||y.call(a)==ta};a.isDate=function(a){return y.call(a)==ga};a.isElement=function(a){return a?1===a.nodeType:!1};a.isEmpty=function(a){var c=!0;if(!a)return c;var b=y.call(a),d=a.length;if(b==na||b==Ca||b==ya||Ja&&o(a)||b==ha&&"number"==typeof d&&t(a.splice))return!d;ia(a,function(){return c=!1});return c};a.isEqual=L;a.isFinite=function(a){return wa(a)&&
!Ga(parseFloat(a))};a.isFunction=t;a.isNaN=function(a){return y.call(a)==pa&&a!=+a};a.isNull=function(a){return null===a};a.isNumber=function(a){return y.call(a)==pa};a.isObject=s;a.isPlainObject=Ra;a.isRegExp=function(a){return y.call(a)==Aa};a.isString=q;a.isUndefined=function(a){return a===d};a.keys=Sa;a.last=function(a,c,b){if(a){var d=a.length;return null==c||b?a[d-1]:B.call(a,-c||d)}};a.lastIndexOf=function(a,c,b){var d=a?a.length:0;for("number"==typeof b&&(d=(0>b?xa(0,d+b):Ka(b,d-1))+1);d--;)if(a[d]===
c)return d;return-1};a.map=ka;a.max=$;a.memoize=function(a,c){var b={};return function(){var d=c?c.apply(this,arguments):arguments[0];return E.call(b,d)?b[d]:b[d]=a.apply(this,arguments)}};a.merge=D;a.min=function(a,c,b){var d=Infinity,g=-1,e=a?a.length:0,i=d;if(c||!U(a))c=!c&&q(a)?f:k(c,b),x(a,function(a,b,g){b=c(a,b,g);b<d&&(d=b,i=a)});else for(;++g<e;)a[g]<i&&(i=a[g]);return i};a.mixin=F;a.noConflict=function(){b._=Da;return this};a.object=function(a,c){for(var b=-1,d=a?a.length:0,g={};++b<d;){var e=
a[b];c?g[e]=c[b]:g[e[0]]=e[1]}return g};a.omit=function(a,c,b){var d="function"==typeof c,g={};if(d)c=k(c,b);else var e=fa.apply(C,arguments);Ba(a,function(a,b,i){if(d?!c(a,b,i):0>H(e,b,1))g[b]=a});return g};a.once=function(a){var c,b=!1;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};a.pairs=function(a){var c=[];ia(a,function(a,b){c.push([b,a])});return c};a.partial=function(a){return h(a,B.call(arguments,1))};a.pick=function(a,c,b){var d={};if("function"!=typeof c)for(var g=
0,e=fa.apply(C,arguments),i=e.length;++g<i;){var f=e[g];f in a&&(d[f]=a[f])}else c=k(c,b),Ba(a,function(a,b,g){c(a,b,g)&&(d[b]=a)});return d};a.pluck=W;a.random=function(a,c){null==a&&null==c&&(c=1);a=+a||0;null==c&&(c=a,a=0);return a+Qa(za()*((+c||0)-a+1))};a.range=function(a,c,b){a=+a||0;b=+b||1;null==c&&(c=a,a=0);for(var d=-1,c=xa(0,Fa((c-a)/b)),g=Array(c);++d<c;)g[d]=a,a+=b;return g};a.reduce=O;a.reduceRight=A;a.reject=function(a,c,b){c=k(c,b);return G(a,function(a,b,d){return!c(a,b,d)})};a.rest=
aa;a.result=function(a,c){var b=a?a[c]:null;return t(b)?a[c]():b};a.shuffle=function(a){var c=-1,b=Array(a?a.length:0);x(a,function(a){var d=Qa(za()*(++c+1));b[c]=b[d];b[d]=a});return b};a.size=function(a){var c=a?a.length:0;return"number"==typeof c?c:Sa(a).length};a.some=X;a.sortBy=function(a,c,b){var d=[],c=k(c,b);x(a,function(a,b,g){d.push({criteria:c(a,b,g),index:b,value:a})});a=d.length;for(d.sort(j);a--;)d[a]=d[a].value;return d};a.sortedIndex=ba;a.tap=function(a,c){c(a);return a};a.template=
ja;a.throttle=function(a,c){function b(){f=new Date;i=null;g=a.apply(e,d)}var d,g,e,i,f=0;return function(){var h=new Date,m=c-(h-f);d=arguments;e=this;0>=m?(clearTimeout(i),f=h,g=a.apply(e,d)):i||(i=setTimeout(b,m));return g}};a.times=function(a,c,b){for(var a=+a||0,d=-1,g=Array(a);++d<a;)g[d]=c.call(b,d);return g};a.toArray=function(a){return a&&"number"==typeof a.length?(ib?q(a):"string"==typeof a)?a.split(""):B.call(a):z(a)};a.unescape=function(a){return null==a?"":(a+"").replace(sa,m)};a.union=
function(){return ca(fa.apply(C,arguments))};a.uniq=ca;a.uniqueId=function(a){var c=Ua++;return a?a+c:c};a.values=z;a.where=function(a,c){var b=Sa(c);return G(a,function(a){for(var d=b.length;d--;){var g=a[b[d]]===c[b[d]];if(!g)break}return!!g})};a.without=function(a){for(var c=-1,b=a?a.length:0,d=e(arguments,1,20),g=[];++c<b;){var i=a[c];d(i)||g.push(i)}return g};a.wrap=function(a,c){return function(){var b=[a];ma.apply(b,arguments);return c.apply(this,b)}};a.zip=function(a){for(var c=-1,b=a?$(W(arguments,
"length")):0,d=Array(b);++c<b;)d[c]=W(arguments,c);return d};a.all=V;a.any=X;a.collect=ka;a.detect=qa;a.drop=aa;a.each=x;a.extend=Ya;a.foldl=O;a.foldr=A;a.head=M;a.include=w;a.inject=O;a.methods=u;a.select=G;a.tail=aa;a.take=M;a.unique=ca;a._iteratorTemplate=eb;F(a);a.prototype.chain=function(){this.__chain__=!0;return this};a.prototype.value=function(){return this.__wrapped__};x("pop,push,reverse,shift,sort,splice,unshift".split(","),function(c){var b=C[c];a.prototype[c]=function(){var c=this.__wrapped__;
b.apply(c,arguments);Ha&&0===c.length&&delete c[0];if(this.__chain__)c=new a(c),c.__chain__=!0;return c}});x(["concat","join","slice"],function(c){var b=C[c];a.prototype[c]=function(){var c=b.apply(this.__wrapped__,arguments);if(this.__chain__)c=new a(c),c.__chain__=!0;return c}});"function"==typeof define&&"object"==typeof define.amd&&define.amd?(b._=a,define(function(){return a})):J?"object"==typeof module&&module&&module.exports==J?(module.exports=a)._=a:J._=a:b._=a})(this)},"dojo/dom-class":function(){define(["./_base/lang",
"./_base/array","./dom"],function(b,d,a){function e(a){if("string"==typeof a||a instanceof String){if(a&&!j.test(a))return h[0]=a,h;a=a.split(j);a.length&&!a[0]&&a.shift();a.length&&!a[a.length-1]&&a.pop();return a}return!a?[]:d.filter(a,function(a){return a})}var f,j=/\s+/,h=[""],k={};return f={contains:function(b,c){return 0<=(" "+a.byId(b).className+" ").indexOf(" "+c+" ")},add:function(b,c){var b=a.byId(b),c=e(c),d=b.className,i,d=d?" "+d+" ":" ";i=d.length;for(var f=0,h=c.length,j;f<h;++f)(j=
c[f])&&0>d.indexOf(" "+j+" ")&&(d+=j+" ");i<d.length&&(b.className=d.substr(1,d.length-2))},remove:function(d,c){var d=a.byId(d),g;if(void 0!==c){c=e(c);g=" "+d.className+" ";for(var i=0,f=c.length;i<f;++i)g=g.replace(" "+c[i]+" "," ");g=b.trim(g)}else g="";d.className!=g&&(d.className=g)},replace:function(b,c,d){b=a.byId(b);k.className=b.className;f.remove(k,d);f.add(k,c);b.className!==k.className&&(b.className=k.className)},toggle:function(b,c,d){b=a.byId(b);if(void 0===d)for(var c=e(c),i=0,h=c.length,
j;i<h;++i)j=c[i],f[f.contains(b,j)?"remove":"add"](b,j);else f[d?"add":"remove"](b,c);return d}}})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(b,d,a){function e(a){return h[a]=new Function("item","index","array",a)}function f(a){var b=!a;return function(d,f,j){var k=0,l=d&&d.length||0,n;l&&"string"==typeof d&&(d=d.split(""));"string"==typeof f&&(f=h[f]||e(f));if(j)for(;k<l;++k){if(n=!f.call(j,d[k],k,d),a^n)return!n}else for(;k<l;++k)if(n=!f(d[k],k,d),a^n)return!n;
return b}}function j(a){var b=1,d=0,e=0;a||(b=d=e=-1);return function(f,h,j,n){if(n&&0<b)return l.lastIndexOf(f,h,j);var n=f&&f.length||0,u=a?n+e:d;j===k?j=a?d:n+e:0>j?(j=n+j,0>j&&(j=d)):j=j>=n?n+e:j;for(n&&"string"==typeof f&&(f=f.split(""));j!=u;j+=b)if(f[j]==h)return j;return-1}}var h={},k,l={every:f(!1),some:f(!0),indexOf:j(!0),lastIndexOf:j(!1),forEach:function(a,b,d){var f=0,j=a&&a.length||0;j&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=h[b]||e(b));if(d)for(;f<j;++f)b.call(d,
a[f],f,a);else for(;f<j;++f)b(a[f],f,a)},map:function(a,b,d,f){var j=0,k=a&&a.length||0,f=new (f||Array)(k);k&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=h[b]||e(b));if(d)for(;j<k;++j)f[j]=b.call(d,a[j],j,a);else for(;j<k;++j)f[j]=b(a[j],j,a);return f},filter:function(a,b,d){var f=0,j=a&&a.length||0,k=[],l;j&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=h[b]||e(b));if(d)for(;f<j;++f)l=a[f],b.call(d,l,f,a)&&k.push(l);else for(;f<j;++f)l=a[f],b(l,f,a)&&k.push(l);return k},
clearCache:function(){h={}}};a.mixin(b,l);return l})},"game/createJSON/main":function(){define(["./poly","./circle","./rect"],function(b,d,a){return{polygon:b,circle:d,rectangle:a}})},"game/createJSON/poly":function(){define(["../state","../utils/convexHull","frozen/utils"],function(b,d,a){return function(e){if(e&&2<e.length){var e={points:d(e)},f=a.averagePoints(e.points);e.x=f.x;e.y=f.y;e.points=a.translatePoints(e.points,{x:-e.x,y:-e.y});e.staticBody="static"===b.toolType;e.zone="zone"===b.toolType;
e.type="Polygon";return e}}})},"game/utils/convexHull":function(){define(function(){return function(b){var d,a,e,f,j=[],h=function(a,b){var d;j.push(a);var e=[];d=0;var f=null,k=[],l;for(l in b){var n=b[l],u=(a[0].y-a[1].y)*(n.x-a[0].x)+(a[1].x-a[0].x)*(n.y-a[0].y);0<u&&(k.push(n),u>d&&(d=u,f=n))}return(d=f)?(e=e.concat(h([a[0],d],k)),e=e.concat(h([d,a[1]],k))):[a]},k;for(k in b){var l=b[k];if(l.x>d||!d)e=l,d=l.x;if(l.x<a||!a)f=l,a=l.x}b=[].concat(h([f,e],b),h([e,f],b));d=[];for(a=0;a<b.length;a++)d.push(b[a][0]);
d.reverse();return d}})},"frozen/utils":function(){define("./utils/averagePoints,./utils/degreesToRadians,./utils/radiansToDegrees,./utils/pointInPolygon,./utils/distance,./utils/degreesFromCenter,./utils/radiansFromCenter,./utils/scalePoints,./utils/translatePoints,./utils/insideCanvas".split(","),function(b,d,a,e,f,j,h,k,l,c){return{averagePoints:b,degreesToRadians:d,radiansToDegrees:a,pointInPolygon:e,distance:f,degreesFromCenter:j,radiansFromCenter:h,scalePoints:k,translatePoints:l,insideCanvas:c}})},
"frozen/utils/averagePoints":function(){define(function(){return function(b){var d={x:0,y:0};b.forEach(function(a){d.x+=a.x;d.y+=a.y});d.x/=b.length;d.y/=b.length;return d}})},"frozen/utils/degreesToRadians":function(){define(function(){var b=Math.PI/180;return function(d){return d*b}})},"frozen/utils/radiansToDegrees":function(){define(function(){var b=180/Math.PI;return function(d){return d*b}})},"frozen/utils/degreesFromCenter":function(){define(["./radiansToDegrees","./radiansFromCenter"],function(b,
d){return function(a,e){return b(d(a,e))}})},"frozen/utils/radiansFromCenter":function(){define(function(){var b={x:0,y:0};return function(d,a){d=d||b;return d.x===a.x&&d.y===a.y?0:d.x===a.x?d.y>a.y?0:Math.PI:d.y===a.y?d.x>a.x?1.5*Math.PI:Math.PI/2:d.x<a.x&&d.y>a.y?Math.atan((a.x-d.x)/(d.y-a.y)):d.x<a.x&&d.y<a.y?Math.PI/2+Math.atan((a.y-d.y)/(a.x-d.x)):d.x>a.x&&d.y<a.y?Math.PI+Math.atan((d.x-a.x)/(a.y-d.y)):1.5*Math.PI+Math.atan((d.y-a.y)/(d.x-a.x))}})},"frozen/utils/insideCanvas":function(){define(function(){return function(b,
d){return 0>b.x||b.x>d.width||0>b.y||b.y>d.height?!1:!0}})},"game/createJSON/circle":function(){define(["../state","frozen/utils"],function(b,d){return function(a){if(a&&2===a.length){var e=d.distance(a[0],a[1]),a={x:a[0].x,y:a[0].y,radius:e};a.staticBody="static"===b.toolType;a.zone="zone"===b.toolType;a.type="Circle";return a}}})},"game/createJSON/rect":function(){define(["../state","../utils/orderRectPts"],function(b,d){return function(a){if(a&&2===a.length)return a=d(a),a={x:(a[1].x-a[0].x)/2+
a[0].x,y:(a[1].y-a[0].y)/2+a[0].y,halfWidth:Math.abs((a[1].x-a[0].x)/2)||0.5,halfHeight:Math.abs((a[1].y-a[0].y)/2)||0.5},a.staticBody="static"===b.toolType,a.zone="zone"===b.toolType,a.type="Rectangle",a}})},"game/utils/orderRectPts":function(){define(function(){return function(b){var d=[],a;b[1].x<b[0].x?(a=b[1],b=b[0]):(a=b[0],b=b[1]);d.push(a);d.push(b);return d}})},"game/utils/insideCanvas":function(){define(function(){return function(b,d){return 0>b.x||b.x>d.width||0>b.y||b.y>d.height?!1:!0}})},
"game/draw":function(){define(["./draw/shape","./state","lodash"],function(b,d,a){return function(e){d.backImg?e.drawImage(d.backImg,0,0,this.canvas.width,d.backImg.height):e.clearRect(0,0,this.canvas.width,this.canvas.height);a.forEach(this.entities,function(a){(!a.staticBody||d.showStatic)&&a.draw(e)},this);if(d.geometries.length)b[d.tool](e,this.inputManager,d.geometries)}})},"game/draw/shape":function(){define(["./poly","./circle","./rect"],function(b,d,a){return{polygon:b,circle:d,rectangle:a}})},
"game/draw/poly":function(){define(["lodash","frozen/utils"],function(b,d){return function(a,e,f){a.fillStyle="white";a.strokeStyle="black";b.forEach(f,function(b){a.beginPath();a.arc(b.x,b.y,4,0,2*Math.PI,!0);a.closePath();a.fill();a.stroke()});if(1<f.length&&e.mouseAction.position&&4>=d.distance(f[0],e.mouseAction.position))a.strokeStyle="yellow",a.fillStyle="black",a.lineWidth=4,a.beginPath(),a.arc(f[0].x,f[0].y,4,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke(),a.lineWidth=1;a.strokeStyle="red";
a.beginPath();b.forEach(f,function(b,d){0<d&&(a.moveTo(f[d-1].x,f[d-1].y),a.lineTo(b.x,b.y))});e.mouseAction.position&&(a.moveTo(f[f.length-1].x,f[f.length-1].y),a.lineTo(e.mouseAction.position.x,e.mouseAction.position.y));a.stroke();a.closePath()}})},"game/draw/circle":function(){define(["frozen/utils"],function(b){return function(d,a,e){a=b.distance(e[0],a.mouseAction.position);d.strokeStyle="red";d.beginPath();d.arc(e[0].x,e[0].y,a,0,2*Math.PI,!0);d.closePath();d.stroke()}})},"game/draw/rect":function(){define(["../utils/orderRectPts"],
function(b){return function(d,a,e){a=b([e[0],a.mouseAction.position]);d.strokeStyle="red";d.strokeRect(a[0].x,a[0].y,a[1].x-a[0].x,a[1].y-a[0].y)}})},"frozen/box2d/BoxGame":function(){define(["../GameCore","./Box","dcl","dcl/bases/Mixer"],function(b,d,a,e){return a([b,e],{box:null,boxUpdating:!0,entities:null,constructor:function(){if(!this.box)this.box=new d;if(!this.entities)this.entities={}},preUpdate:function(a){this.boxUpdating&&(this.box.update(a),this.box.updateExternalState(this.entities))}})})},
"frozen/GameCore":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/dom,./InputManager,./ResourceManager,./shims/RAF".split(","),function(b,d,a,e,f,j){return b(d,{statics:{FONT_SIZE:24},isRunning:!1,canvasId:null,maxStep:40,contextType:"2d",height:0,width:0,resourceManager:null,inputManager:null,loadingForeground:"#00F",loadingBackground:"#FFF",gameAreaId:null,canvasPercentage:0,setHeight:function(a){this.height=a;this.canvas.height=a},setWidth:function(a){this.width=a;this.canvas.width=
a},stop:function(){this.isRunning=!1},run:function(){this.isRunning||(this.init(),this.loadResources(this.resourceManager),this.initInput(this.inputManager),this.launchLoop())},loadResources:function(){},init:function(){if(!this.canvas)this.canvas=e.byId(this.canvasId);if(this.canvas){if(!this.context)this.context=this.canvas.getContext(this.contextType);if(this.context){this.setHeight(this.height||this.canvas.height);this.setWidth(this.width||this.canvas.width);if(!this.inputManager)this.inputManager=
this.gameAreaId&&this.canvasPercentage?new f({canvas:this.canvas,gameArea:e.byId(this.gameAreaId),canvasPercentage:this.canvasPercentage}):new f({canvas:this.canvas});this.inputManager.resize();if(!this.resourceManager)this.resourceManager=new j;this.loadResources(this.resourceManager);this.isRunning=!0}else alert("Sorry, your browser does not support a "+this.contextType+" drawing surface on canvas.  I recommend any browser but Internet Explorer")}else alert("Sorry, your browser does not support canvas.  I recommend any browser but Internet Explorer")},
initInput:function(){},handleInput:function(){},gameLoop:function(){this.currTime=(new Date).getTime();this.elapsedTime=Math.min(this.currTime-this.prevTime,this.maxStep);this.prevTime=this.currTime;this.resourceManager&&!this.resourceManager.resourcesReady()?(this.updateLoadingScreen(this.elapsedTime),this.drawLoadingScreen(this.context)):(this.handleInput(this.inputManager,this.elapsedTime),this.paused||(this.preUpdate(this.elapsedTime),this.update(this.elapsedTime)),this.context.save(),this.draw(this.context),
this.context.restore())},launchLoop:function(){this.elapsedTime=0;var b=Date.now();this.prevTime=this.currTime=b;this.loopRunner=a.hitch(this,this.loopRunner);window.requestAnimationFrame(this.loopRunner)},loopRunner:function(){this.gameLoop();window.requestAnimationFrame(this.loopRunner)},preUpdate:function(){},update:function(){},updateLoadingScreen:function(){},draw:function(a){if("2d"===this.contextType)a.font="14px sans-serif",a.fillText("This game does not have its own draw function!",10,50)},
drawLoadingScreen:function(a){if(this.resourceManager&&"2d"===this.contextType)a.fillStyle=this.loadingBackground,a.fillRect(0,0,this.width,this.height),a.fillStyle=this.loadingForeground,a.strokeStyle=this.loadingForeground,a.font="bold "+Math.floor(this.height/12)+"px sans-serif",a.fillText("Loading... "+this.resourceManager.getPercentComplete()+"%",0.1*this.width,0.55*this.height),a.strokeRect(0.1*this.width,0.7*this.height,0.8*this.width,0.1*this.height),a.fillRect(0.1*this.width,0.7*this.height,
0.8*this.width*this.resourceManager.getPercentComplete()/100,0.1*this.height),a.lineWidth=4}})})},"frozen/InputManager":function(){define("./GameAction,./MouseAction,./utils/insideCanvas,dcl,dcl/bases/Mixer,dojo/has,dojo/on,dojo/dom-style,dojo/dom-geometry,dojo/_base/lang,dojo/domReady!".split(","),function(b,d,a,e,f,j,h,k,l,c){return e(f,{keyActions:[],mouseAction:null,touchAction:null,canvas:null,handleMouse:!0,handleTouch:!0,handleKeys:!0,gameArea:null,canvasPercentage:null,constructor:function(){this.handleKeys&&
(h(document,"keydown",c.hitch(this,"keyDown")),h(document,"keyup",c.hitch(this,"keyReleased")));this.handleMouse&&!j("touch")&&(h(document,"mousedown",c.hitch(this,"mouseDown")),h(document,"mousemove",c.hitch(this,"mouseMove")),h(document,"mouseup",c.hitch(this,"mouseUp")));this.handleTouch&&j("touch")&&(h(document,"touchstart",c.hitch(this,"touchStart")),h(document,"touchmove",c.hitch(this,"touchMove")),h(document,"touchend",c.hitch(this,"touchEnd")));if(!this.mouseAction)this.mouseAction=new d;
if(!this.touchAction)this.touchAction=new d;this.gameArea&&this.canvasPercentage&&(h(window,"resize",c.hitch(this,"resize")),h(window,"orientationchange",c.hitch(this,"resize")))},mapToKey:function(a,c){if(!this.keyActions)this.keyActions=[];this.keyActions[c]=a},addKeyAction:function(a,c){var d=new b;if(c)d.behavior=d.statics.DETECT_INITAL_PRESS_ONLY;this.mapToKey(d,a);return d},setMouseAction:function(a){this.mouseAction=a},setTouchAction:function(a){this.touchAction=a},mouseUp:function(a){this.mouseAction.release();
this.mouseAction.endPosition=this.getMouseLoc(a)},mouseDown:function(c){c=this.getMouseLoc(c);this.mouseAction.endPosition=null;this.mouseAction.insideCanvas=a(c,this.canvas);this.mouseAction.insideCanvas?(this.mouseAction.press(),this.mouseAction.startPosition=c,this.mouseAction.position=c):this.mouseAction.startPosition=null},mouseMove:function(a){this.mouseAction.position=this.getMouseLoc(a)},touchStart:function(c){c=this.getMouseLoc(c.changedTouches[0]);this.touchAction.endPosition=null;this.touchAction.insideCanvas=
a(c,this.canvas);this.touchAction.insideCanvas?(this.touchAction.press(),this.touchAction.startPosition=c,this.touchAction.position=c):this.touchAction.startPosition=null},touchEnd:function(a){this.touchAction.release();this.touchAction.endPosition=this.getMouseLoc(a.changedTouches[0])},touchMove:function(a){this.touchAction.position=this.getMouseLoc(a.changedTouches[0]);this.touchAction.startPosition&&a.preventDefault()},getKeyAction:function(a){return this.keyActions.length?this.keyActions[a.keyCode]||
this.keyActions[String.fromCharCode(a.keyCode)]:null},keyPressed:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyDown:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyReleased:function(a){(a=this.getKeyAction(a))&&a.release()},getMouseLoc:function(a){var c=l.position(this.canvas);return this.zoomRatio?{x:Math.round((a.clientX-c.x)/this.zoomRatio),y:Math.round((a.clientY-c.y)/this.zoomRatio)}:{x:Math.round(a.clientX-c.x),y:Math.round(a.clientY-c.y)}},resize:function(){if(this.gameArea&&
this.canvasPercentage&&this.canvas){var a=this.canvas.width,c=this.canvas.height,b=l.getMarginExtents(document.body),d=window.innerWidth-b.w,b=window.innerHeight-b.h,c=a/c,e="",f="";d/b>c?(d=b*c,e=d+"px"):f=Math.round(d/c)+"px";this.zoomRatio=d/a*this.canvasPercentage;k.set(this.gameArea,{width:e,height:f});a=Math.floor(100*this.canvasPercentage)+"%";k.set(this.canvas,{width:a,height:a,display:"block",marginLeft:"auto",marginRight:"auto"})}}})})},"frozen/GameAction":function(){define(["dcl","dcl/bases/Mixer"],
function(b,d){return b(d,{name:null,behavior:0,amount:0,state:0,statics:{NORMAL:0,DETECT_INITAL_PRESS_ONLY:1,STATE_RELEASED:0,STATE_PRESSED:1,STATE_WAITING_FOR_RELEASE:2,STATE_MOVED:3},constructor:function(){this.reset()},getName:function(){return this.name},reset:function(){this.state=this.statics.STATE_RELEASED;this.amount=0},tap:function(){this.press();this.release()},press:function(){this.state=this.statics.STATE_PRESSED;this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY&&this.pressAmt(1)},
pressAmt:function(a){if(this.state!==this.statics.STATE_WAITING_FOR_RELEASE)this.amount+=a,this.state=this.statics.STATE_WAITING_FOR_RELEASE},release:function(){this.state=this.statics.STATE_RELEASED},isPressed:function(){return this.state===this.statics.STATE_PRESSED?!0:!1},getAmount:function(){var a=this.amount;if(0!==a)if(this.state===this.statics.STATE_RELEASED)this.amount=0;else if(this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY)this.state=this.statics.STATE_WAITING_FOR_RELEASE,this.amount=
0;return a}})})},"frozen/MouseAction":function(){define(["dcl","dcl/bases/Mixer","./GameAction"],function(b,d,a){return b([d,a],{startPosition:null,endPosition:null,position:null})})},"dojo/on":function(){define(["require","./_base/kernel","./has"],function(b,d,a){function e(c,b,d,e,f){if(e=b.match(/(.*):(.*)/))return b=e[2],e=e[1],h.selector(e,b).call(f,c,d);a("touch")&&(k.test(b)&&(d=r(d)),!a("event-orientationchange")&&"orientationchange"==b&&(b="resize",c=window,d=r(d)));m&&(d=m(d));if(c.addEventListener){var i=
b in g,j=i?g[b]:b;c.addEventListener(j,d,i);return{remove:function(){c.removeEventListener(j,d,i)}}}b="on"+b;throw Error("Target must be an event emitter");}function f(){this.cancelable=!1}function j(){this.bubbles=!1}b=window.ScriptEngineMajorVersion;a.add("jscript",b&&b()+ScriptEngineMinorVersion()/10);a.add("event-orientationchange",a("touch")&&!a("android"));a.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);var h=
function(a,c,b,d){return"function"==typeof a.on&&"function"!=typeof c?a.on(c,b):h.parse(a,c,b,e,d,this)};h.pausable=function(a,c,b,d){var e,a=h(a,c,function(){if(!e)return b.apply(this,arguments)},d);a.pause=function(){e=!0};a.resume=function(){e=!1};return a};h.once=function(a,c,b){var d=h(a,c,function(){d.remove();return b.apply(this,arguments)});return d};h.parse=function(a,c,b,d,e,g){if(c.call)return c.call(g,a,b);if(-1<c.indexOf(",")){for(var c=c.split(/\s*,\s*/),f=[],i=0,h;h=c[i++];)f.push(d(a,
h,b,e,g));f.remove=function(){for(var a=0;a<f.length;a++)f[a].remove()};return f}return d(a,c,b,e,g)};var k=/^touch/;h.selector=function(a,c,b){return function(e,g){function f(c){for(i=i&&i.matches?i:d.query;!i.matches(c,a,e);)if(c==e||!1===b||!(c=c.parentNode)||1!=c.nodeType)return;return c}var i="function"==typeof a?{matches:a}:this,j=c.bubble;return j?h(e,j(f),g):h(e,c,function(a){var c=f(a.target);return c&&g.call(c,a)})}};var l=[].slice,c=h.emit=function(a,c,b){var d=l.call(arguments,2),e="on"+
c;if("parentNode"in a){var g=d[0]={},i;for(i in b)g[i]=b[i];g.preventDefault=f;g.stopPropagation=j;g.target=a;g.type=c;b=g}do a[e]&&a[e].apply(a,d);while(b&&b.bubbles&&(a=a.parentNode));return b&&b.cancelable&&b},g={};if(!a("event-stopimmediatepropagation"))var i=function(){this.modified=this.immediatelyStopped=!0},m=function(a){return function(c){if(!c.immediatelyStopped)return c.stopImmediatePropagation=i,a.apply(this,arguments)}};g={focusin:"focus",focusout:"blur"};h.emit=function(a,b,d){if(a.dispatchEvent&&
document.createEvent){var e=a.ownerDocument.createEvent("HTMLEvents");e.initEvent(b,!!d.bubbles,!!d.cancelable);for(var g in d)g in e||(e[g]=d[g]);return a.dispatchEvent(e)&&e}return c.apply(h,arguments)};if(a("touch"))var o=function(){},p=window.orientation,r=function(a){return function(c){var b=c.corrected;if(!b){var d=c.type;try{delete c.type}catch(e){}c.type?(o.prototype=c,b=new o,b.preventDefault=function(){c.preventDefault()},b.stopPropagation=function(){c.stopPropagation()}):(b=c,b.type=d);
c.corrected=b;if("resize"==d){if(p==window.orientation)return null;p=window.orientation;b.type="orientationchange";return a.call(this,b)}if(!("rotation"in b))b.rotation=0,b.scale=1;var d=b.changedTouches[0],g;for(g in d)delete b[g],b[g]=d[g]}return a.call(this,b)}};return h})},"dojo/dom-style":function(){define("dojo/dom-style",["./sniff","./dom"],function(b,d){function a(a,d,e){d=d.toLowerCase();if(b("ie")){if("auto"==e){if("height"==d)return a.offsetHeight;if("width"==d)return a.offsetWidth}if("fontweight"==
d)switch(e){case 700:return"bold";default:return"normal"}}d in c||(c[d]=g.test(d));return c[d]?j(a,e):e}var e,f={};e=b("webkit")?function(a){var c;if(1==a.nodeType){var b=a.ownerDocument.defaultView;c=b.getComputedStyle(a,null);if(!c&&a.style)a.style.display="",c=b.getComputedStyle(a,null)}return c||{}}:b("ie")&&(9>b("ie")||b("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1==a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};f.getComputedStyle=
e;var j;j=b("ie")?function(a,c){if(!c)return 0;if("medium"==c)return 4;if(c.slice&&"px"==c.slice(-2))return parseFloat(c);var b=a.style,d=a.runtimeStyle,e=b.left,g=d.left;d.left=a.currentStyle.left;try{b.left=c,c=b.pixelLeft}catch(f){c=0}b.left=e;d.left=g;return c}:function(a,c){return parseFloat(c)||0};f.toPixelValue=j;var h=function(a,c){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(b){return c?{}:null}},k=9>b("ie")||10>b("ie")&&b("quirks")?function(a){try{return h(a).Opacity/
100}catch(c){return 1}}:function(a){return e(a).opacity},l=9>b("ie")||10>b("ie")&&b("quirks")?function(a,c){var b=100*c,d=1==c;a.style.zoom=d?"":1;if(h(a))h(a,1).Opacity=b;else{if(d)return c;a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")"}h(a,1).Enabled=!d;if("tr"==a.tagName.toLowerCase())for(b=a.firstChild;b;b=b.nextSibling)"td"==b.tagName.toLowerCase()&&l(b,c);return c}:function(a,c){return a.style.opacity=c},c={left:!0,top:!0},g=/margin|padding|width|height|max|min|offset/,
i=b("ie")?"styleFloat":"cssFloat",m={cssFloat:i,styleFloat:i,"float":i};f.get=function(c,b){var e=d.byId(c),g=arguments.length;if(2==g&&"opacity"==b)return k(e);var b=m[b]||b,i=f.getComputedStyle(e);return 1==g?i:a(e,b,i[b]||e.style[b])};f.set=function(a,c,b){var e=d.byId(a),g=arguments.length,i="opacity"==c,c=m[c]||c;if(3==g)return i?l(e,b):e.style[c]=b;for(var h in c)f.set(a,h,c[h]);return f.getComputedStyle(e)};return f})},"dojo/dom-geometry":function(){define("dojo/dom-geometry",["./sniff","./_base/window",
"./dom","./dom-style"],function(b,d,a,e){function f(a,b,d,e,f,h){h=h||"px";a=a.style;if(!isNaN(b))a.left=b+h;if(!isNaN(d))a.top=d+h;if(0<=e)a.width=e+h;if(0<=f)a.height=f+h}function j(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function h(a){return"border-box"==k.boxModel||"table"==a.tagName.toLowerCase()||j(a)}var k={boxModel:"content-box"};if(b("ie"))k.boxModel="BackCompat"==document.compatMode?"border-box":"content-box";
k.getPadExtents=function(c,b){var c=a.byId(c),d=b||e.getComputedStyle(c),f=e.toPixelValue,h=f(c,d.paddingLeft),j=f(c,d.paddingTop),k=f(c,d.paddingRight),d=f(c,d.paddingBottom);return{l:h,t:j,r:k,b:d,w:h+k,h:j+d}};k.getBorderExtents=function(c,b){var c=a.byId(c),d=e.toPixelValue,f=b||e.getComputedStyle(c),h="none"!=f.borderLeftStyle?d(c,f.borderLeftWidth):0,j="none"!=f.borderTopStyle?d(c,f.borderTopWidth):0,k="none"!=f.borderRightStyle?d(c,f.borderRightWidth):0,d="none"!=f.borderBottomStyle?d(c,f.borderBottomWidth):
0;return{l:h,t:j,r:k,b:d,w:h+k,h:j+d}};k.getPadBorderExtents=function(c,b){var c=a.byId(c),d=b||e.getComputedStyle(c),f=k.getPadExtents(c,d),d=k.getBorderExtents(c,d);return{l:f.l+d.l,t:f.t+d.t,r:f.r+d.r,b:f.b+d.b,w:f.w+d.w,h:f.h+d.h}};k.getMarginExtents=function(c,b){var c=a.byId(c),d=b||e.getComputedStyle(c),f=e.toPixelValue,h=f(c,d.marginLeft),j=f(c,d.marginTop),k=f(c,d.marginRight),d=f(c,d.marginBottom);return{l:h,t:j,r:k,b:d,w:h+k,h:j+d}};k.getMarginBox=function(c,d){var c=a.byId(c),f=d||e.getComputedStyle(c),
h=k.getMarginExtents(c,f),j=c.offsetLeft-h.l,l=c.offsetTop-h.t,r=c.parentNode,n=e.toPixelValue;if(b("mozilla")){var u=parseFloat(f.left),f=parseFloat(f.top);!isNaN(u)&&!isNaN(f)?(j=u,l=f):r&&r.style&&(r=e.getComputedStyle(r),"visible"!=r.overflow&&(j+="none"!=r.borderLeftStyle?n(c,r.borderLeftWidth):0,l+="none"!=r.borderTopStyle?n(c,r.borderTopWidth):0))}else if((b("opera")||8==b("ie")&&!b("quirks"))&&r)r=e.getComputedStyle(r),j-="none"!=r.borderLeftStyle?n(c,r.borderLeftWidth):0,l-="none"!=r.borderTopStyle?
n(c,r.borderTopWidth):0;return{l:j,t:l,w:c.offsetWidth+h.w,h:c.offsetHeight+h.h}};k.getContentBox=function(c,d){var c=a.byId(c),f=d||e.getComputedStyle(c),h=c.clientWidth,j=k.getPadExtents(c,f),l=k.getBorderExtents(c,f);h?(f=c.clientHeight,l.w=l.h=0):(h=c.offsetWidth,f=c.offsetHeight);b("opera")&&(j.l+=l.l,j.t+=l.t);return{l:j.l,t:j.t,w:h-j.w-l.w,h:f-j.h-l.h}};k.setContentSize=function(c,b,d){var c=a.byId(c),e=b.w,b=b.h;h(c)&&(d=k.getPadBorderExtents(c,d),0<=e&&(e+=d.w),0<=b&&(b+=d.h));f(c,NaN,NaN,
e,b)};var l={l:0,t:0,w:0,h:0};k.setMarginBox=function(c,d,i){var c=a.byId(c),m=i||e.getComputedStyle(c),i=d.w,o=d.h,p=h(c)?l:k.getPadBorderExtents(c,m),m=k.getMarginExtents(c,m);if(b("webkit")&&j(c)){var r=c.style;if(0<=i&&!r.width)r.width="4px";if(0<=o&&!r.height)r.height="4px"}0<=i&&(i=Math.max(i-p.w-m.w,0));0<=o&&(o=Math.max(o-p.h-m.h,0));f(c,d.l,d.t,i,o)};k.isBodyLtr=function(a){a=a||d.doc;return"ltr"==(d.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};k.docScroll=function(a){var a=
a||d.doc,e=d.doc.parentWindow||d.doc.defaultView;return"pageXOffset"in e?{x:e.pageXOffset,y:e.pageYOffset}:(e=b("quirks")?d.body(a):a.documentElement)&&{x:k.fixIeBiDiScrollLeft(e.scrollLeft||0,a),y:e.scrollTop||0}};if(b("ie"))k.getIeDocumentElementOffset=function(a){a=a||d.doc;a=a.documentElement;if(8>b("ie")){var e=a.getBoundingClientRect(),f=e.left,e=e.top;7>b("ie")&&(f+=a.clientLeft,e+=a.clientTop);return{x:0>f?0:f,y:0>e?0:e}}return{x:0,y:0}};k.fixIeBiDiScrollLeft=function(a,e){var e=e||d.doc,
f=b("ie");if(f&&!k.isBodyLtr(e)){var h=b("quirks"),j=h?d.body(e):e.documentElement,l=d.global;6==f&&!h&&l.frameElement&&j.scrollHeight>j.clientHeight&&(a+=j.clientLeft);return 8>f||h?a+j.clientWidth-j.scrollWidth:-a}return a};k.position=function(c,e){var c=a.byId(c),f=d.body(c.ownerDocument),h=c.getBoundingClientRect(),h={x:h.left,y:h.top,w:h.right-h.left,h:h.bottom-h.top};if(9>b("ie")){var j=k.getIeDocumentElementOffset(c.ownerDocument);h.x-=j.x+(b("quirks")?f.clientLeft+f.offsetLeft:0);h.y-=j.y+
(b("quirks")?f.clientTop+f.offsetTop:0)}e&&(f=k.docScroll(c.ownerDocument),h.x+=f.x,h.y+=f.y);return h};k.getMarginSize=function(c,b){var c=a.byId(c),d=k.getMarginExtents(c,b||e.getComputedStyle(c)),f=c.getBoundingClientRect();return{w:f.right-f.left+d.w,h:f.bottom-f.top+d.h}};k.normalizeEvent=function(a){if(!("layerX"in a))a.layerX=a.offsetX,a.layerY=a.offsetY};return k})},"frozen/ResourceManager":function(){define(["./sounds/Sound!","dcl","dcl/bases/Mixer","dojo/_base/lang","dojo/on"],function(b,
d,a,e,f){function j(a,b){var d=b;a&&(d=[a,b].join("/"));return d.replace(/\/{2,}/g,"/")}return d(a,{imageCount:0,loadedImages:0,allLoaded:!1,imageDir:null,soundDir:null,resourceList:{},loadImage:function(a){var b=!1;if(!Array.isArray(a))if("string"===typeof a)b=!0,a=[a];else if("object"!==typeof a)return;for(var d in a)if(a.hasOwnProperty(d)){var c=j(this.imageDir,a[d]);if(this.resourceList[c])a[d]=this.resourceList[c].img;else{this.allLoaded=!1;var g=new Image,i={name:c,img:g,complete:!1},m=e.partial(function(a){a.complete=
!0},i);f(g,"load",m);g.src=c;this.resourceList[c]=i;a[d]=g}}return b?a[0]:a},loadSound:function(a){var d=!1;if(!Array.isArray(a))if("string"===typeof a)d=!0,a=[a];else if("object"!==typeof a)return;for(var e in a)if(a.hasOwnProperty(e)){var c=j(this.soundDir,a[e]);if(this.resourceList[c])a[e]=this.resourceList[c];else{this.allLoaded=!1;var f=new b(c);this.resourceList[c]=f;a[e]=f}}return d?a[0]:a},playSound:function(a,b,d,c){a&&(b?a.loop(c):a.play(c,d||0))},resourcesReady:function(){if(!this.allLoaded){for(var a in this.resourceList)if(!this.resourceList[a].complete)return!1;
this.allLoaded=!0}return!0},getPercentComplete:function(){var a=0,b=0,d;for(d in this.resourceList){var c=this.resourceList[d];b++;c.complete&&(a+=1)}return 0===b?0:Math.round(100*(a/b))}})})},"frozen/sounds/Sound":function(){define(["require","dojo/has","../shims/AudioContext"],function(b,d){d.add("WebAudio",function(a){return!!a.AudioContext});return{load:function(a,e,f){b([d("WebAudio")?"./WebAudio":"./HTML5Audio"],function(a){f(a)})}}})},"frozen/shims/AudioContext":function(){define(function(){for(var b=
["ms","moz","webkit","o"],d=0;d<b.length&&!window.AudioContext;++d)window.AudioContext=window[b[d]+"AudioContext"]})},"frozen/shims/RAF":function(){define(function(){for(var b=0,d=["ms","moz","webkit","o"],a=0;a<d.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[d[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[a]+"CancelAnimationFrame"]||window[d[a]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame)window.requestAnimationFrame=function(a){var d=
(new Date).getTime(),j=Math.max(0,16-(d-b)),h=window.setTimeout(function(){a(d+j)},j);b=d+j;return h};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(a){clearTimeout(a)}})},"game/ui/CanvasDND":function(){define(["../state","../createBodies","./DNDFileController","dcl"],function(b,d,a,e){return e([a],{id:"canvas",drop:function(a){try{var e=a.dataTransfer.files;if(e&&1===e.length&&e[0].type.match(/image.*/)){var h=e[0],k=new FileReader;k.onerror=function(){};k.onload=function(a){if(a.target.readyState===
FileReader.DONE){var e=new Image;e.onload=function(){b.game.stop();b.backImg=e;b.game.setHeight(e.height);b.game.setWidth(e.width);d();b.game.run()};e.src=a.target.result}};k.readAsDataURL(h);this.dragleave(a)}}catch(l){}}})})},"game/ui/DNDFileController":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/on,dojo/dom,dojo/domReady!".split(","),function(b,d,a,e,f){return b([d],{node:null,borderStyle:null,borderDropStyle:"3px dashed red",constructor:function(){if(!this.node)this.node=f.byId(this.id);
e(this.node,"dragenter",a.hitch(this,"dragenter"));e(this.node,"dragover",a.hitch(this,"dragover"));e(this.node,"dragleave",a.hitch(this,"dragleave"));e(this.node,"drop",a.hitch(this,"drop"));this.borderStyle=this.node.style.border},dragenter:function(a){a.stopPropagation();a.preventDefault();this.node.style.border=this.borderDropStyle},dragover:function(a){a.stopPropagation();a.preventDefault()},dragleave:function(a){a.stopPropagation();a.preventDefault();this.node.style.border=this.borderStyle},
preDrop:function(a){this.node.style.border=this.borderStyle;a.stopPropagation();a.preventDefault();this.drop(a)},drop:function(a){var b=function(){},d=function(){return function(){}};try{for(var e=a.dataTransfer.files,a=0;a<e.length;a++){var c=new FileReader;c.onerror=b;c.onload=d(e[a]);c.readAsDataURL(e[a])}return!1}catch(f){}}})})},"game/ui/events":function(){define("../state,../createBodies,./toggleRedo,lodash,dojo/on,dojo/query,dojo/domReady!".split(","),function(b,d,a,e,f){f(document,"#toolForm:change",
function(a){b.geometries=[];if("tool"===a.target.name)b.tool=a.target.value;if("toolType"===a.target.name)b.toolType=a.target.value});f(document,"#load:click",function(){try{var a=JSON.parse(b.codeMirror.getValue());b.jsonObjs=a.objs;if(a.backImg)b.backImg=new Image,b.backImg.src=a.backImg;b.game.setHeight(a.canvas.height);b.game.setWidth(a.canvas.width);d()}catch(e){}});f(document,"#undoBtn:click",function(){b.jsonObjs.length&&(b.undoObjs.push(b.jsonObjs.pop()),d());a()});f(document,"#redoBtn:click",
function(){b.undoObjs.length&&(b.jsonObjs.push(b.undoObjs.pop()),d());a()});f(document,".gravity:change",e.debounce(d,500));f(document,"#runSimulation:change",function(a){b.game.boxUpdating=a.target.checked});f(document,"#showStatic:change",function(a){b.showStatic=a.target.checked});f(document,"selectstart",function(a){a.preventDefault()})})},"game/ui/toggleRedo":function(){define(["../state","dojo/dom"],function(b,d){var a=d.byId("redoBtn");return function(){a.disabled=b.undoObjs.length?!1:!0}})},
"dojo/query":function(){define("dojo/query","./_base/kernel,./has,./dom,./on,./_base/array,./_base/lang,./selector/_loader,./selector/_loader!default".split(","),function(b,d,a,e,f,j,h,k){function l(b,c){var d=function(d,e){if("string"==typeof e&&(e=a.byId(e),!e))return new c([]);var f="string"==typeof d?b(d,e):d?d.orphan?d:[d]:[];return f.orphan?f:new c(f)};d.matches=b.match||function(a,b,c){return 0<d.filter([a],b,c).length};d.filter=b.filter||function(a,b,c){return d(b,c).filter(function(b){return-1<
f.indexOf(a,b)})};if("function"!=typeof b)var e=b.search,b=function(a,b){return e(b||document,a)};return d}d.add("array-extensible",function(){return 1==j.delegate([],{length:1}).length&&!d("bug-for-in-skips-shadowed")});var c=Array.prototype,g=c.slice,i=c.concat,m=f.forEach,o=function(a,c,d){c=[0].concat(g.call(c,0));d=d||b.global;return function(b){c[0]=b;return a.apply(d,c)}},p=function(a){var b=this instanceof r&&d("array-extensible");"number"==typeof a&&(a=Array(a));var c=a&&"length"in a?a:arguments;
if(b||!c.sort){for(var e=b?this:[],f=e.length=c.length,g=0;g<f;g++)e[g]=c[g];if(b)return e;c=e}j._mixin(c,n);c._NodeListCtor=function(a){return r(a)};return c},r=p,n=r.prototype=d("array-extensible")?[]:{};r._wrap=n._wrap=function(a,b,c){a=new (c||this._NodeListCtor||r)(a);return b?a._stash(b):a};r._adaptAsMap=function(a,b){return function(){return this.map(o(a,arguments,b))}};r._adaptAsForEach=function(a,b){return function(){this.forEach(o(a,arguments,b));return this}};r._adaptAsFilter=function(a,
b){return function(){return this.filter(o(a,arguments,b))}};r._adaptWithCondition=function(a,c,d){return function(){var e=arguments,f=o(a,e,d);if(c.call(d||b.global,e))return this.map(f);this.forEach(f);return this}};m(["slice","splice"],function(a){var b=c[a];n[a]=function(){return this._wrap(b.apply(this,arguments),"slice"==a?this:null)}});m(["indexOf","lastIndexOf","every","some"],function(a){var c=f[a];n[a]=function(){return c.apply(b,[this].concat(g.call(arguments,0)))}});j.extend(p,{constructor:r,
_NodeListCtor:r,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,b){var c=this.map(function(c){return e(c,a,b)});c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()};return c},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},concat:function(a){var b=g.call(this,0),c=f.map(arguments,function(a){return g.call(a,0)});return this._wrap(i.apply(b,c),this)},map:function(a,b){return this._wrap(f.map(this,a,b),this)},
forEach:function(a,b){m(this,a,b);return this},filter:function(a){var b=arguments,c=this,d=0;if("string"==typeof a){c=u._filterResult(this,b[0]);if(1==b.length)return c._stash(this);d=1}return this._wrap(f.filter(c,b[d],b[d+1]),this)},instantiate:function(a,b){var c=j.isFunction(a)?a:j.getObject(a),b=b||{};return this.forEach(function(a){new c(b,a)})},at:function(){var a=new this._NodeListCtor(0);m(arguments,function(b){0>b&&(b=this.length+b);this[b]&&a.push(this[b])},this);return a._stash(this)}});
var u=l(k,p);b.query=l(k,function(a){return p(a)});u.load=function(a,b,c){h.load(a,b,function(a){c(l(a,p))})};b._filterQueryResult=u._filterResult=function(a,b,c){return new p(u.filter(a,b,c))};b.NodeList=u.NodeList=p;return u})},"dojo/selector/_loader":function(){define(["../has","require"],function(b,d){var a=document.createElement("div");b.add("dom-qsa2.1",!!a.querySelectorAll);b.add("dom-qsa3",function(){try{return a.innerHTML="<p class='TEST'></p>",1==a.querySelectorAll(".TEST:empty").length}catch(b){}});
var e;return{load:function(a,j,h){var k=d,a="default"==a?b("config-selectorEngine")||"css3":a,a="css2"==a||"lite"==a?"./lite":"css2.1"==a?b("dom-qsa2.1")?"./lite":"./acme":"css3"==a?b("dom-qsa3")?"./lite":"./acme":"acme"==a?"./acme":(k=j)&&a;if("?"==a.charAt(a.length-1))var a=a.substring(0,a.length-1),l=!0;if(l&&(b("dom-compliant-qsa")||e))return h(e);k([a],function(b){"./lite"!=a&&(e=b);h(b)})}}})},"dojo/selector/acme":function(){define(["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],
function(b,d,a,e,f){var j=e.trim,h=a.forEach,k="BackCompat"==f.doc.compatMode,l=!1,c=function(){return!0},g=function(a){for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ",b=function(b,c){return j(a.slice(b,c))},c=[],d=-1,e=-1,f=-1,g=-1,h=-1,i=-1,k=-1,m,n="",o="",r,p=0,t=a.length,q=null,s=null,u=function(){if(0<=i)q.id=b(i,p).replace(/\\/g,""),i=-1;if(0<=k){var a=k==p?null:b(k,p);q[0>">~+".indexOf(a)?"tag":"oper"]=a;k=-1}0<=h&&(q.classes.push(b(h+1,p).replace(/\\/g,"")),h=-1)};n=o,o=a.charAt(p),
p<t;p++)if("\\"!=n)if(q||(r=p,q={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return l?this.otag:this.tag}},k=p),m)o==m&&(m=null);else if("'"==o||'"'==o)m=o;else if(0<=d)if("]"==o){s.attr?s.matchFor=b(f||d+1,p):s.attr=b(d+1,p);if((d=s.matchFor)&&('"'==d.charAt(0)||"'"==d.charAt(0)))s.matchFor=d.slice(1,-1);if(s.matchFor)s.matchFor=s.matchFor.replace(/\\/g,"");q.attrs.push(s);s=null;d=f=-1}else{if("="==o)f=0<="|~^$*".indexOf(n)?n:"",s.type=f+o,s.attr=b(d+1,
p-f.length),f=p+1}else if(0<=e){if(")"==o){if(0<=g)s.value=b(e+1,p);g=e=-1}}else if("#"==o)u(),i=p+1;else if("."==o)u(),h=p;else if(":"==o)u(),g=p;else if("["==o)u(),d=p,s={};else if("("==o)0<=g&&(s={name:b(g+1,p),value:null},q.pseudos.push(s)),e=p;else if(" "==o&&n!=o){u();0<=g&&q.pseudos.push({name:b(g+1,p)});q.loops=q.pseudos.length||q.attrs.length||q.classes.length;q.oquery=q.query=b(r,p);q.otag=q.tag=q.oper?null:q.tag||"*";if(q.tag)q.tag=q.tag.toUpperCase();if(c.length&&c[c.length-1].oper)q.infixOper=
c.pop(),q.query=q.infixOper.query+" "+q.query;c.push(q);q=null}return c},i=function(a,b){return!a?b:!b?a:function(){return a.apply(window,arguments)&&b.apply(window,arguments)}},m=function(a,b){var c=b||[];a&&c.push(a);return c},o=function(a){return 1==a.nodeType},p=function(a,b){return!a?"":"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(l?a.getAttribute(b):a.getAttribute(b,2))||""},r={"*=":function(a,b){return function(c){return 0<=p(c,a).indexOf(b)}},"^=":function(a,
b){return function(c){return 0==p(c,a).indexOf(b)}},"$=":function(a,b){return function(c){var c=" "+p(c,a),d=c.lastIndexOf(b);return-1<d&&d==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+p(b,a)+" ").indexOf(c)}},"|=":function(a,b){var c=b+"-";return function(d){d=p(d,a);return d==b||0==d.indexOf(c)}},"=":function(a,b){return function(c){return p(c,a)==b}}},n="undefined"==typeof f.doc.firstChild.nextElementSibling,u=!n?"nextElementSibling":"nextSibling",K=
!n?"previousElementSibling":"previousSibling",L=n?o:c,t=function(a){for(;a=a[K];)if(L(a))return!1;return!0},s=function(a){for(;a=a[u];)if(L(a))return!1;return!0},q=function(a){var b=a.parentNode,b=7!=b.nodeType?b:b.nextSibling,c=0,e=b.children||b.childNodes,f=a._i||a.getAttribute("_i")||-1,g=b._l||("undefined"!==typeof b.getAttribute?b.getAttribute("_l"):-1);if(!e)return-1;e=e.length;if(g==e&&0<=f&&0<=g)return f;d("ie")&&"undefined"!==typeof b.setAttribute?b.setAttribute("_l",e):b._l=e;f=-1;for(b=
b.firstElementChild||b.firstChild;b;b=b[u])if(L(b))d("ie")?b.setAttribute("_i",++c):b._i=++c,a===b&&(f=c);return f},D=function(a){return!(q(a)%2)},z=function(a){return q(a)%2},w={checked:function(){return function(a){return!!("checked"in a?a.checked:a.selected)}},disabled:function(){return function(a){return a.disabled}},enabled:function(){return function(a){return!a.disabled}},"first-child":function(){return t},"last-child":function(){return s},"only-child":function(){return function(a){return t(a)&&
s(a)}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return!1}return!0}},contains:function(a,b){var c=b.charAt(0);if('"'==c||"'"==c)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},not:function(a,b){var c=g(b)[0],d={el:1};if("*"!=c.tag)d.tag=1;if(!c.classes.length)d.classes=1;var e=G(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){var c=parseInt;if("odd"==b)return z;if("even"==b)return D;
if(-1!=b.indexOf("n")){var d=b.split("n",2),e=d[0]?"-"==d[0]?-1:c(d[0]):1,f=d[1]?c(d[1]):0,g=0,h=-1;0<e?0>f?f=f%e&&e+f%e:0<f&&(f>=e&&(g=f-f%e),f%=e):0>e&&(e*=-1,0<f&&(h=f,f%=e));if(0<e)return function(a){a=q(a);return a>=g&&(0>h||a<=h)&&a%e==f};b=f}var i=c(b);return function(a){return q(a)==i}}},V=9>d("ie")||9==d("ie")&&d("quirks")?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return l?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&
b.hasAttribute(a)}},G=function(a,b){if(!a)return c;var b=b||{},d=null;"el"in b||(d=i(d,o));"tag"in b||"*"!=a.tag&&(d=i(d,function(b){return b&&(l?b.tagName:b.tagName.toUpperCase())==a.getTag()}));"classes"in b||h(a.classes,function(a,b){var c=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");d=i(d,function(a){return c.test(a.className)});d.count=b});"pseudos"in b||h(a.pseudos,function(a){var b=a.name;w[b]&&(d=i(d,w[b](b,a.value)))});"attrs"in b||h(a.attrs,function(a){var b,c=a.attr;a.type&&r[a.type]?b=r[a.type](c,
a.matchFor):c.length&&(b=V(c));b&&(d=i(d,b))});"id"in b||a.id&&(d=i(d,function(b){return!!b&&b.id==a.id}));d||"default"in b||(d=c);return d},qa=function(a){return function(b,c,d){for(;b=b[u];)if(!n||o(b)){(!d||J(b,d))&&a(b)&&c.push(b);break}return c}},ka=function(a){return function(b,c,d){for(b=b[u];b;){if(L(b)){if(d&&!J(b,d))break;a(b)&&c.push(b)}b=b[u]}return c}},$=function(a){a=a||c;return function(b,c,d){for(var e=0,f=b.children||b.childNodes;b=f[e++];)L(b)&&(!d||J(b,d))&&a(b,e)&&c.push(b);return c}},
W={},O=function(a){var d=W[a.query];if(d)return d;var e=a.infixOper,e=e?e.oper:"",g=G(a,{el:1}),h="*"==a.tag,i=f.doc.getElementsByClassName;if(e){i={el:1};if(h)i.tag=1;g=G(a,i);"+"==e?d=qa(g):"~"==e?d=ka(g):">"==e&&(d=$(g))}else if(a.id)g=!a.loops&&h?c:G(a,{el:1,id:1}),d=function(c,d){var e=b.byId(a.id,c.ownerDocument||c);if(e&&g(e)){if(9==c.nodeType)return m(e,d);for(var f=e.parentNode;f&&!(f==c);)f=f.parentNode;if(f)return m(e,d)}};else if(i&&/\{\s*\[native code\]\s*\}/.test(""+i)&&a.classes.length&&
!k)var g=G(a,{el:1,classes:1,id:1}),j=a.classes.join(" "),d=function(a,b,c){for(var b=m(0,b),d,e=0,f=a.getElementsByClassName(j);d=f[e++];)g(d,a)&&J(d,c)&&b.push(d);return b};else!h&&!a.loops?d=function(b,c,d){for(var c=m(0,c),e=0,f=a.getTag(),f=f?b.getElementsByTagName(f):[];b=f[e++];)J(b,d)&&c.push(b);return c}:(g=G(a,{el:1,tag:1,id:1}),d=function(b,c,d){for(var c=m(0,c),e,f=0,h=(e=a.getTag())?b.getElementsByTagName(e):[];e=h[f++];)g(e,b)&&J(e,d)&&c.push(e);return c});return W[a.query]=d},A={},
X={},M=function(a){var b=g(j(a));if(1==b.length){var c=O(b[0]);return function(a){if(a=c(a,[]))a.nozip=!0;return a}}return function(a){for(var a=m(a),c,d,e=b.length,f,g,h=0;h<e;h++){g=[];c=b[h];d=a.length-1;if(0<d)f={},g.nozip=!0;d=O(c);for(var i=0;c=a[i];i++)d(c,g,f);if(!g.length)break;a=g}return g}},Y=d("ie")?"commentStrip":"nozip",H=!!f.doc.querySelectorAll,aa=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,ba=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},ca=/([^[]*)([^\]]*])?/g,la=function(a,
b,c){return b.replace(aa,ba)+(c||"")},N=function(a,b){a=a.replace(ca,la);if(H){var c=X[a];if(c&&!b)return c}if(c=A[a])return c;var c=a.charAt(0),e=-1==a.indexOf(" ");0<=a.indexOf("#")&&e&&(b=!0);if(H&&!b&&-1==">~+".indexOf(c)&&(!d("ie")||-1==a.indexOf(":"))&&!(k&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf(":checked")&&-1==a.indexOf("|=")){var f=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return X[a]=function(b){try{if(!(9==b.nodeType||e))throw"";var c=b.querySelectorAll(f);
c[Y]=!0;return c}catch(d){return N(a,!0)(b)}}}var g=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return A[a]=2>g.length?M(a):function(a){for(var b=0,c=[],d;d=g[b++];)c=c.concat(M(d)(a));return c}},F=0,ja=d("ie")?function(a){return l?a.getAttribute("_uid")||a.setAttribute("_uid",++F)||F:a.uniqueID}:function(a){return a._uid||(a._uid=++F)},J=function(a,b){if(!b)return 1;var c=ja(a);return!b[c]?b[c]=1:0},I=function(a){if(a&&a.nozip)return a;var b=[];if(!a||!a.length)return b;a[0]&&b.push(a[0]);
if(2>a.length)return b;F++;var c,e;if(d("ie")&&l){var f=F+"";a[0].setAttribute("_zipIdx",f);for(c=1;e=a[c];c++)a[c].getAttribute("_zipIdx")!=f&&b.push(e),e.setAttribute("_zipIdx",f)}else if(d("ie")&&a.commentStrip)try{for(c=1;e=a[c];c++)o(e)&&b.push(e)}catch(g){}else{a[0]&&(a[0]._zipIdx=F);for(c=1;e=a[c];c++)a[c]._zipIdx!=F&&b.push(e),e._zipIdx=F}return b},C=function(a,b){b=b||f.doc;l="div"===(b.ownerDocument||b).createElement("div").tagName;var c=N(a)(b);return c&&c.nozip?c:I(c)};C.filter=function(c,
d,e){for(var f=[],h=g(d),h=1==h.length&&!/[^\w#\.]/.test(d)?G(h[0]):function(c){return-1!=a.indexOf(C(d,b.byId(e)),c)},i=0,j;j=c[i];i++)h(j)&&f.push(j);return f};return C})},"frozen/sounds/WebAudio":function(){define(["dcl","dojo/on","dojo/_base/lang"],function(b,d,a){var e=null;window.AudioContext&&(e=new window.AudioContext);return b(null,{declaredClass:"frozen/sounds/WebAudio",name:null,complete:!1,audioContext:e,buffer:null,constructor:function(a){"string"===typeof a&&this.load(a)},load:function(b){this.name=
b;var e=a.partial(function(a){a.audioContext.decodeAudioData(this.response,function(b){a.buffer=b;a.complete=!0},function(){})},this),h=new XMLHttpRequest;h.open("GET",b,!0);h.responseType="arraybuffer";d(h,"load",e);h.send()},loop:function(a){this._initAudio(a,!0).noteOn(0)},play:function(a,b){this._initAudio(a,!1).noteOn(b||0)},_initAudio:function(a,b){var b="boolean"===typeof b?b:!1,d=this.audioContext.createBufferSource();d.buffer=this.buffer;d.loop=b;if(a){var e=this.audioContext.createGainNode();
e.gain.value=a;d.connect(e);e.connect(this.audioContext.destination)}else d.connect(this.audioContext.destination);return d}})})},"frozen/sounds/HTML5Audio":function(){define(["dcl","dojo/on","dojo/_base/lang"],function(b,d,a){return b(null,{declaredClass:"frozen/sounds/HTML5Audio",name:null,complete:!1,audio:null,constructor:function(a){this.audio=new Audio;"string"===typeof a&&this.load(a)},load:function(b){this.name=b;this.audio.pause();this.audio.preload="auto";this.audio.src=b;d(this.audio,"loadeddata",
a.hitch(this,function(){this.complete=!0}))},loop:function(a){var b=this._initAudio(a,!0);d(b,"loadeddata",function(){b.play()})},play:function(a,b){var b=b||0,j=this._initAudio(a,!1);d(j,"loadeddata",function(){j.currentTime=b/1E3;j.play()})},_initAudio:function(a,b){var b="boolean"===typeof b?b:!1,d=new Audio;d.pause();d.volume=a||1;d.loop=b;d.preload="auto";d.src=this.name;return d}})})},"frozen/plugins/loadImage":function(){define(["../ResourceManager","../utils/parseString"],function(b,d){var a=
new b;return{load:function(b,f,j){b=d(b);b=a.loadImage(b);j(b)}}})},"frozen/utils/parseString":function(){define(function(){return function(b){0===b.indexOf("{")&&b.lastIndexOf("}")===b.length-1?b=JSON.parse(b.replace(/,/g,'","').replace(/:/g,'":"').replace(/\{/,'{"').replace(/\}/,'"}')):0===b.indexOf("[")&&b.lastIndexOf("]")===b.length-1&&(b=JSON.parse(b.replace(/,/g,'","').replace(/\[/g,'["').replace(/\]/g,'"]')));return b}})},"frozen/plugins/loadSound":function(){define(["../ResourceManager","../utils/parseString"],
function(b,d){var a=new b;return{load:function(b,f,j){b=d(b);b=a.loadSound(b);j(b)}}})}}});(function(){require({cache:{}});require.boot&&require.apply(null,require.boot)})();