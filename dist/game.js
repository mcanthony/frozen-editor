//>>built
/*

 Lo-Dash 1.3.1 (Custom Build) <http://lodash.com/>
 Build: `lodash modern -o ./dist/lodash.js`
 Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 Available under MIT license <http://lodash.com/license>
*/
(function(b,f){var e,a,h,l=function(){},j=function(a){for(var d in a)return 0;return 1},c={}.toString,d=function(a){return"[object Function]"==c.call(a)},k=function(a){return"[object String]"==c.call(a)},i=function(a){return"[object Array]"==c.call(a)},m=function(a,d){if(a)for(var c=0;c<a.length;)d(a[c++])},n=function(a,d){for(var c in d)a[c]=d[c];return a},o=function(a,d){return n(Error(a),{src:"dojoLoader",info:d})},q=1,p=function(){return"_"+q++},g=function(a,d,c){return $(a,d,c,0,g)},v=this,r=
v.document,t=r&&r.createElement("DiV"),u=g.has=function(a){return d(s[a])?s[a]=s[a](v,r,t):s[a]},s=u.cache=f.hasCache;u.add=function(a,d,c,k){(void 0===s[a]||k)&&(s[a]=d);return c&&u(a)};for(var y in b.has)u.add(y,b.has[y],0,1);g.async=1;var E=new Function("return eval(arguments[0]);");g.eval=function(a,d){return E(a+"\r\n////@ sourceURL="+d)};var D={},x=g.signal=function(a,d){var c=D[a];m(c&&c.slice(0),function(a){a.apply(null,i(d)?d:[d])})},O=g.on=function(a,d){var c=D[a]||(D[a]=[]);c.push(d);return{remove:function(){for(var a=
0;a<c.length;a++)if(c[a]===d){c.splice(a,1);break}}}},F=[],ka={},aa=[],la={},ta=g.map={},T=[],G={},ma="",V={},na={};y={};var Q=function(a){var d,c,k,b;for(d in na)c=na[d],(k=d.match(/^url\:(.+)/))?V["url:"+Qa(k[1],a)]=c:"*now"==d?b=c:"*noref"!=d&&(k=Ra(d,a),V[k.mid]=V["url:"+k.url]=c);b&&b(H(a));na={}},ga=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},W=function(a,d){d.splice(0,d.length);for(var c in a)d.push([c,a[c],RegExp("^"+ga(c)+"(/|$)"),c.length]);d.sort(function(a,
d){return d[3]-a[3]});return d},ba=function(a){var d=a.name;d||(d=a,a={name:d});a=n({main:"main"},a);a.location=a.location?a.location:d;if(a.packageMap)ta[d]=a.packageMap;if(!a.main.indexOf("./"))a.main=a.main.substring(2);la[d]=a},ua=[],L=function(a,d,c){for(var b in a){if("waitSeconds"==b)g.waitms=1E3*(a[b]||0);"cacheBust"==b&&(ma=a[b]?k(a[b])?a[b]:(new Date).getTime()+"":"");if("baseUrl"==b||"combo"==b)g[b]=a[b];a[b]!==s&&(g.rawConfig[b]=a[b],"has"!=b&&u.add("config-"+b,a[b],0,d))}if(!g.baseUrl)g.baseUrl=
"./";/\/$/.test(g.baseUrl)||(g.baseUrl+="/");for(b in a.has)u.add(b,a.has[b],0,d);m(a.packages,ba);for(h in a.packagePaths)m(a.packagePaths[h],function(a){var d=h+"/"+a;k(a)&&(a={name:a});a.location=d;ba(a)});W(n(ta,a.map),T);m(T,function(a){a[1]=W(a[1],[]);if("*"==a[0])T.star=a});W(n(ka,a.paths),aa);m(a.aliases,function(a){k(a[0])&&(a[0]=RegExp("^"+ga(a[0])+"$"));F.push(a)});if(d)ua.push({config:a.config});else for(b in a.config)d=va(b,c),d.config=n(d.config||{},a.config[b]);if(a.cache)Q(),na=a.cache,
a.cache["*noref"]&&Q();x("config",[a,g.rawConfig])};g.rawConfig={};L(f,1);L(b,1);L(y,1);var z=function(a){wa(function(){m(a.deps,Ka)})},$=function(a,d,c,b,m){var e;if(k(a)){if((e=va(a,b,!0))&&e.executed)return e.result;throw o("undefinedModule",a);}i(a)||(L(a,0,b),a=d,d=c);if(i(a))if(a.length){for(var c="require*"+p(),h,j=[],f=0;f<a.length;)h=a[f++],j.push(va(h,b));e=n(Ta("",c,0,""),{injected:2,deps:j,def:d||l,require:b?b.require:g,gc:1});G[e.mid]=e;z(e);var w=da&&0!="sync";wa(function(){Ba(e,w)});
e.executed||A.push(e);B()}else d&&d();return m},H=function(a){if(!a)return g;var d=a.require;if(!d)d=function(c,b,k){return $(c,b,k,a,d)},a.require=n(d,g),d.module=a,d.toUrl=function(d){return Qa(d,a)},d.toAbsMid=function(d){return La(d,a)};return d},A=[],C=[],w={},oa=function(a){a.injected=1;w[a.mid]=1;a.url&&(w[a.url]=a.pack||1);Ua()},pa=function(a){a.injected=2;delete w[a.mid];a.url&&delete w[a.url];j(w)&&Ma()},M=g.idle=function(){return!C.length&&j(w)&&!A.length&&!da},U=function(a,d){if(d)for(var c=
0;c<d.length;c++)if(d[c][2].test(a))return d[c];return 0},wb=function(a){for(var d=[],c,b,a=a.replace(/\\/g,"/").split("/");a.length;)c=a.shift(),".."==c&&d.length&&".."!=b?(d.pop(),b=d[d.length-1]):"."!=c&&d.push(b=c);return d.join("/")},Ta=function(a,d,c,b){return{pid:a,mid:d,pack:c,url:b,executed:0,def:0}},xb=function(a,c,b,k,i,h,j,n){var l,f,g,p;p=/^\./.test(a);if(/(^\/)|(\:)|(\.js$)/.test(a)||p&&!c)return Ta(0,a,0,a);a=wb(p?c.mid+"/../"+a:a);if(/^\./.test(a))throw o("irrationalPath",a);c&&(g=
U(c.mid,h));(g=(g=g||h.star)&&U(a,g[1]))&&(a=g[1]+a.substring(g[3]));c=(e=a.match(/^([^\/]+)(\/(.+))?$/))?e[1]:"";(l=b[c])?a=c+"/"+(f=e[3]||l.main):c="";var w=0;m(F,function(c){var b=a.match(c[0]);b&&0<b.length&&(w=d(c[1])?a.replace(c[0],c[1]):c[1])});if(w)return xb(w,0,b,k,i,h,j,n);if(b=k[a])return n?Ta(b.pid,b.mid,b.pack,b.url):k[a];k=(g=U(a,j))?g[1]+a.substring(g[3]):c?l.location+"/"+f:a;/(^\/)|(\:)/.test(k)||(k=i+k);return Ta(c,a,l,wb(k+".js"))},Ra=function(a,d){return xb(a,d,la,G,g.baseUrl,T,
aa)},yb=function(a,d,c){return a.normalize?a.normalize(d,function(a){return La(a,c)}):La(d,c)},zb=0,va=function(a,d,c){var b,k;(b=a.match(/^(.+?)\!(.*)$/))?(k=va(b[1],d,c),5===k.executed&&!k.load&&ia(k),k.load?(b=yb(k,b[2],d),a=k.mid+"!"+(k.dynamic?++zb+"!":"")+b):(b=b[2],a=k.mid+"!"+ ++zb+"!waitingForPlugin"),a={plugin:k,mid:a,req:H(d),prid:b}):a=Ra(a,d);return G[a.mid]||!c&&(G[a.mid]=a)},La=g.toAbsMid=function(a,d){return Ra(a,d).mid},Qa=g.toUrl=function(a,d){var c=Ra(a+"/x",d),b=c.url;return Ca(0===
c.pid?a:b.substring(0,b.length-5))},Da={injected:2,executed:5,def:3,result:3},X=function(a){return G[a]=n({mid:a},Da)},Va=X("require"),qa=X("exports"),ea=X("module"),J={},Ea=0,ia=function(a){var d=a.result;a.dynamic=d.dynamic;a.normalize=d.normalize;a.load=d.load;return a},Wa=function(a){var d={};m(a.loadQ,function(c){var b=yb(a,c.prid,c.req.module),k=a.dynamic?c.mid.replace(/waitingForPlugin$/,b):a.mid+"!"+b,b=n(n({},c),{mid:k,prid:b,injected:0});G[k]||Oa(G[k]=b);d[c.mid]=G[k];pa(c);delete G[c.mid]});
a.loadQ=0;var c=function(a){for(var c=a.deps||[],b=0;b<c.length;b++)(a=d[c[b].mid])&&(c[b]=a)},b;for(b in G)c(G[b]);m(A,c)},xa=function(d){g.trace("loader-finish-exec",[d.mid]);d.executed=5;d.defOrder=Ea++;d.loadQ&&(ia(d),Wa(d));for(a=0;a<A.length;)A[a]===d?A.splice(a,1):a++;/^require\*/.test(d.mid)&&delete G[d.mid]},Xa=[],Ba=function(a,c){if(4===a.executed)return g.trace("loader-circular-dependency",[Xa.concat(a.mid).join("->")]),!a.def||c?J:a.cjs&&a.cjs.exports;if(!a.executed){if(!a.def)return J;
var b=a.mid,k=a.deps||[],i,m=[],e=0;for(a.executed=4;e<k.length;){i=k[e++];i=i===Va?H(a):i===qa?a.cjs.exports:i===ea?a.cjs:Ba(i,c);if(i===J)return a.executed=0,g.trace("loader-exec-module",["abort",b]),J;m.push(i)}g.trace("loader-run-factory",[a.mid]);b=a.def;m=d(b)?b.apply(null,m):b;a.result=void 0===m&&a.cjs?a.cjs.exports:m;xa(a)}return a.result},da=0,wa=function(a){try{da++,a()}finally{da--}M()&&x("idle",[])},B=function(){da||wa(function(){for(var a,d,c=0;c<A.length;)a=Ea,d=A[c],Ba(d),a!=Ea?c=
0:c++})};void 0===u("dojo-loader-eval-hint-url")&&u.add("dojo-loader-eval-hint-url",1);var Ca=function(a){a+="";return a+(ma?(/\?/.test(a)?"&":"?")+ma:"")},Oa=function(a){var d=a.plugin;5===d.executed&&!d.load&&ia(d);var c=function(d){a.result=d;pa(a);xa(a);B()};d.load?d.load(a.prid,a.req,c):d.loadQ?d.loadQ.push(a):(d.loadQ=[a],A.unshift(d),Ka(d))},ra=0,ya=0,Fa=0,Ya=function(a,d){u("config-stripStrict")&&(a=a.replace(/"use strict"/g,""));Fa=1;a===ra?ra.call(null):g.eval(a,u("dojo-loader-eval-hint-url")?
d.url:d.mid);Fa=0},Ka=function(a){var d=a.mid,c=a.url;if(!a.executed&&!a.injected&&!(w[d]||a.url&&(a.pack&&w[a.url]===a.pack||1==w[a.url])))if(oa(a),a.plugin)Oa(a);else{var b=function(){Za(a);2!==a.injected&&(pa(a),n(a,Da),g.trace("loader-define-nonmodule",[a.url]));B()};(ra=V[d]||V["url:"+a.url])?(g.trace("loader-inject",["cache",a.mid,c]),Ya(ra,a),b()):(g.trace("loader-inject",["script",a.mid,c]),ya=a,g.injectUrl(Ca(c),b,a),ya=0)}},za=function(a,c,b){g.trace("loader-define-module",[a.mid,c]);if(2===
a.injected)return x("error",o("multipleDefine",a)),a;n(a,{deps:c,def:b,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(d){a.cjs.exports=d},config:function(){return a.config}}});for(var k=0;k<c.length;k++)c[k]=va(c[k],a);pa(a);if(!d(b)&&!c.length)a.result=b,xa(a);return a},Za=function(a,d){for(var c=[],b,k;C.length;)k=C.shift(),d&&(k[0]=d.shift()),b=k[0]&&va(k[0])||a,c.push([b,k[1],k[2]]);Q(a);m(c,function(a){z(za.apply(null,a))})},Ma=l,Ua=l;u.add("ie-event-behavior",!!r.attachEvent&&
("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var Ga=function(a,d,c,b){if(u("ie-event-behavior"))return a.attachEvent(c,b),function(){a.detachEvent(c,b)};a.addEventListener(d,b,!1);return function(){a.removeEventListener(d,b,!1)}},$a=Ga(window,"load","onload",function(){g.pageLoaded=1;"complete"!=r.readyState&&(r.readyState="complete");$a()}),Ha=r.getElementsByTagName("script")[0],ab=Ha.parentNode;g.injectUrl=function(a,d,c){var c=c.node=r.createElement("script"),b=Ga(c,"load",
"onreadystatechange",function(a){var a=a||window.event,c=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(c.readyState))b(),k(),d&&d()}),k=Ga(c,"error","onerror",function(d){b();k();x("error",o("scriptError",[a,d]))});c.type="text/javascript";c.charset="utf-8";c.src=a;ab.insertBefore(c,Ha);return c};g.log=l;g.trace=l;X=function(a,c,b){var i=arguments.length,m=["require","exports","module"],e=[0,a,c];1==i?e=[0,d(a)?m:[],a]:2==i&&k(a)?e=[a,d(c)?m:[],c]:3==i&&(e=[a,c,b]);g.trace("loader-define",
e.slice(0,2));if((i=e[0]&&va(e[0]))&&!w[i.mid])z(za(i,e[1],e[2]));else if(!u("ie-event-behavior")||Fa)C.push(e);else{i=i||ya;if(!i)for(a in w)if((m=G[a])&&m.node&&"interactive"===m.node.readyState){i=m;break}i?(Q(i),z(za(i,e[1],e[2]))):x("error",o("ieDefineFailed",e[0]));B()}};X.amd={vendor:"dojotoolkit.org"};n(n(g,f.loaderPatch),b.loaderPatch);O("error",function(a){try{if(console.error(a),a instanceof Error)for(var d in a);}catch(c){}});n(g,{uid:p,cache:V,packs:la});if(!v.define)v.define=X,v.require=
g,m(ua,function(a){L(a)}),O=y.deps||b.deps||f.deps,y=y.callback||b.callback||f.callback,g.boot=O||y?[O||[],y]:0})(this.dojoConfig||this.djConfig||this.require||{},{async:1,baseUrl:"./",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../frozen-editor",name:"frozen-editor"},{location:".",name:"dojo"},{location:"../dcl",main:"dcl",name:"dcl"},{location:"../frozen",main:"GameCore",name:"frozen"},{location:"../lodash",
main:"lodash",name:"lodash"},{location:"../hammer",main:"hammer",name:"hammer"},{location:"../put",main:"put",name:"put"},{location:"../game",main:"game",name:"game"}]});
require({cache:{"dist/game":function(){define([],1)},"game/game":function(){define("./state,./initInput,./handleInput,./update,./draw,./createBodies,frozen/box2d/Box,frozen/box2d/BoxGame,frozen/box2d/listeners/Contact,./ui/CanvasDND".split(","),function(b,f,e,a,h,l,j,c,d,k){var j=new j({contactListener:new d({beginContact:function(a,d,c){c.GetFixtureA().IsSensor()&&c.IsTouching()&&(i.entities[d].touching[a]=!0);c.GetFixtureB().IsSensor()&&c.IsTouching()&&(i.entities[a].touching[d]=!0)},endContact:function(a,
d,c){c.GetFixtureA().IsSensor()&&!c.IsTouching()&&(i.entities[d].touching[a]=!1);c.GetFixtureB().IsSensor()&&!c.IsTouching()&&(i.entities[a].touching[d]=!1)}})}),i=new c({canvasId:"canvas",initInput:f,handleInput:e,update:a,draw:h,box:j,createBodies:l});b.game=i;new k({game:i});i.run()})},"game/state":function(){define(["dojo/dom","dojo/domReady!"],function(b){return{entities:[],joints:[],undoObjs:[],geometries:[],mode:"create",tool:"rectangle",options:"static",sensor:!1,showStatic:!0,backImg:null,
game:null,codeMirror:CodeMirror.fromTextArea(b.byId("output"),{theme:"frozen",matchBrackets:!0,mode:"application/json"})}})},"dojo/dom":function(){define(["./sniff","./_base/window"],function(b,f){if(7>=b("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}var a={};a.byId=b("ie")?function(a,b){if("string"!=typeof a)return a;var c=b||f.doc,d=a&&c.getElementById(a);if(d&&(d.attributes.id.value==a||d.id==a))return d;c=c.all[a];if(!c||c.nodeName)c=[c];for(var k=0;d=c[k++];)if(d.attributes&&
d.attributes.id&&d.attributes.id.value==a||d.id==a)return d}:function(a,b){return("string"==typeof a?(b||f.doc).getElementById(a):a)||null};a.isDescendant=function(b,e){try{b=a.byId(b);for(e=a.byId(e);b;){if(b==e)return!0;b=b.parentNode}}catch(c){}return!1};b.add("css-user-select",function(a,b,c){if(!c)return!1;var a=c.style,b=["Khtml","O","ms","Moz","Webkit"],c=b.length,d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});var h=b("css-user-select");
a.setSelectable=h?function(b,e){a.byId(b).style[h]=e?"":"none"}:function(b,e){var b=a.byId(b),c=b.getElementsByTagName("*"),d=c.length;if(e)for(b.removeAttribute("unselectable");d--;)c[d].removeAttribute("unselectable");else for(b.setAttribute("unselectable","on");d--;)c[d].setAttribute("unselectable","on")};return a})},"dojo/sniff":function(){define(["./has"],function(b){var f=navigator,e=f.userAgent,f=f.appVersion,a=parseFloat(f);b.add("air",0<=e.indexOf("AdobeAIR"));b.add("khtml",0<=f.indexOf("Konqueror")?
a:void 0);b.add("webkit",parseFloat(e.split("WebKit/")[1])||void 0);b.add("chrome",parseFloat(e.split("Chrome/")[1])||void 0);b.add("safari",0<=f.indexOf("Safari")&&!b("chrome")?parseFloat(f.split("Version/")[1]):void 0);b.add("mac",0<=f.indexOf("Macintosh"));b.add("quirks","BackCompat"==document.compatMode);b.add("ios",/iPhone|iPod|iPad/.test(e));b.add("android",parseFloat(e.split("Android ")[1])||void 0);if(!b("webkit")){0<=e.indexOf("Opera")&&b.add("opera",9.8<=a?parseFloat(e.split("Version/")[1])||
a:a);0<=e.indexOf("Gecko")&&!b("khtml")&&!b("webkit")&&b.add("mozilla",a);b("mozilla")&&b.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0);if(document.all&&!b("opera"))e=parseFloat(f.split("MSIE ")[1])||void 0,(f=document.documentMode)&&5!=f&&Math.floor(e)!=f&&(e=f),b.add("ie",e);b.add("wii","undefined"!=typeof opera&&opera.wiiremote)}return b})},"dojo/has":function(){define(["require","module"],function(b){var f=b.has||function(){};f.add("touch","ontouchstart"in document);
f.add("device-width",screen.availWidth||innerWidth);b=document.createElement("form");f.add("dom-attributes-explicit",0==b.attributes.length);f.add("dom-attributes-specified-flag",0<b.attributes.length&&40>b.attributes.length);f.clearElement=function(b){b.innerHTML="";return b};f.normalize=function(b,a){var h=b.match(/[\?:]|[^:\?]*/g),l=0,j=function(a){var d=h[l++];if(":"==d)return 0;if("?"==h[l++]){if(!a&&f(d))return j();j(!0);return j(a)}return d||0};return(b=j())&&a(b)};f.load=function(b,a,h){b?
a([b],h):h()};return f})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(b,f,e){var a={global:b.global,doc:this.document||null,body:function(a){a=a||b.doc;return a.body||a.getElementsByTagName("body")[0]},setContext:function(e,f){b.global=a.global=e;b.doc=a.doc=f},withGlobal:function(e,f,j,c){var d=b.global;try{return b.global=a.global=e,a.withDoc.call(null,e.document,f,j,c)}finally{b.global=a.global=d}},withDoc:function(h,f,j,c){var d=a.doc,k=e("quirks"),i=e("ie"),
m,n,o;try{b.doc=a.doc=h;b.isQuirks=e.add("quirks","BackCompat"==b.doc.compatMode,!0,!0);if(e("ie")&&(o=h.parentWindow)&&o.navigator)m=parseFloat(o.navigator.appVersion.split("MSIE ")[1])||void 0,(n=h.documentMode)&&5!=n&&Math.floor(m)!=n&&(m=n),b.isIE=e.add("ie",m,!0,!0);j&&"string"==typeof f&&(f=j[f]);return f.apply(j,c||[])}finally{b.doc=a.doc=d,b.isQuirks=e.add("quirks",k,!0,!0),b.isIE=e.add("ie",i,!0,!0)}}};f.mixin(b,a);return a})},"dojo/_base/kernel":function(){define(["../has","./config","require",
"module"],function(b,f,e,a){var h,b={},l={},j={config:f,global:this,dijit:b,dojox:l},b={dojo:["dojo",j],dijit:["dijit",b],dojox:["dojox",l]},a=e.map&&e.map[a.id.match(/[^\/]+/)[0]];for(h in a)b[h]?b[h][0]=a[h]:b[h]=[a[h],{}];for(h in b)a=b[h],a[1]._scopeName=a[0],f.noGlobals||(this[a[0]]=a[1]);j.scopeMap=b;j.baseUrl=j.config.baseUrl=e.baseUrl;j.isAsync=e.async;j.locale=f.locale;f="$Rev$".match(/\d+/);j.version={major:1,minor:8,patch:3,flag:"",revision:f?+f[0]:NaN,toString:function(){var a=j.version;
return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};Function("d","d.eval = function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(j);j.exit=function(){};j.deprecated=j.experimental=function(){};j._hasResource={};return j})},"dojo/_base/config":function(){define(["../has","require"],function(b,f){var e={},a=f.rawConfig,h;for(h in a)e[h]=a[h];return e})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(b,f){f.add("bug-for-in-skips-shadowed",
function(){for(var a in{toString:1})return 0;return 1});var e=f("bug-for-in-skips-shadowed")?"hasOwnProperty.valueOf.isPrototypeOf.propertyIsEnumerable.toLocaleString.toString.constructor".split("."):[],a=e.length,h=function(a,d,c){var e,h=0,j=b.global;if(!c)if(a.length){e=a[h++];try{c=b.scopeMap[e]&&b.scopeMap[e][1]}catch(f){}c=c||(e in j?j[e]:d?j[e]={}:void 0)}else return j;for(;c&&(e=a[h++]);)c=e in c?c[e]:d?c[e]={}:void 0;return c},l=Object.prototype.toString,j=function(a,d,c){return(c||[]).concat(Array.prototype.slice.call(a,
d||0))},c=/\{([^\}]+)\}/g,d={_extraNames:e,_mixin:function(d,c,b){var h,j,l,p={};for(h in c)if(j=c[h],!(h in d)||d[h]!==j&&(!(h in p)||p[h]!==j))d[h]=b?b(j):j;if(f("bug-for-in-skips-shadowed")&&c)for(l=0;l<a;++l)if(h=e[l],j=c[h],!(h in d)||d[h]!==j&&(!(h in p)||p[h]!==j))d[h]=b?b(j):j;return d},mixin:function(a,c){a||(a={});for(var b=1,e=arguments.length;b<e;b++)d._mixin(a,arguments[b]);return a},setObject:function(a,d,c){var b=a.split("."),a=b.pop();return(c=h(b,!0,c))&&a?c[a]=d:void 0},getObject:function(a,
d,c){return h(a.split("."),d,c)},exists:function(a,c){return void 0!==d.getObject(a,!1,c)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:function(a){return a&&(a instanceof Array||"array"==typeof a)},isFunction:function(a){return"[object Function]"===l.call(a)},isObject:function(a){return void 0!==a&&(null===a||"object"==typeof a||d.isArray(a)||d.isFunction(a))},isArrayLike:function(a){return a&&void 0!==a&&!d.isString(a)&&!d.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&
(d.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!d.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(""+a)},extend:function(a,c){for(var b=1,e=arguments.length;b<e;b++)d._mixin(a.prototype,arguments[b]);return a},_hitchArgs:function(a,c){var e=d._toArray(arguments,2),h=d.isString(c);return function(){var j=d._toArray(arguments),f=h?(a||b.global)[c]:c;return f&&f.apply(a||this,e.concat(j))}},hitch:function(a,c){if(2<arguments.length)return d._hitchArgs.apply(b,arguments);c||(c=a,a=
null);if(d.isString(c)){a=a||b.global;if(!a[c])throw['lang.hitch: scope["',c,'"] is null (scope="',a,'")'].join("");return function(){return a[c].apply(a,arguments||[])}}return!a?c:function(){return c.apply(a,arguments||[])}},delegate:function(){function a(){}return function(c,b){a.prototype=c;var e=new a;a.prototype=null;b&&d._mixin(e,b);return e}}(),_toArray:f("ie")?function(){function a(d,c,b){b=b||[];for(c=c||0;c<d.length;c++)b.push(d[c]);return b}return function(d){return(d.item?a:j).apply(this,
arguments)}}():j,partial:function(a){return d.hitch.apply(b,[null].concat(d._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||d.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return RegExp(a);var c,b,e;if(d.isArray(a)){c=[];for(b=0,e=a.length;b<e;++b)b in a&&c.push(d.clone(a[b]))}else c=a.constructor?new a.constructor:{};return d._mixin(c,a,d.clone)},trim:String.prototype.trim?
function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,b,e){return a.replace(e||c,d.isFunction(b)?b:function(a,c){return d.getObject(c,!1,b)})}};d.mixin(b,d);return d})},"dojo/domReady":function(){define(["./has"],function(){function b(a){l?a(e):j.push(a)}var f=this,e=document,a={loaded:1,complete:1},h="string"!=typeof e.readyState,l=!!a[e.readyState];if(h)e.readyState="loading";if(!l){var j=[],c=[],d=function(c){c=c||f.event;if(!(l||"readystatechange"==
c.type&&!a[e.readyState])){l=1;if(h)e.readyState="complete";for(;j.length;)j.shift()(e)}},k=function(a,c){a.addEventListener(c,d,!1);j.push(function(){a.removeEventListener(c,d,!1)})};k(e,"DOMContentLoaded");k(f,"load");"onreadystatechange"in e?k(e,"readystatechange"):h||c.push(function(){return a[e.readyState]});if(c.length){var i=function(){if(!l){for(var a=c.length;a--;)if(c[a]()){d("poller");return}setTimeout(i,30)}};i()}}b.load=function(a,c,d){b(d)};return b})},"game/initInput":function(){define("./state,./ui/toggleRedo,./ui/loadJSON,./ui/saveJSON,./ui/displayJSON,put,lodash,dojo/on,dojo/query".split(","),
function(b,f,e,a,h,l,j,c){return function(){var d=this;c(document,"#createForm:change",function(a){b.geometries=[];if("mode"===a.target.name){b.mode=a.target.value;var c=document.querySelectorAll(".tools");j.forEach(c,function(a){a.id===b.mode?l(a,"!hide"):l(a,".hide")})}if("create"===a.target.name)b.tool=a.target.value;if("createOption"===a.target.name)b.options=a.target.value});c(document,"#load:click",function(){e()&&(d.setHeight(b.height),d.setWidth(b.width),d.createBodies())});c(document,"#save:click",
function(){a()});c(document,"#prettyPrint:change",function(){e()&&h()});c(document,"#undoBtn:click",function(){b.entities.length&&(b.undoObjs.push(b.entities.pop()),d.createBodies());f()});c(document,"#redoBtn:click",function(){b.undoObjs.length&&(b.entities.push(b.undoObjs.pop()),d.createBodies());f()});c(document,".gravity:change",j.debounce(j.bind(d.createBodies,d),500));c(document,"#sensor:change",function(a){b.sensor=a.target.checked});c(document,"#runSimulation:change",function(a){d.boxUpdating=
a.target.checked});c(document,"#showStatic:change",function(a){b.showStatic=a.target.checked});c(document,"selectstart",function(a){a.preventDefault()})}})},"game/ui/toggleRedo":function(){define(["../state","dojo/dom"],function(b,f){var e=f.byId("redoBtn");return function(){e.disabled=b.undoObjs.length?!1:!0}})},"game/ui/loadJSON":function(){define(["../state","put"],function(b,f){return function(){var e=document.getElementById("msg");try{var a=JSON.parse(b.codeMirror.getValue());b.entities=a.entities||
a.objs;if(a.joints)b.joints=a.joints;if(a.backImg)b.backImg=new Image,b.backImg.src=a.backImg;if(a.canvas.height)b.height=a.canvas.height;if(a.canvas.width)b.width=a.canvas.width;f(e,"!error",{textContent:""});return b}catch(h){f(e,".error",{textContent:"Error loading JSON - "+h.message})}}})},"put/put":function(){(function(b){var f,e=/[-+,> ]/;b([],f=function(a,b){function l(b){function h(){g&&p&&g!=p&&(p==b&&(f||(f=e.test(u)&&a.createDocumentFragment()))||p).insertBefore(g,q||null)}for(var f,o,
q,p,g,v=arguments,r=v[0],t=0;t<v.length;t++){var u=v[t];if("object"==typeof u){o=!1;if(u instanceof Array){g=a.createDocumentFragment();for(var s=0;s<u.length;s++)g.appendChild(l(u[s]));u=g}if(u.nodeType)g=u,h(),p=u,q=0;else for(s in u)g[s]=u[s]}else if(o)o=!1,g.appendChild(a.createTextNode(u));else{1>t&&(b=null);o=!0;if(r=u.replace(j,function(e,j,f,n,o,r){if(j){h();if("-"==j||"+"==j){if(p=(q=g||p).parentNode,g=null,"+"==j)q=q.nextSibling}else"<"==j?p=g=(g||p).parentNode:(","==j?p=b:g&&(p=g),g=null),
q=0;g&&(p=g)}if((e=!f&&n)||!g&&(f||o))"$"==e?(e=v[++t],p.appendChild(a.createTextNode(e))):(e=e||l.defaultTag,(j=k&&v[t+1]&&v[t+1].name)&&(e="<"+e+' name="'+j+'">'),g=d&&~(c=e.indexOf("|"))?a.createElementNS(d[e.slice(0,c)],e.slice(c+1)):a.createElement(e));if(f)if("$"==n&&(n=v[++t]),"#"==f)g.id=n;else if(j=(e=g.className)&&(" "+e+" ").replace(" "+n+" "," "),"."==f)g.className=e?(j+n).substring(1):n;else if("!"==u){var s;k?l("div",g,"<").innerHTML="":(s=g.parentNode)&&s.removeChild(g)}else if(j=j.substring(1,
j.length-1),j!=e)g.className=j;if(o)"$"==r&&(r=v[++t]),"style"==o?g.style.cssText=r:(f="!"==o.charAt(0)?(o=o.substring(1))&&"removeAttribute":"setAttribute",r=""===r?o:r,d&&~(c=o.indexOf("|"))?g[f+"NS"](d[o.slice(0,c)],o.slice(c+1),r):g[f](o,r));return""}))throw new SyntaxError("Unexpected char "+r+" in "+u);h();p=r=g||p}}b&&f&&b.appendChild(f);return r}e=b||e;var j=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,c,d=!1,a=a||document,k="object"==typeof a.createElement;
l.addNamespace=function(c,b){a.createElementNS?(d||(d={}))[c]=b:a.namespaces.add(c,b)};l.defaultTag="div";l.forDocument=f;return l})})(function(b,f,e){e=e||f;"function"===typeof define?define([],function(){return e()}):"undefined"==typeof window?require("./node-html")(module,e):put=e()})},"game/ui/saveJSON":function(){define(["../state","put","dojo/request"],function(b,f,e){return function(){var a=document.getElementById("msg"),h="";try{h=JSON.stringify({"public":!0,files:{"world.json":{content:b.codeMirror.getValue()}}})}catch(l){}e.post("https://api.github.com/gists",
{data:h}).then(function(b){b=JSON.parse(b);f(a,"!error",{innerHTML:'Data Saved: <a href="'+b.html_url+'">'+b.html_url+"</a>"})},function(){f(a,".error",{textContent:"Error Saving Data - Please Try Again"})})}})},"dojo/request":function(){define(["./request/default!"],function(b){return b})},"dojo/request/default":function(){define(["exports","require","../has"],function(b,f,e){var a=e("config-requestProvider");a||(a="./xhr");b.getPlatformDefaultId=function(){return"./xhr"};b.load=function(b,e,j){f(["platform"==
b?"./xhr":a],function(a){j(a)})}})},"game/ui/displayJSON":function(){define(["../state","dojo/dom"],function(b,f){return function(){var e=f.byId("prettyPrint").checked?"  ":"";b.codeMirror.setValue(JSON.stringify({entities:b.entities,joints:b.joints,canvas:{height:b.game?b.game.height:null,width:b.game?b.game.width:null},backImg:b.backImg?b.backImg.src:null},null,e))}})},"lodash/lodash":function(){(function(b){function f(a,c,d){for(var d=(d||0)-1,b=a.length;++d<b;)if(a[d]===c)return d;return-1}function e(a,
c){var d=typeof c,a=a.cache;if("boolean"==d||null==c)return a[c];"number"!=d&&"string"!=d&&(d="object");var b="number"==d?c:t+c,a=a[d]||(a[d]={});return"object"==d?a[b]&&-1<f(a[b],c)?0:-1:a[b]?0:-1}function a(a){var c=this.cache,d=typeof a;if("boolean"==d||null==a)c[a]=!0;else{"number"!=d&&"string"!=d&&(d="object");var b="number"==d?a:t+a,e=c[d]||(c[d]={});if("object"==d){if((e[b]||(e[b]=[])).push(a)==this.array.length)c[d]=!1}else e[b]=!0}}function h(a){return a.charCodeAt(0)}function l(a,d){var c=
a.index,b=d.index,a=a.criteria,d=d.criteria;if(a!==d){if(a>d||"undefined"==typeof a)return 1;if(a<d||"undefined"==typeof d)return-1}return c<b?-1:1}function j(d){var c=-1,b=d.length,e=k();e["false"]=e["null"]=e["true"]=e.undefined=!1;var i=k();i.array=d;i.cache=e;for(i.push=a;++c<b;)i.push(d[c]);return!1===e.object?(m(i),null):i}function c(a){return"\\"+w[a]}function d(){return p.pop()||[]}function k(){return g.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,leading:!1,maxWait:0,"null":!1,
number:null,object:null,push:null,string:null,trailing:!1,"true":!1,undefined:!1,value:null}}function i(a){a.length=0;p.length<s&&p.push(a)}function m(a){var d=a.cache;d&&m(d);a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null;g.length<s&&g.push(a)}function n(a,d,c){d||(d=0);"undefined"==typeof c&&(c=a?a.length:0);for(var b=-1,c=c-d||0,e=Array(0>c?0:c);++b<c;)e[b]=a[d+b];return e}function o(a){function g(a){return a&&"object"==typeof a&&!Y(a)&&N.call(a,"__wrapped__")?a:new p(a)}function p(a){this.__wrapped__=
a}function w(a,d,c,b){function e(){var b=arguments,j=i?this:d;g||(a=d[h]);c.length&&(b=b.length?(b=K.call(b),k?b.concat(c):c.concat(b)):c);return this instanceof e?(j=J(a.prototype)?bb(a.prototype):{},b=a.apply(j,b),J(b)?b:j):a.apply(j,b)}var g=ea(a),i=!c,h=d;if(i)var k=b,c=d;else if(!g){if(!b)throw new Fb;d=a}return e}function oa(a){return Ab[a]}function M(){var a=(a=g.indexOf)===Za?f:a;return a}function s(a){return function(d,c,b,e){"boolean"!=typeof c&&null!=c&&(e=b,b=!(e&&e[c]===d)?c:q,c=!1);
null!=b&&(b=g.createCallback(b,e));return a(d,c,b,e)}}function La(a){var d,c;if(!(a&&S.call(a)==z)||(d=a.constructor,ea(d)&&!(d instanceof d)))return!1;Aa(a,function(a,d){c=d});return c===q||N.call(a,c)}function Qa(a){return Hb[a]}function Da(a,c,b,e,h,j){var k=a;"boolean"!=typeof c&&null!=c&&(e=b,b=c,c=!1);if("function"==typeof b){b="undefined"==typeof e?b:g.createCallback(b,e,1);k=b(k);if("undefined"!=typeof k)return k;k=a}if(e=J(k)){var m=S.call(k);if(!A[m])return k;var f=Y(k)}if(!e||!c)return e?
f?n(k):mb({},k):k;e=ja[m];switch(m){case W:case ba:return new e(+k);case L:case H:return new e(k);case $:return e(k.source,F.exec(k))}m=!h;h||(h=d());j||(j=d());for(var l=h.length;l--;)if(h[l]==a)return j[l];k=f?e(k.length):{};if(f){if(N.call(a,"index"))k.index=a.index;if(N.call(a,"input"))k.input=a.input}h.push(a);j.push(k);(f?B:I)(a,function(a,d){k[d]=Da(a,c,b,q,h,j)});m&&(i(h),i(j));return k}function X(a){var d=[];Aa(a,function(a,c){ea(a)&&d.push(c)});return d.sort()}function Va(a){for(var d=-1,
c=Z(a),b=c.length,e={};++d<b;){var g=c[d];e[a[g]]=g}return e}function qa(a,c,b,e,k,h){var j=b===r;if("function"==typeof b&&!j){var b=g.createCallback(b,e,2),m=b(a,c);if("undefined"!=typeof m)return!!m}if(a===c)return 0!==a||1/a==1/c;var f=typeof a,l=typeof c;if(a===a&&(!a||"function"!=f&&"object"!=f)&&(!c||"function"!=l&&"object"!=l))return!1;if(null==a||null==c)return a===c;l=S.call(a);f=S.call(c);l==Q&&(l=z);f==Q&&(f=z);if(l!=f)return!1;switch(l){case W:case ba:return+a==+c;case L:return a!=+a?
c!=+c:0==a?1/a==1/c:a==+c;case $:case H:return a==ha(c)}f=l==ga;if(!f){if(N.call(a,"__wrapped__ ")||N.call(c,"__wrapped__"))return qa(a.__wrapped__||a,c.__wrapped__||c,b,e,k,h);if(l!=z)return!1;var l=a.constructor,n=c.constructor;if(l!=n&&(!ea(l)||!(l instanceof l&&ea(n)&&n instanceof n)))return!1}n=!k;k||(k=d());h||(h=d());for(l=k.length;l--;)if(k[l]==a)return h[l]==c;var o=0,m=!0;k.push(a);h.push(c);if(f){l=a.length;o=c.length;m=o==a.length;if(!m&&!j)return m;for(;o--;)if(f=l,n=c[o],j)for(;f--&&
!(m=qa(a[f],n,b,e,k,h)););else if(!(m=qa(a[o],n,b,e,k,h)))break;return m}Aa(c,function(c,d,g){if(N.call(g,d))return o++,m=N.call(a,d)&&qa(a[d],c,b,e,k,h)});m&&!j&&Aa(a,function(a,c,d){if(N.call(d,c))return m=-1<--o});n&&(i(k),i(h));return m}function ea(a){return"function"==typeof a}function J(a){return!(!a||!C[typeof a])}function Ea(a){return"number"==typeof a||S.call(a)==L}function ia(a){return"string"==typeof a||S.call(a)==H}function Wa(a,c,b){var e=arguments,k=0,h=2;if(!J(a))return a;if(b===r)var j=
e[3],m=e[4],f=e[5];else{var l=!0,m=d(),f=d();if("number"!=typeof b)h=e.length;3<h&&"function"==typeof e[h-2]?j=g.createCallback(e[--h-1],e[h--],2):2<h&&"function"==typeof e[h-1]&&(j=e[--h])}for(;++k<h;)(Y(e[k])?B:I)(e[k],function(c,d){var b,e,g=c,i=a[d];if(c&&((e=Y(c))||nb(c))){for(g=m.length;g--;)if(b=m[g]==c){i=f[g];break}if(!b){var k;if(j&&(g=j(i,c),k="undefined"!=typeof g))i=g;k||(i=e?Y(i)?i:[]:nb(i)?i:{});m.push(c);f.push(i);k||(i=Wa(i,c,r,j,m,f))}}else j&&(g=j(i,c),"undefined"==typeof g&&(g=
c)),"undefined"!=typeof g&&(i=g);a[d]=i});l&&(i(m),i(f));return a}function xa(a){for(var c=-1,d=Z(a),b=d.length,e=P(b);++c<b;)e[c]=a[d[c]];return e}function Xa(a,c,d){var b=-1,e=M(),g=a?a.length:0,i=!1,d=(0>d?fa(0,g+d):d)||0;g&&"number"==typeof g?i=-1<(ia(a)?a.indexOf(c,d):e(a,c,d)):I(a,function(a){if(++b>=d)return!(i=a===c)});return i}function Ba(a,c,d){var b=!0,c=g.createCallback(c,d),d=-1,e=a?a.length:0;if("number"==typeof e)for(;++d<e&&(b=!!c(a[d],d,a)););else I(a,function(a,d,e){return b=!!c(a,
d,e)});return b}function da(a,c,d){var b=[],c=g.createCallback(c,d),d=-1,e=a?a.length:0;if("number"==typeof e)for(;++d<e;){var i=a[d];c(i,d,a)&&b.push(i)}else I(a,function(a,d,e){c(a,d,e)&&b.push(a)});return b}function wa(a,c,d){var c=g.createCallback(c,d),d=-1,b=a?a.length:0;if("number"==typeof b)for(;++d<b;){var e=a[d];if(c(e,d,a))return e}else{var i;I(a,function(a,d,b){if(c(a,d,b))return i=a,!1});return i}}function B(a,c,d){var b=-1,e=a?a.length:0,c=c&&"undefined"==typeof d?c:g.createCallback(c,
d);if("number"==typeof e)for(;++b<e&&!(!1===c(a[b],b,a)););else I(a,c);return a}function Ca(a,c,d){var b=-1,e=a?a.length:0,c=g.createCallback(c,d);if("number"==typeof e)for(var i=P(e);++b<e;)i[b]=c(a[b],b,a);else i=[],I(a,function(a,d,e){i[++b]=c(a,d,e)});return i}function Oa(a,c,d){var b=-Infinity,e=b;if(!c&&Y(a))for(var d=-1,i=a.length;++d<i;){var k=a[d];k>e&&(e=k)}else c=!c&&ia(a)?h:g.createCallback(c,d),B(a,function(a,d,g){d=c(a,d,g);d>b&&(b=d,e=a)});return e}function ra(a,c){var d=-1,b=a?a.length:
0;if("number"==typeof b)for(var e=P(b);++d<b;)e[d]=a[d][c];return e||Ca(a,c)}function ya(a,c,d,b){if(!a)return d;var e=3>arguments.length,c=g.createCallback(c,b,4),i=-1,k=a.length;if("number"==typeof k)for(e&&(d=a[++i]);++i<k;)d=c(d,a[i],i,a);else I(a,function(a,b,g){d=e?(e=!1,a):c(d,a,b,g)});return d}function Fa(a,c,d,b){var e=a?a.length:0,i=3>arguments.length;if("number"!=typeof e)var k=Z(a),e=k.length;c=g.createCallback(c,b,4);B(a,function(b,g,h){g=k?k[--e]:--e;d=i?(i=!1,a[g]):c(d,a[g],g,h)});
return d}function Ya(a,c,d){var b,c=g.createCallback(c,d),d=-1,e=a?a.length:0;if("number"==typeof e)for(;++d<e&&!(b=c(a[d],d,a)););else I(a,function(a,d,e){return!(b=c(a,d,e))});return!!b}function Ka(a){var c=-1,d=M(),b=a?a.length:0,g=Ia.apply(R,K.call(arguments,1)),i=[],k=b>=u&&d===f;if(k){var h=j(g);h?(d=e,g=h):k=!1}for(;++c<b;)h=a[c],0>d(g,h)&&i.push(h);k&&m(g);return i}function za(a,c,d){if(a){var b=0,e=a.length;if("number"!=typeof c&&null!=c)for(var i=-1,c=g.createCallback(c,d);++i<e&&c(a[i],
i,a);)b++;else if(b=c,null==b||d)return a[0];return n(a,0,cb(fa(0,b),e))}}function Za(a,c,d){if("number"==typeof d)var b=a?a.length:0,d=0>d?fa(0,b+d):d||0;else if(d)return d=Ua(a,c),a[d]===c?d:-1;return a?f(a,c,d):-1}function Ma(a,c,d){if("number"!=typeof c&&null!=c)for(var b=0,e=-1,i=a?a.length:0,c=g.createCallback(c,d);++e<i&&c(a[e],e,a);)b++;else b=null==c||d?1:fa(0,c);return n(a,b)}function Ua(a,c,d,b){for(var e=0,i=a?a.length:e,d=d?g.createCallback(d,b,1):ib,c=d(c);e<i;)b=e+i>>>1,d(a[b])<c?e=
b+1:i=b;return e}function Ga(a){for(var c=-1,d=a?Oa(ra(a,"length")):0,b=P(0>d?0:d);++c<d;)b[c]=ra(a,c);return b}function $a(a,c){for(var d=-1,b=a?a.length:0,e={};++d<b;){var g=a[d];c?e[g]=c[d]:e[g[0]]=g[1]}return e}function Ha(a,c){return Bb.fastBind||sa&&2<arguments.length?sa.call.apply(sa,arguments):w(a,c,K.call(arguments,2))}function ab(a,c,d){function b(){db(l);db(n);j=0;l=n=null}function e(){var c=o&&(!p||1<j);b();c&&(!1!==f&&(m=new Sa),k=a.apply(h,i))}function g(){b();if(o||f!==c)m=new Sa,k=
a.apply(h,i)}var i,k,h,j=0,m=0,f=!1,l=null,n=null,o=!0,c=fa(0,c||0);if(!0===d)var p=!0,o=!1;else if(J(d))p=d.leading,f="maxWait"in d&&fa(c,d.maxWait||0),o="trailing"in d?d.trailing:o;return function(){i=arguments;h=this;j++;db(n);if(!1===f)p&&2>j&&(k=a.apply(h,i));else{var d=new Sa;!l&&!p&&(m=d);var b=f-(d-m);0>=b?(db(l),l=null,m=d,k=a.apply(h,i)):l||(l=eb(g,b))}c!==f&&(n=eb(e,c));return k}}function tb(a){var c=K.call(arguments,1);return eb(function(){a.apply(q,c)},1)}function ib(a){return a}function ub(a){B(X(a),
function(c){var d=g[c]=a[c];g.prototype[c]=function(){var a=this.__wrapped__,c=[a];fb.apply(c,arguments);c=d.apply(g,c);return a&&"object"==typeof a&&a===c?this:new p(c)}})}function vb(){return this.__wrapped__}var a=a?U.defaults(b.Object(),a,U.pick(b,V)):b,P=a.Array,jb=a.Boolean,Sa=a.Date,kb=a.Function,ca=a.Math,Eb=a.Number,Na=a.Object,lb=a.RegExp,ha=a.String,Fb=a.TypeError,R=[],ob=Na.prototype,Ib=a._,Ja=lb("^"+ha(ob.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+
"$"),Jb=ca.ceil,db=a.clearTimeout,Ia=R.concat,Cb=ca.floor,Kb=kb.prototype.toString,Pa=Ja.test(Pa=Na.getPrototypeOf)&&Pa,N=ob.hasOwnProperty,fb=R.push,gb=a.setImmediate,eb=a.setTimeout,S=ob.toString,sa=Ja.test(sa=S.bind)&&sa,bb=Ja.test(bb=Na.create)&&bb,pb=Ja.test(pb=P.isArray)&&pb,Lb=a.isFinite,Mb=a.isNaN,hb=Ja.test(hb=Na.keys)&&hb,fa=ca.max,cb=ca.min,qb=a.parseInt,Db=ca.random,K=R.slice,ca=Ja.test(a.attachEvent),ca=sa&&!/\n|true/.test(sa+ca),ja={};ja[ga]=P;ja[W]=jb;ja[ba]=Sa;ja[ua]=kb;ja[z]=Na;ja[L]=
Eb;ja[$]=lb;ja[H]=ha;p.prototype=g.prototype;var Bb=g.support={};Bb.fastBind=sa&&!ca;g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:ka,variable:"",imports:{_:g}};var Y=pb,Z=!hb?function(a){var c,d=[];if(!a||!C[typeof a])return d;for(c in a)N.call(a,c)&&d.push(c);return d}:function(a){return!J(a)?[]:hb(a)},Ab={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Hb=Va(Ab),mb=function(a,c,d){var b,e=a,i=e;if(!e)return i;var k=arguments,h=0,j="number"==typeof d?
2:k.length;if(3<j&&"function"==typeof k[j-2])var m=g.createCallback(k[--j-1],k[j--],2);else 2<j&&"function"==typeof k[j-1]&&(m=k[--j]);for(;++h<j;)if((e=k[h])&&C[typeof e])for(var f=-1,l=C[typeof e]&&Z(e),n=l?l.length:0;++f<n;)b=l[f],i[b]=m?m(i[b],e[b]):e[b];return i},rb=function(a,c,d){var b,e=a,g=e;if(!e)return g;for(var i=arguments,k=0,h="number"==typeof d?2:i.length;++k<h;)if((e=i[k])&&C[typeof e])for(var j=-1,m=C[typeof e]&&Z(e),f=m?m.length:0;++j<f;)b=m[j],"undefined"==typeof g[b]&&(g[b]=e[b]);
return g},Aa=function(a,c,d){var b;if(!a||!C[typeof a])return a;c=c&&"undefined"==typeof d?c:g.createCallback(c,d);for(b in a)if(!1===c(a[b],b,a))break;return a},I=function(a,c,d){if(!a||!C[typeof a])return a;for(var c=c&&"undefined"==typeof d?c:g.createCallback(c,d),b=-1,e=C[typeof a]&&Z(a),i=e?e.length:0;++b<i&&!(d=e[b],!1===c(a[d],d,a)););return a},nb=function(a){if(!(a&&S.call(a)==z))return!1;var c=a.valueOf,d="function"==typeof c&&(d=Pa(c))&&Pa(d);return d?a==d||Pa(a)==d:La(a)},jb=s(function Gb(a,
c,d){for(var b=-1,e=a?a.length:0,g=[];++b<e;){var i=a[b];d&&(i=d(i,b,a));Y(i)?fb.apply(g,c?i:Gb(i)):g.push(i)}return g}),sb=s(function(a,c,b){var g=-1,k=M(),h=a?a.length:0,l=[],n=!c&&h>=u&&k===f,o=b||n?d():l;if(n){var p=j(o);p?(k=e,o=p):(n=!1,o=b?o:(i(o),l))}for(;++g<h;){var p=a[g],w=b?b(p,g,a):p;if(c?!g||o[o.length-1]!==w:0>k(o,w))(b||n)&&o.push(w),l.push(p)}n?(i(o.array),m(o)):b&&i(o);return l});ca&&pa&&"function"==typeof gb&&(tb=Ha(gb,a));gb=8==qb(la+"08")?qb:function(a,c){return qb(ia(a)?a.replace(ta,
""):a,c||0)};g.after=function(a,c){return 1>a?c():function(){if(1>--a)return c.apply(this,arguments)}};g.assign=mb;g.at=function(a){for(var c=-1,d=Ia.apply(R,K.call(arguments,1)),b=d.length,e=P(b);++c<b;)e[c]=a[d[c]];return e};g.bind=Ha;g.bindAll=function(a){for(var c=1<arguments.length?Ia.apply(R,K.call(arguments,1)):X(a),d=-1,b=c.length;++d<b;){var e=c[d];a[e]=Ha(a[e],a)}return a};g.bindKey=function(a,c){return w(a,c,K.call(arguments,2),r)};g.compact=function(a){for(var c=-1,d=a?a.length:0,b=[];++c<
d;){var e=a[c];e&&b.push(e)}return b};g.compose=function(){var a=arguments;return function(){for(var c=arguments,d=a.length;d--;)c=[a[d].apply(this,c)];return c[0]}};g.countBy=function(a,c,d){var b={},c=g.createCallback(c,d);B(a,function(a,d,e){d=ha(c(a,d,e));N.call(b,d)?b[d]++:b[d]=1});return b};g.createCallback=function(a,c,d){if(null==a)return ib;var b=typeof a;if("function"!=b){if("object"!=b)return function(c){return c[a]};var e=Z(a);return function(c){for(var d=e.length,b=!1;d--&&(b=qa(c[e[d]],
a[e[d]],r)););return b}}return"undefined"==typeof c||aa&&!aa.test(Kb.call(a))?a:1===d?function(d){return a.call(c,d)}:2===d?function(d,b){return a.call(c,d,b)}:4===d?function(d,b,e,g){return a.call(c,d,b,e,g)}:function(d,b,e){return a.call(c,d,b,e)}};g.debounce=ab;g.defaults=rb;g.defer=tb;g.delay=function(a,c){var d=K.call(arguments,2);return eb(function(){a.apply(q,d)},c)};g.difference=Ka;g.filter=da;g.flatten=jb;g.forEach=B;g.forIn=Aa;g.forOwn=I;g.functions=X;g.groupBy=function(a,c,d){var b={},
c=g.createCallback(c,d);B(a,function(a,d,e){d=ha(c(a,d,e));(N.call(b,d)?b[d]:b[d]=[]).push(a)});return b};g.initial=function(a,c,d){if(!a)return[];var b=0,e=a.length;if("number"!=typeof c&&null!=c)for(var i=e,c=g.createCallback(c,d);i--&&c(a[i],i,a);)b++;else b=null==c||d?1:c||b;return n(a,0,cb(fa(0,e-b),e))};g.intersection=function(a){for(var c=arguments,b=c.length,g=-1,k=d(),h=-1,l=M(),n=a?a.length:0,o=[],p=d();++g<b;){var w=c[g];k[g]=l===f&&(w?w.length:0)>=u&&j(g?c[g]:p)}a:for(;++h<n;){var r=k[0],
w=a[h];if(0>(r?e(r,w):l(p,w))){g=b;for((r||p).push(w);--g;)if(r=k[g],0>(r?e(r,w):l(c[g],w)))continue a;o.push(w)}}for(;b--;)(r=k[b])&&m(r);i(k);i(p);return o};g.invert=Va;g.invoke=function(a,c){var d=K.call(arguments,2),b=-1,e="function"==typeof c,g=a?a.length:0,i=P("number"==typeof g?g:0);B(a,function(a){i[++b]=(e?c:a[c]).apply(a,d)});return i};g.keys=Z;g.map=Ca;g.max=Oa;g.memoize=function(a,c){function d(){var b=d.cache,e=t+(c?c.apply(this,arguments):arguments[0]);return N.call(b,e)?b[e]:b[e]=a.apply(this,
arguments)}d.cache={};return d};g.merge=Wa;g.min=function(a,c,d){var b=Infinity,e=b;if(!c&&Y(a))for(var d=-1,i=a.length;++d<i;){var k=a[d];k<e&&(e=k)}else c=!c&&ia(a)?h:g.createCallback(c,d),B(a,function(a,d,g){d=c(a,d,g);d<b&&(b=d,e=a)});return e};g.omit=function(a,c,d){var b=M(),e="function"==typeof c,i={};if(e)c=g.createCallback(c,d);else var k=Ia.apply(R,K.call(arguments,1));Aa(a,function(a,d,g){if(e?!c(a,d,g):0>b(k,d))i[d]=a});return i};g.once=function(a){var c,d;return function(){if(c)return d;
c=!0;d=a.apply(this,arguments);a=null;return d}};g.pairs=function(a){for(var c=-1,d=Z(a),b=d.length,e=P(b);++c<b;){var g=d[c];e[c]=[g,a[g]]}return e};g.partial=function(a){return w(a,K.call(arguments,1))};g.partialRight=function(a){return w(a,K.call(arguments,1),null,r)};g.pick=function(a,c,d){var b={};if("function"!=typeof c)for(var e=-1,i=Ia.apply(R,K.call(arguments,1)),k=J(a)?i.length:0;++e<k;){var h=i[e];h in a&&(b[h]=a[h])}else c=g.createCallback(c,d),Aa(a,function(a,d,e){c(a,d,e)&&(b[d]=a)});
return b};g.pluck=ra;g.range=function(a,c,d){a=+a||0;d=+d||1;null==c&&(c=a,a=0);for(var b=-1,c=fa(0,Jb((c-a)/d)),e=P(c);++b<c;)e[b]=a,a+=d;return e};g.reject=function(a,c,d){c=g.createCallback(c,d);return da(a,function(a,d,b){return!c(a,d,b)})};g.rest=Ma;g.shuffle=function(a){var c=-1,d=a?a.length:0,b=P("number"==typeof d?d:0);B(a,function(a){var d=Cb(Db()*(++c+1));b[c]=b[d];b[d]=a});return b};g.sortBy=function(a,c,d){var b=-1,e=a?a.length:0,i=P("number"==typeof e?e:0),c=g.createCallback(c,d);B(a,
function(a,d,e){var g=i[++b]=k();g.criteria=c(a,d,e);g.index=b;g.value=a});e=i.length;for(i.sort(l);e--;)a=i[e],i[e]=a.value,m(a);return i};g.tap=function(a,c){c(a);return a};g.throttle=function(a,c,d){var b=!0,e=!0;!1===d?b=!1:J(d)&&(b="leading"in d?d.leading:b,e="trailing"in d?d.trailing:e);d=k();d.leading=b;d.maxWait=c;d.trailing=e;a=ab(a,c,d);m(d);return a};g.times=function(a,c,d){for(var a=-1<(a=+a)?a:0,b=-1,e=P(a),c=g.createCallback(c,d,1);++b<a;)e[b]=c(b);return e};g.toArray=function(a){return a&&
"number"==typeof a.length?n(a):xa(a)};g.transform=function(a,c,d,b){var e=Y(a),c=g.createCallback(c,b,4);null==d&&(e?d=[]:(b=a&&a.constructor,d=J(b&&b.prototype)?bb(b&&b.prototype):{}));(e?B:I)(a,function(a,b,e){return c(d,a,b,e)});return d};g.union=function(a){Y(a)||(arguments[0]=a?K.call(a):R);return sb(Ia.apply(R,arguments))};g.uniq=sb;g.unzip=Ga;g.values=xa;g.where=da;g.without=function(a){return Ka(a,K.call(arguments,1))};g.wrap=function(a,c){return function(){var d=[a];fb.apply(d,arguments);
return c.apply(this,d)}};g.zip=function(a){return a?Ga(arguments):[]};g.zipObject=$a;g.collect=Ca;g.drop=Ma;g.each=B;g.extend=mb;g.methods=X;g.object=$a;g.select=da;g.tail=Ma;g.unique=sb;ub(g);g.chain=g;g.prototype.chain=function(){return this};g.clone=Da;g.cloneDeep=function(a,c,d){return Da(a,!0,c,d)};g.contains=Xa;g.escape=function(a){return null==a?"":ha(a).replace(G,oa)};g.every=Ba;g.find=wa;g.findIndex=function(a,c,d){for(var b=-1,e=a?a.length:0,c=g.createCallback(c,d);++b<e;)if(c(a[b],b,a))return b;
return-1};g.findKey=function(a,c,d){var b,c=g.createCallback(c,d);I(a,function(a,d,e){if(c(a,d,e))return b=d,!1});return b};g.has=function(a,c){return a?N.call(a,c):!1};g.identity=ib;g.indexOf=Za;g.isArguments=function(a){return S.call(a)==Q};g.isArray=Y;g.isBoolean=function(a){return!0===a||!1===a||S.call(a)==W};g.isDate=function(a){return a?"object"==typeof a&&S.call(a)==ba:!1};g.isElement=function(a){return a?1===a.nodeType:!1};g.isEmpty=function(a){var c=!0;if(!a)return c;var d=S.call(a),b=a.length;
if(d==ga||d==H||d==Q||d==z&&"number"==typeof b&&ea(a.splice))return!b;I(a,function(){return c=!1});return c};g.isEqual=qa;g.isFinite=function(a){return Lb(a)&&!Mb(parseFloat(a))};g.isFunction=ea;g.isNaN=function(a){return Ea(a)&&a!=+a};g.isNull=function(a){return null===a};g.isNumber=Ea;g.isObject=J;g.isPlainObject=nb;g.isRegExp=function(a){return a?"object"==typeof a&&S.call(a)==$:!1};g.isString=ia;g.isUndefined=function(a){return"undefined"==typeof a};g.lastIndexOf=function(a,c,d){var b=a?a.length:
0;for("number"==typeof d&&(b=(0>d?fa(0,b+d):cb(d,b-1))+1);b--;)if(a[b]===c)return b;return-1};g.mixin=ub;g.noConflict=function(){a._=Ib;return this};g.parseInt=gb;g.random=function(a,c){null==a&&null==c&&(c=1);a=+a||0;null==c?(c=a,a=0):c=+c||0;var d=Db();return a%1||c%1?a+cb(d*(c-a+parseFloat("1e-"+((d+"").length-1))),c):a+Cb(d*(c-a+1))};g.reduce=ya;g.reduceRight=Fa;g.result=function(a,c){var d=a?a[c]:q;return ea(d)?a[c]():d};g.runInContext=o;g.size=function(a){var c=a?a.length:0;return"number"==
typeof c?c:Z(a).length};g.some=Ya;g.sortedIndex=Ua;g.template=function(a,d,b){var e=g.templateSettings;a||(a="");var b=rb({},b,e),i=rb({},b.imports,e.imports),e=Z(i),i=xa(i),k,h=0,j=b.interpolate||T,m="__p += '",j=lb((b.escape||T).source+"|"+j.source+"|"+(j===ka?O:T).source+"|"+(b.evaluate||T).source+"|$","g");a.replace(j,function(d,b,e,g,i,j){e||(e=g);m+=a.slice(h,j).replace(ma,c);b&&(m+="' +\n__e("+b+") +\n'");i&&(k=!0,m+="';\n"+i+";\n__p += '");e&&(m+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'");
h=j+d.length;return d});var m=m+"';\n",f=j=b.variable;f||(j="obj",m="with ("+j+") {\n"+m+"\n}\n");m=(k?m.replace(y,""):m).replace(E,"$1").replace(D,"$1;");m="function("+j+") {\n"+(f?"":j+" || ("+j+" = {});\n")+"var __t, __p = '', __e = _.escape"+(k?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";b="\n/*\n//@ sourceURL="+(b.sourceURL||"/lodash/template/source["+na++ +"]")+"\n*/";try{var l=kb(e,"return "+m+b).apply(q,i)}catch(n){throw n.source=
m,n;}if(d)return l(d);l.source=m;return l};g.unescape=function(a){return null==a?"":ha(a).replace(x,Qa)};g.uniqueId=function(a){var c=++v;return ha(null==a?"":a)+c};g.all=Ba;g.any=Ya;g.detect=wa;g.findWhere=wa;g.foldl=ya;g.foldr=Fa;g.include=Xa;g.inject=ya;I(g,function(a,c){g.prototype[c]||(g.prototype[c]=function(){var c=[this.__wrapped__];fb.apply(c,arguments);return a.apply(g,c)})});g.first=za;g.last=function(a,c,d){if(a){var b=0,e=a.length;if("number"!=typeof c&&null!=c)for(var i=e,c=g.createCallback(c,
d);i--&&c(a[i],i,a);)b++;else if(b=c,null==b||d)return a[e-1];return n(a,fa(0,e-b))}};g.take=za;g.head=za;I(g,function(a,c){g.prototype[c]||(g.prototype[c]=function(c,d){var b=a(this.__wrapped__,c,d);return null==c||d&&"function"!=typeof c?b:new p(b)})});g.VERSION="1.3.1";g.prototype.toString=function(){return ha(this.__wrapped__)};g.prototype.value=vb;g.prototype.valueOf=vb;B(["join","pop","shift"],function(a){var c=R[a];g.prototype[a]=function(){return c.apply(this.__wrapped__,arguments)}});B(["push",
"reverse","sort","unshift"],function(a){var c=R[a];g.prototype[a]=function(){c.apply(this.__wrapped__,arguments);return this}});B(["concat","slice","splice"],function(a){var c=R[a];g.prototype[a]=function(){return new p(c.apply(this.__wrapped__,arguments))}});return g}var q,p=[],g=[],v=0,r={},t=+new Date+"",u=75,s=40,y=/\b__p \+= '';/g,E=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,x=/&(?:amp|lt|gt|quot|#39);/g,O=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,F=/\w*$/,ka=/<%=([\s\S]+?)%>/g,aa=(aa=/\bthis\b/)&&
aa.test(o)&&aa,la=" \t\u000b\u000c\u00a0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",ta=RegExp("^["+la+"]*0+(?=.$)"),T=/($^)/,G=/[&<>"']/g,ma=/['\n\r\t\u2028\u2029\\]/g,V="Array,Boolean,Date,Function,Math,Number,Object,RegExp,String,_,attachEvent,clearTimeout,isFinite,isNaN,parseInt,setImmediate,setTimeout".split(","),na=0,Q="[object Arguments]",ga="[object Array]",W="[object Boolean]",ba="[object Date]",ua="[object Function]",
L="[object Number]",z="[object Object]",$="[object RegExp]",H="[object String]",A={};A[ua]=!1;A[Q]=A[ga]=A[W]=A[ba]=A[L]=A[z]=A[$]=A[H]=!0;var C={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},w={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},oa=C[typeof exports]&&exports,pa=C[typeof module]&&module&&module.exports==oa&&module,M=C[typeof global]&&global;if(M&&(M.global===M||M.window===M))b=M;var U=o();"function"==typeof define&&"object"==typeof define.amd&&
define.amd?(b._=U,define(function(){return U})):oa&&!oa.nodeType?pa?(pa.exports=U)._=U:oa._=U:b._=U})(this)},"dojo/on":function(){define(["require","./_base/kernel","./has"],function(b,f,e){function a(a,d,b,k,h){if(k=d.match(/(.*):(.*)/))return d=k[2],k=k[1],j.selector(k,d).call(h,a,b);e("touch")&&(c.test(d)&&(b=p(b)),!e("event-orientationchange")&&"orientationchange"==d&&(d="resize",a=window,b=p(b)));n&&(b=n(b));if(a.addEventListener){var m=d in i,f=m?i[d]:d;a.addEventListener(f,b,m);return{remove:function(){a.removeEventListener(f,
b,m)}}}d="on"+d;throw Error("Target must be an event emitter");}function h(){this.cancelable=!1}function l(){this.bubbles=!1}b=window.ScriptEngineMajorVersion;e.add("jscript",b&&b()+ScriptEngineMinorVersion()/10);e.add("event-orientationchange",e("touch")&&!e("android"));e.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);var j=function(c,d,b,e){return"function"==typeof c.on&&"function"!=typeof d?c.on(d,b):j.parse(c,d,b,
a,e,this)};j.pausable=function(a,c,d,b){var e,a=j(a,c,function(){if(!e)return d.apply(this,arguments)},b);a.pause=function(){e=!0};a.resume=function(){e=!1};return a};j.once=function(a,c,d){var b=j(a,c,function(){b.remove();return d.apply(this,arguments)});return b};j.parse=function(a,c,d,b,e,i){if(c.call)return c.call(i,a,d);if(-1<c.indexOf(",")){for(var c=c.split(/\s*,\s*/),k=[],h=0,m;m=c[h++];)k.push(b(a,m,d,e,i));k.remove=function(){for(var a=0;a<k.length;a++)k[a].remove()};return k}return b(a,
c,d,e,i)};var c=/^touch/;j.selector=function(a,c,d){return function(b,e){function i(c){for(k=k&&k.matches?k:f.query;!k.matches(c,a,b);)if(c==b||!1===d||!(c=c.parentNode)||1!=c.nodeType)return;return c}var k="function"==typeof a?{matches:a}:this,h=c.bubble;return h?j(b,h(i),e):j(b,c,function(a){var c=i(a.target);return c&&e.call(c,a)})}};var d=[].slice,k=j.emit=function(a,c,b){var e=d.call(arguments,2),i="on"+c;if("parentNode"in a){var k=e[0]={},m;for(m in b)k[m]=b[m];k.preventDefault=h;k.stopPropagation=
l;k.target=a;k.type=c;b=k}do a[i]&&a[i].apply(a,e);while(b&&b.bubbles&&(a=a.parentNode));return b&&b.cancelable&&b},i={};if(!e("event-stopimmediatepropagation"))var m=function(){this.modified=this.immediatelyStopped=!0},n=function(a){return function(c){if(!c.immediatelyStopped)return c.stopImmediatePropagation=m,a.apply(this,arguments)}};i={focusin:"focus",focusout:"blur"};j.emit=function(a,c,d){if(a.dispatchEvent&&document.createEvent){var b=a.ownerDocument.createEvent("HTMLEvents");b.initEvent(c,
!!d.bubbles,!!d.cancelable);for(var e in d)e in b||(b[e]=d[e]);return a.dispatchEvent(b)&&b}return k.apply(j,arguments)};if(e("touch"))var o=function(){},q=window.orientation,p=function(a){return function(c){var d=c.corrected;if(!d){var b=c.type;try{delete c.type}catch(e){}c.type?(o.prototype=c,d=new o,d.preventDefault=function(){c.preventDefault()},d.stopPropagation=function(){c.stopPropagation()}):(d=c,d.type=b);c.corrected=d;if("resize"==b){if(q==window.orientation)return null;q=window.orientation;
d.type="orientationchange";return a.call(this,d)}if(!("rotation"in d))d.rotation=0,d.scale=1;var b=d.changedTouches[0],i;for(i in b)delete d[i],d[i]=b[i]}return a.call(this,d)}};return j})},"dojo/query":function(){define("./_base/kernel,./has,./dom,./on,./_base/array,./_base/lang,./selector/_loader,./selector/_loader!default".split(","),function(b,f,e,a,h,l,j,c){function d(a,c){var d=function(d,b){if("string"==typeof b&&(b=e.byId(b),!b))return new c([]);var i="string"==typeof d?a(d,b):d?d.orphan?
d:[d]:[];return i.orphan?i:new c(i)};d.matches=a.match||function(a,c,b){return 0<d.filter([a],c,b).length};d.filter=a.filter||function(a,c,b){return d(c,b).filter(function(c){return-1<h.indexOf(a,c)})};if("function"!=typeof a)var b=a.search,a=function(a,c){return b(c||document,a)};return d}f.add("array-extensible",function(){return 1==l.delegate([],{length:1}).length&&!f("bug-for-in-skips-shadowed")});var k=Array.prototype,i=k.slice,m=k.concat,n=h.forEach,o=function(a,c,d){c=[0].concat(i.call(c,0));
d=d||b.global;return function(b){c[0]=b;return a.apply(d,c)}},q=function(a){var c=this instanceof p&&f("array-extensible");"number"==typeof a&&(a=Array(a));var d=a&&"length"in a?a:arguments;if(c||!d.sort){for(var b=c?this:[],e=b.length=d.length,i=0;i<e;i++)b[i]=d[i];if(c)return b;d=b}l._mixin(d,g);d._NodeListCtor=function(a){return p(a)};return d},p=q,g=p.prototype=f("array-extensible")?[]:{};p._wrap=g._wrap=function(a,c,d){a=new (d||this._NodeListCtor||p)(a);return c?a._stash(c):a};p._adaptAsMap=
function(a,c){return function(){return this.map(o(a,arguments,c))}};p._adaptAsForEach=function(a,c){return function(){this.forEach(o(a,arguments,c));return this}};p._adaptAsFilter=function(a,c){return function(){return this.filter(o(a,arguments,c))}};p._adaptWithCondition=function(a,c,d){return function(){var e=arguments,i=o(a,e,d);if(c.call(d||b.global,e))return this.map(i);this.forEach(i);return this}};n(["slice","splice"],function(a){var c=k[a];g[a]=function(){return this._wrap(c.apply(this,arguments),
"slice"==a?this:null)}});n(["indexOf","lastIndexOf","every","some"],function(a){var c=h[a];g[a]=function(){return c.apply(b,[this].concat(i.call(arguments,0)))}});l.extend(q,{constructor:p,_NodeListCtor:p,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(c,d){var b=this.map(function(b){return a(b,c,d)});b.remove=function(){for(var a=0;a<b.length;a++)b[a].remove()};return b},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},
concat:function(a){var c=i.call(this,0),d=h.map(arguments,function(a){return i.call(a,0)});return this._wrap(m.apply(c,d),this)},map:function(a,c){return this._wrap(h.map(this,a,c),this)},forEach:function(a,c){n(this,a,c);return this},filter:function(a){var c=arguments,d=this,b=0;if("string"==typeof a){d=v._filterResult(this,c[0]);if(1==c.length)return d._stash(this);b=1}return this._wrap(h.filter(d,c[b],c[b+1]),this)},instantiate:function(a,c){var d=l.isFunction(a)?a:l.getObject(a),c=c||{};return this.forEach(function(a){new d(c,
a)})},at:function(){var a=new this._NodeListCtor(0);n(arguments,function(c){0>c&&(c=this.length+c);this[c]&&a.push(this[c])},this);return a._stash(this)}});var v=d(c,q);b.query=d(c,function(a){return q(a)});v.load=function(a,c,b){j.load(a,c,function(a){b(d(a,q))})};b._filterQueryResult=v._filterResult=function(a,c,d){return new q(v.filter(a,c,d))};b.NodeList=v.NodeList=q;return v})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(b,f,e){function a(a){return j[a]=new Function("item",
"index","array",a)}function h(c){var d=!c;return function(b,e,h){var f=0,l=b&&b.length||0,g;l&&"string"==typeof b&&(b=b.split(""));"string"==typeof e&&(e=j[e]||a(e));if(h)for(;f<l;++f){if(g=!e.call(h,b[f],f,b),c^g)return!g}else for(;f<l;++f)if(g=!e(b[f],f,b),c^g)return!g;return d}}function l(a){var b=1,e=0,h=0;a||(b=e=h=-1);return function(j,f,l,g){if(g&&0<b)return d.lastIndexOf(j,f,l);var g=j&&j.length||0,v=a?g+h:e;l===c?l=a?e:g+h:0>l?(l=g+l,0>l&&(l=e)):l=l>=g?g+h:l;for(g&&"string"==typeof j&&(j=
j.split(""));l!=v;l+=b)if(j[l]==f)return l;return-1}}var j={},c,d={every:h(!1),some:h(!0),indexOf:l(!0),lastIndexOf:l(!1),forEach:function(c,d,b){var e=0,h=c&&c.length||0;h&&"string"==typeof c&&(c=c.split(""));"string"==typeof d&&(d=j[d]||a(d));if(b)for(;e<h;++e)d.call(b,c[e],e,c);else for(;e<h;++e)d(c[e],e,c)},map:function(c,d,b,e){var h=0,f=c&&c.length||0,e=new (e||Array)(f);f&&"string"==typeof c&&(c=c.split(""));"string"==typeof d&&(d=j[d]||a(d));if(b)for(;h<f;++h)e[h]=d.call(b,c[h],h,c);else for(;h<
f;++h)e[h]=d(c[h],h,c);return e},filter:function(c,d,b){var e=0,h=c&&c.length||0,f=[],l;h&&"string"==typeof c&&(c=c.split(""));"string"==typeof d&&(d=j[d]||a(d));if(b)for(;e<h;++e)l=c[e],d.call(b,l,e,c)&&f.push(l);else for(;e<h;++e)l=c[e],d(l,e,c)&&f.push(l);return f},clearCache:function(){j={}}};e.mixin(b,d);return d})},"dojo/selector/_loader":function(){define(["../has","require"],function(b,f){var e=document.createElement("div");b.add("dom-qsa2.1",!!e.querySelectorAll);b.add("dom-qsa3",function(){try{return e.innerHTML=
"<p class='TEST'></p>",1==e.querySelectorAll(".TEST:empty").length}catch(a){}});var a;return{load:function(e,l,j){var c=f,e="default"==e?b("config-selectorEngine")||"css3":e,e="css2"==e||"lite"==e?"./lite":"css2.1"==e?b("dom-qsa2.1")?"./lite":"./acme":"css3"==e?b("dom-qsa3")?"./lite":"./acme":"acme"==e?"./acme":(c=l)&&e;if("?"==e.charAt(e.length-1))var e=e.substring(0,e.length-1),d=!0;if(d&&(b("dom-compliant-qsa")||a))return j(a);c([e],function(c){"./lite"!=e&&(a=c);j(c)})}}})},"dojo/selector/acme":function(){define(["../dom",
"../sniff","../_base/array","../_base/lang","../_base/window"],function(b,f,e,a,h){var l=a.trim,j=e.forEach,c="BackCompat"==h.doc.compatMode,d=!1,k=function(){return!0},i=function(a){for(var a=0<=">~+".indexOf(a.slice(-1))?a+" * ":a+" ",c=function(c,d){return l(a.slice(c,d))},b=[],e=-1,i=-1,g=-1,h=-1,k=-1,j=-1,m=-1,f,n="",o="",p,q=0,v=a.length,t=null,r=null,u=function(){if(0<=j)t.id=c(j,q).replace(/\\/g,""),j=-1;if(0<=m){var a=m==q?null:c(m,q);t[0>">~+".indexOf(a)?"tag":"oper"]=a;m=-1}0<=k&&(t.classes.push(c(k+
1,q).replace(/\\/g,"")),k=-1)};n=o,o=a.charAt(q),q<v;q++)if("\\"!=n)if(t||(p=q,t={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return d?this.otag:this.tag}},m=q),f)o==f&&(f=null);else if("'"==o||'"'==o)f=o;else if(0<=e)if("]"==o){r.attr?r.matchFor=c(g||e+1,q):r.attr=c(e+1,q);if((e=r.matchFor)&&('"'==e.charAt(0)||"'"==e.charAt(0)))r.matchFor=e.slice(1,-1);if(r.matchFor)r.matchFor=r.matchFor.replace(/\\/g,"");t.attrs.push(r);r=null;e=g=-1}else{if("="==o)g=0<=
"|~^$*".indexOf(n)?n:"",r.type=g+o,r.attr=c(e+1,q-g.length),g=q+1}else if(0<=i){if(")"==o){if(0<=h)r.value=c(i+1,q);h=i=-1}}else if("#"==o)u(),j=q+1;else if("."==o)u(),k=q;else if(":"==o)u(),h=q;else if("["==o)u(),e=q,r={};else if("("==o)0<=h&&(r={name:c(h+1,q),value:null},t.pseudos.push(r)),i=q;else if(" "==o&&n!=o){u();0<=h&&t.pseudos.push({name:c(h+1,q)});t.loops=t.pseudos.length||t.attrs.length||t.classes.length;t.oquery=t.query=c(p,q);t.otag=t.tag=t.oper?null:t.tag||"*";if(t.tag)t.tag=t.tag.toUpperCase();
if(b.length&&b[b.length-1].oper)t.infixOper=b.pop(),t.query=t.infixOper.query+" "+t.query;b.push(t);t=null}return b},m=function(a,c){return!a?c:!c?a:function(){return a.apply(window,arguments)&&c.apply(window,arguments)}},n=function(a,c){var d=c||[];a&&d.push(a);return d},o=function(a){return 1==a.nodeType},q=function(a,c){return!a?"":"class"==c?a.className||"":"for"==c?a.htmlFor||"":"style"==c?a.style.cssText||"":(d?a.getAttribute(c):a.getAttribute(c,2))||""},p={"*=":function(a,c){return function(d){return 0<=
q(d,a).indexOf(c)}},"^=":function(a,c){return function(d){return 0==q(d,a).indexOf(c)}},"$=":function(a,c){return function(d){var d=" "+q(d,a),b=d.lastIndexOf(c);return-1<b&&b==d.length-c.length}},"~=":function(a,c){var d=" "+c+" ";return function(c){return 0<=(" "+q(c,a)+" ").indexOf(d)}},"|=":function(a,c){var d=c+"-";return function(b){b=q(b,a);return b==c||0==b.indexOf(d)}},"=":function(a,c){return function(d){return q(d,a)==c}}},g="undefined"==typeof h.doc.firstChild.nextElementSibling,v=!g?
"nextElementSibling":"nextSibling",r=!g?"previousElementSibling":"previousSibling",t=g?o:k,u=function(a){for(;a=a[r];)if(t(a))return!1;return!0},s=function(a){for(;a=a[v];)if(t(a))return!1;return!0},y=function(a){var c=a.parentNode,c=7!=c.nodeType?c:c.nextSibling,d=0,b=c.children||c.childNodes,e=a._i||a.getAttribute("_i")||-1,i=c._l||("undefined"!==typeof c.getAttribute?c.getAttribute("_l"):-1);if(!b)return-1;b=b.length;if(i==b&&0<=e&&0<=i)return e;f("ie")&&"undefined"!==typeof c.setAttribute?c.setAttribute("_l",
b):c._l=b;e=-1;for(c=c.firstElementChild||c.firstChild;c;c=c[v])if(t(c))f("ie")?c.setAttribute("_i",++d):c._i=++d,a===c&&(e=d);return e},E=function(a){return!(y(a)%2)},D=function(a){return y(a)%2},x={checked:function(){return function(a){return!!("checked"in a?a.checked:a.selected)}},disabled:function(){return function(a){return a.disabled}},enabled:function(){return function(a){return!a.disabled}},"first-child":function(){return u},"last-child":function(){return s},"only-child":function(){return function(a){return u(a)&&
s(a)}},empty:function(){return function(a){for(var c=a.childNodes,a=a.childNodes.length-1;0<=a;a--){var d=c[a].nodeType;if(1===d||3==d)return!1}return!0}},contains:function(a,c){var d=c.charAt(0);if('"'==d||"'"==d)c=c.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(c)}},not:function(a,c){var d=i(c)[0],b={el:1};if("*"!=d.tag)b.tag=1;if(!d.classes.length)b.classes=1;var e=F(d,b);return function(a){return!e(a)}},"nth-child":function(a,c){var d=parseInt;if("odd"==c)return D;if("even"==c)return E;
if(-1!=c.indexOf("n")){var b=c.split("n",2),e=b[0]?"-"==b[0]?-1:d(b[0]):1,i=b[1]?d(b[1]):0,g=0,h=-1;0<e?0>i?i=i%e&&e+i%e:0<i&&(i>=e&&(g=i-i%e),i%=e):0>e&&(e*=-1,0<i&&(h=i,i%=e));if(0<e)return function(a){a=y(a);return a>=g&&(0>h||a<=h)&&a%e==i};c=i}var k=d(c);return function(a){return y(a)==k}}},O=9>f("ie")||9==f("ie")&&f("quirks")?function(a){var c=a.toLowerCase();"class"==c&&(a="className");return function(b){return d?b.getAttribute(a):b[a]||b[c]}}:function(a){return function(c){return c&&c.getAttribute&&
c.hasAttribute(a)}},F=function(a,c){if(!a)return k;var c=c||{},b=null;"el"in c||(b=m(b,o));"tag"in c||"*"!=a.tag&&(b=m(b,function(c){return c&&(d?c.tagName:c.tagName.toUpperCase())==a.getTag()}));"classes"in c||j(a.classes,function(a,c){var d=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");b=m(b,function(a){return d.test(a.className)});b.count=c});"pseudos"in c||j(a.pseudos,function(a){var c=a.name;x[c]&&(b=m(b,x[c](c,a.value)))});"attrs"in c||j(a.attrs,function(a){var c,d=a.attr;a.type&&p[a.type]?c=p[a.type](d,
a.matchFor):d.length&&(c=O(d));c&&(b=m(b,c))});"id"in c||a.id&&(b=m(b,function(c){return!!c&&c.id==a.id}));b||"default"in c||(b=k);return b},ka=function(a){return function(c,d,b){for(;c=c[v];)if(!g||o(c)){(!b||H(c,b))&&a(c)&&d.push(c);break}return d}},aa=function(a){return function(c,d,b){for(c=c[v];c;){if(t(c)){if(b&&!H(c,b))break;a(c)&&d.push(c)}c=c[v]}return d}},la=function(a){a=a||k;return function(c,d,b){for(var e=0,i=c.children||c.childNodes;c=i[e++];)t(c)&&(!b||H(c,b))&&a(c,e)&&d.push(c);return d}},
ta={},T=function(a){var d=ta[a.query];if(d)return d;var e=a.infixOper,e=e?e.oper:"",i=F(a,{el:1}),g="*"==a.tag,j=h.doc.getElementsByClassName;if(e){j={el:1};if(g)j.tag=1;i=F(a,j);"+"==e?d=ka(i):"~"==e?d=aa(i):">"==e&&(d=la(i))}else if(a.id)i=!a.loops&&g?k:F(a,{el:1,id:1}),d=function(c,d){var e=b.byId(a.id,c.ownerDocument||c);if(e&&i(e)){if(9==c.nodeType)return n(e,d);for(var g=e.parentNode;g&&!(g==c);)g=g.parentNode;if(g)return n(e,d)}};else if(j&&/\{\s*\[native code\]\s*\}/.test(""+j)&&a.classes.length&&
!c)var i=F(a,{el:1,classes:1,id:1}),m=a.classes.join(" "),d=function(a,c,d){for(var c=n(0,c),b,e=0,g=a.getElementsByClassName(m);b=g[e++];)i(b,a)&&H(b,d)&&c.push(b);return c};else!g&&!a.loops?d=function(c,d,b){for(var d=n(0,d),e=0,i=a.getTag(),i=i?c.getElementsByTagName(i):[];c=i[e++];)H(c,b)&&d.push(c);return d}:(i=F(a,{el:1,tag:1,id:1}),d=function(c,d,b){for(var d=n(0,d),e,g=0,h=(e=a.getTag())?c.getElementsByTagName(e):[];e=h[g++];)i(e,c)&&H(e,b)&&d.push(e);return d});return ta[a.query]=d},G={},
ma={},V=function(a){var c=i(l(a));if(1==c.length){var d=T(c[0]);return function(a){if(a=d(a,[]))a.nozip=!0;return a}}return function(a){for(var a=n(a),d,b,e=c.length,i,g,h=0;h<e;h++){g=[];d=c[h];b=a.length-1;if(0<b)i={},g.nozip=!0;b=T(d);for(var k=0;d=a[k];k++)b(d,g,i);if(!g.length)break;a=g}return g}},na=f("ie")?"commentStrip":"nozip",Q=!!h.doc.querySelectorAll,ga=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,W=function(a,c,d,b){return d?(c?c+" ":"")+d+(b?" "+b:""):a},ba=/([^[]*)([^\]]*])?/g,ua=function(a,
c,d){return c.replace(ga,W)+(d||"")},L=function(a,d){a=a.replace(ba,ua);if(Q){var b=ma[a];if(b&&!d)return b}if(b=G[a])return b;var b=a.charAt(0),e=-1==a.indexOf(" ");0<=a.indexOf("#")&&e&&(d=!0);if(Q&&!d&&-1==">~+".indexOf(b)&&(!f("ie")||-1==a.indexOf(":"))&&!(c&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf(":checked")&&-1==a.indexOf("|=")){var i=0<=">~+".indexOf(a.charAt(a.length-1))?a+" *":a;return ma[a]=function(c){try{if(!(9==c.nodeType||e))throw"";var d=c.querySelectorAll(i);
d[na]=!0;return d}catch(b){return L(a,!0)(c)}}}var g=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return G[a]=2>g.length?V(a):function(a){for(var c=0,d=[],b;b=g[c++];)d=d.concat(V(b)(a));return d}},z=0,$=f("ie")?function(a){return d?a.getAttribute("_uid")||a.setAttribute("_uid",++z)||z:a.uniqueID}:function(a){return a._uid||(a._uid=++z)},H=function(a,c){if(!c)return 1;var d=$(a);return!c[d]?c[d]=1:0},A=function(a){if(a&&a.nozip)return a;var c=[];if(!a||!a.length)return c;a[0]&&c.push(a[0]);
if(2>a.length)return c;z++;var b,e;if(f("ie")&&d){var i=z+"";a[0].setAttribute("_zipIdx",i);for(b=1;e=a[b];b++)a[b].getAttribute("_zipIdx")!=i&&c.push(e),e.setAttribute("_zipIdx",i)}else if(f("ie")&&a.commentStrip)try{for(b=1;e=a[b];b++)o(e)&&c.push(e)}catch(g){}else{a[0]&&(a[0]._zipIdx=z);for(b=1;e=a[b];b++)a[b]._zipIdx!=z&&c.push(e),e._zipIdx=z}return c},C=function(a,c){c=c||h.doc;d="div"===(c.ownerDocument||c).createElement("div").tagName;var b=L(a)(c);return b&&b.nozip?b:A(b)};C.filter=function(a,
c,d){for(var g=[],h=i(c),h=1==h.length&&!/[^\w#\.]/.test(c)?F(h[0]):function(a){return-1!=e.indexOf(C(c,b.byId(d)),a)},k=0,j;j=a[k];k++)h(j)&&g.push(j);return g};return C})},"game/handleInput":function(){define(["./state","./createJSON/main","./ui/displayJSON","lodash","frozen/utils"],function(b,f,e,a,h){var l=document.getElementById("xdisp"),j=document.getElementById("ydisp"),c,d,k;return function(i){var m=this;if(i.mouseAction.position)l.innerHTML=i.mouseAction.position.x,j.innerHTML=i.mouseAction.position.y;
if(i.mouseAction.isPressed()&&i.insideCanvas(i.mouseAction.startPosition)&&!c)if("move"===b.mode&&!d&&(d=a.last(a.where(b.entities,function(a){return m.entities[a.id].pointInShape({x:i.mouseAction.startPosition.x/m.box.scale,y:i.mouseAction.startPosition.y/m.box.scale})})))&&(k=this.entities[d.id]),"move"===b.mode&&d)d.x=i.mouseAction.position.x,d.y=i.mouseAction.position.y,d.staticBody?(k.x=d.x/this.box.scale,k.y=d.y/this.box.scale,this.box.removeBody(k.id),this.box.addBody(k)):(this.box.setPosition(k.id,
d.x/this.box.scale,d.y/this.box.scale),this.box.setLinearVelocity(k.id,0,0),this.box.setAngularVelocity(k.id,0)),e();else if("create"===b.mode)c=i.mouseAction.startPosition,b.geometries.push(c);if(!i.mouseAction.isPressed()&&i.mouseAction.endPosition){if("move"===b.mode&&k)this.box.removeBody(k.id),this.box.addBody(k),e();else if(c){c=i.mouseAction.endPosition;if("polygon"===b.tool&&10!==b.geometries.length&&(1>=b.geometries.length||4<h.distance(b.geometries[0],c))){c=null;return}b.geometries.push(c);
b.entities.push(f[b.tool](b.geometries));this.createBodies();b.geometries=[];c=null}i.mouseAction.endPosition=null;k&&(d=k=null)}}})},"game/createJSON/main":function(){define(["./poly","./circle","./rect"],function(b,f,e){return{polygon:b,circle:f,rectangle:e}})},"game/createJSON/poly":function(){define(["../state","../utils/convexHull","frozen/utils"],function(b,f,e){return function(a){if(a&&2<a.length){var a={points:f(a)},h=e.averagePoints(a.points);a.x=h.x;a.y=h.y;a.points=e.translatePoints(a.points,
{x:-a.x,y:-a.y});a.staticBody="static"===b.options;a.sensor=b.sensor;a.type="Polygon";return a}}})},"game/utils/convexHull":function(){define(function(){return function(b){var f,e,a,h,l=[],j=function(a,c){var d;l.push(a);var b=[];d=0;var e=null,h=[],f;for(f in c){var g=c[f],v=(a[0].y-a[1].y)*(g.x-a[0].x)+(a[1].x-a[0].x)*(g.y-a[0].y);0<v&&(h.push(g),v>d&&(d=v,e=g))}return(d=e)?(b=b.concat(j([a[0],d],h)),b=b.concat(j([d,a[1]],h))):[a]},c;for(c in b){var d=b[c];if(d.x>f||!f)a=d,f=d.x;if(d.x<e||!e)h=
d,e=d.x}b=[].concat(j([h,a],b),j([a,h],b));f=[];for(e=0;e<b.length;e++)f.push(b[e][0]);f.reverse();return f}})},"frozen/utils":function(){define("./utils/averagePoints,./utils/degreesToRadians,./utils/radiansToDegrees,./utils/pointInPolygon,./utils/distance,./utils/degreesFromCenter,./utils/radiansFromCenter,./utils/scalePoints,./utils/translatePoints,./utils/insideCanvas".split(","),function(b,f,e,a,h,l,j,c,d,k){return{averagePoints:b,degreesToRadians:f,radiansToDegrees:e,pointInPolygon:a,distance:h,
degreesFromCenter:l,radiansFromCenter:j,scalePoints:c,translatePoints:d,insideCanvas:k}})},"frozen/utils/averagePoints":function(){define(["lodash"],function(b){return function(f){var e={x:0,y:0};b.forEach(f,function(a){e.x+=a.x;e.y+=a.y});e.x/=f.length;e.y/=f.length;return e}})},"frozen/utils/degreesToRadians":function(){define(function(){var b=Math.PI/180;return function(f){return f*b}})},"frozen/utils/radiansToDegrees":function(){define(function(){var b=180/Math.PI;return function(f){return f*
b}})},"frozen/utils/pointInPolygon":function(){define(function(){return function(b,f){if(!b||!f)return!1;for(var e=f.points||f,a=!1,h=e.length-1,l=0;l<e.length;h=l++){var j=e[l].x,c=e[l].y,d=e[h].x,h=e[h].y;c>b.y!==h>b.y&&b.x<(d-j)*(b.y-c)/(h-c)+j&&(a=!a)}return a}})},"frozen/utils/distance":function(){define(function(){return function(b,f){return Math.sqrt((f.x-b.x)*(f.x-b.x)+(f.y-b.y)*(f.y-b.y))}})},"frozen/utils/degreesFromCenter":function(){define(["./radiansToDegrees","./radiansFromCenter"],
function(b,f){return function(e,a){return b(f(e,a))}})},"frozen/utils/radiansFromCenter":function(){define(function(){var b={x:0,y:0};return function(f,e){f=f||b;return f.x===e.x&&f.y===e.y?0:f.x===e.x?f.y>e.y?0:Math.PI:f.y===e.y?f.x>e.x?1.5*Math.PI:Math.PI/2:f.x<e.x&&f.y>e.y?Math.atan((e.x-f.x)/(f.y-e.y)):f.x<e.x&&f.y<e.y?Math.PI/2+Math.atan((e.y-f.y)/(e.x-f.x)):f.x>e.x&&f.y<e.y?Math.PI+Math.atan((f.x-e.x)/(e.y-f.y)):1.5*Math.PI+Math.atan((f.y-e.y)/(f.x-e.x))}})},"frozen/utils/scalePoints":function(){define(["lodash"],
function(b){function f(e,a){return e=Array.isArray(e)?b.map(e,function(b){return f(b,a)}):"object"===typeof a?{x:e.x*a.x,y:e.y*a.y}:{x:e.x*a,y:e.y*a}}return f})},"frozen/utils/translatePoints":function(){define(["lodash"],function(b){function f(e,a){Array.isArray(e)?e=b.map(e,function(b){return f(b,a)}):(e={x:e.x,y:e.y},null!=a.x&&(e.x+=a.x),null!=a.y&&(e.y+=a.y));return e}return f})},"frozen/utils/insideCanvas":function(){define(function(){return function(b,f){return 0>b.x||b.x>f.width||0>b.y||b.y>
f.height?!1:!0}})},"game/createJSON/circle":function(){define(["../state","frozen/utils"],function(b,f){return function(e){if(e&&2===e.length){var a=f.distance(e[0],e[1]),e={x:e[0].x,y:e[0].y,radius:a};e.staticBody="static"===b.options;e.sensor=b.sensor;e.type="Circle";return e}}})},"game/createJSON/rect":function(){define(["../state","../utils/orderRectPts"],function(b,f){return function(e){if(e&&2===e.length)return e=f(e),e={x:(e[1].x-e[0].x)/2+e[0].x,y:(e[1].y-e[0].y)/2+e[0].y,halfWidth:Math.abs((e[1].x-
e[0].x)/2)||0.5,halfHeight:Math.abs((e[1].y-e[0].y)/2)||0.5},e.staticBody="static"===b.options,e.sensor=b.sensor,e.type="Rectangle",e}})},"game/utils/orderRectPts":function(){define(function(){return function(b){var f=[],e;b[1].x<b[0].x?(e=b[1],b=b[0]):(e=b[0],b=b[1]);f.push(e);f.push(b);return f}})},"game/update":function(){define(["lodash"],function(b){return function(){b.forEach(this.entities,function(f){if(!f.staticBody){var e=b.any(f.touching,function(a){return a});f.fillStyle=e?"rgba(0,0,255,0.2)":
f.originalFill}})}})},"game/draw":function(){define(["./draw/shape","./state","lodash"],function(b,f,e){return function(a){f.backImg?a.drawImage(f.backImg,0,0,this.canvas.width,f.backImg.height):a.clearRect(0,0,this.canvas.width,this.canvas.height);e.forEach(this.entities,function(b){(!b.staticBody||f.showStatic)&&b.draw(a)});if(f.geometries.length)b[f.tool](a,this.inputManager,f.geometries)}})},"game/draw/shape":function(){define(["./poly","./circle","./rect"],function(b,f,e){return{polygon:b,circle:f,
rectangle:e}})},"game/draw/poly":function(){define(["lodash","frozen/utils"],function(b,f){return function(e,a,h){e.fillStyle="white";e.strokeStyle="black";b.forEach(h,function(a){e.beginPath();e.arc(a.x,a.y,4,0,2*Math.PI,!0);e.closePath();e.fill();e.stroke()});if(1<h.length&&a.mouseAction.position&&4>=f.distance(h[0],a.mouseAction.position))e.strokeStyle="yellow",e.fillStyle="black",e.lineWidth=4,e.beginPath(),e.arc(h[0].x,h[0].y,4,0,2*Math.PI,!0),e.closePath(),e.fill(),e.stroke(),e.lineWidth=1;
e.strokeStyle="red";e.beginPath();b.forEach(h,function(a,b){0<b&&(e.moveTo(h[b-1].x,h[b-1].y),e.lineTo(a.x,a.y))});a.mouseAction.position&&(e.moveTo(h[h.length-1].x,h[h.length-1].y),e.lineTo(a.mouseAction.position.x,a.mouseAction.position.y));e.stroke();e.closePath()}})},"game/draw/circle":function(){define(["frozen/utils"],function(b){return function(f,e,a){e=b.distance(a[0],e.mouseAction.position);f.strokeStyle="red";f.beginPath();f.arc(a[0].x,a[0].y,e,0,2*Math.PI,!0);f.closePath();f.stroke()}})},
"game/draw/rect":function(){define(["../utils/orderRectPts"],function(b){return function(f,e,a){e=b([a[0],e.mouseAction.position]);f.strokeStyle="red";f.strokeRect(e[0].x,e[0].y,e[1].x-e[0].x,e[1].y-e[0].y)}})},"game/createBodies":function(){define("./state,./ui/getGravity,./ui/displayJSON,./ui/toggleUndo,lodash,put,frozen/box2d/entities,frozen/box2d/joints,frozen/box2d/Box".split(","),function(b,f,e,a,h,l,j,c){var d=0,k;return function(){k||(k=document.getElementById("msg"));var i=this,m=!1,n=f();
i.box.setGravity(n);i.removeBodies(h.toArray(i.entities));i.removeJoints(h.toArray(i.joints));(n=h(b.entities).map(function(a){a=parseInt(a.id,10);return"undefined"===typeof a||null===a||isNaN(a)?-1:a}).max().value())&&(d=n+1);h.forEach(b.entities,function(a){if(!a.staticBody&&!a.sensor)a.fillStyle=a.fillStyle||"rgba(0,255,0,0.4)";if(a.sensor)a.fillStyle=a.fillStyle||"rgba(255,0,0,0.2)";if("undefined"===typeof a.id||null===a.id)a.id=d,d++;if(i.entities[a.id])m=!0;else{var c=j[a.type];if(c)a=new c(h.cloneDeep(a)),
a.originalFill=a.fillStyle,a.touching={},i.addBody(a)}});h.forEach(b.joints,function(a){var d=c[a.type];d&&(a=new d(h.cloneDeep(a)),i.addJoint(a))});m?l(k,".error","Duplicate IDs found, please double check your IDs"):l(k,"!error",{textContent:""});e();a()}})},"game/ui/getGravity":function(){define(["dojo/dom","dojo/domReady!"],function(b){var f=b.byId("gravityX"),e=b.byId("gravityY");return function(){return{x:parseFloat(f.value,10),y:parseFloat(e.value,10)}}})},"game/ui/toggleUndo":function(){define(["../state",
"dojo/dom"],function(b,f){var e=f.byId("undoBtn");return function(){e.disabled=b.entities.length?!1:!0}})},"frozen/box2d/entities":function(){define(["./entities/Circle","./entities/MultiPolygon","./entities/Polygon","./entities/Rectangle"],function(){for(var b=Array.prototype.slice.call(arguments),f={},e=0;e<b.length;e++){var a=b[e],h=a.prototype.declaredClass.replace("frozen/box2d/entities/","");f[h]=a}return f})},"frozen/box2d/entities/Circle":function(){define(["dcl","./Entity","../../utils/distance"],
function(b,f,e){return b(f,{declaredClass:"frozen/box2d/entities/Circle",radius:1,draw:b.superCall(function(a){return function(b,e){var e=e||this.scale||1,j=b.lineWidth;b.lineWidth=this.lineWidth;b.fillStyle=this.fillStyle;b.strokeStyle=this.strokeStyle;b.beginPath();b.arc(this.x*e,this.y*e,this.radius*e,0,2*Math.PI,!0);b.closePath();b.fill();b.stroke();this.staticBody||(b.save(),b.translate(this.x*e,this.y*e),b.rotate(this.angle),b.translate(-this.x*e,-this.y*e),b.beginPath(),b.moveTo(this.x*e,this.y*
e),b.lineTo(this.x*e,this.y*e-this.radius*e),b.closePath(),b.stroke(),b.restore());b.lineWidth=j;a.apply(this,[b,e])}}),scaleShape:b.superCall(function(a){return function(b){this.radius*=b;a.apply(this,[b])}}),pointInShape:function(a){return e(a,this)<=this.radius}})})},"dcl/dcl":function(){(function(b){"undefined"!=typeof define?define(["./mini"],b):"undefined"!=typeof module?module.exports=b(require("./mini")):dcl=b(dcl)})(function(b){function f(){}function e(a,b,c){var d=a||f,e=b||f,i=c||f,h=function(){var a;
d.apply(this,arguments);try{a=i.apply(this,arguments)}catch(c){a=c}e.call(this,arguments,a);if(a instanceof Error)throw a;return a};h.advices={b:a,a:b,f:c};return h}function a(a){return function(e,c){var d=e._m,h;d&&((h=+d.w[c]||0)&&h!=a&&b._e("set chaining",c,e,a,h),d.w[c]=a)}}var h=b(b.Super,{constructor:function(){this.b=this.f.before;this.a=this.f.after;this.f=this.f.around}});b.mix(b,{Advice:h,advise:function(a){return new h(a)},before:function(a){return new h({before:a})},after:function(a){return new h({after:a})},
around:b.superCall,chainBefore:a(1),chainAfter:a(2),isInstanceOf:function(a,b){if(a instanceof b)return!0;var c=a.constructor._m,d;if(c)for(c=c.b,d=c.length-1;0<=d;--d)if(c[d]===b)return!0;return!1},_sb:function(a,h,c,d){var d=d[c]=b._ec(h,c,"f"),k=b._ec(h,c,"b").reverse(),h=b._ec(h,c,"a"),d=a?b._st(d,1==a?function(a){return b._sc(a.reverse())}:b._sc,c):b._ss(d,c);return!k.length&&!h.length?d||function(){}:e(b._sc(k),b._sc(h),d)}});return b})},"dcl/mini":function(){(function(b){"undefined"!=typeof define?
define([],b):"undefined"!=typeof module?module.exports=b():dcl=b()})(function(){function b(c,i){var k=[0],g,j,m,f,n,s,y,E,D=0,x;if(c)if(c instanceof Array){f={};y=c.slice(0).reverse();for(E=y.length-1;0<=E;--E)if(j=y[E],j._u=j._u||a++,g=j._m){for(s=g.b,D=s.length-1;0<D;--D)x=s[D]._u,f[x]=(f[x]||0)+1;y[E]=s.slice(0)}else y[E]=[j];n={};a:for(;y.length;){for(E=0;E<y.length;++E)if(s=y[E],j=s[0],x=j._u,!f[x]){n[x]||(k.push(j),n[x]=1);s.shift();s.length?--f[s[0]._u]:y.splice(E,1);continue a}b._e("cycle",
i,y)}c=c[0];D=k.length-((f=c._m)&&c===k[k.length-(D=f.b.length)]?D:1)-1}else c._u=c._u||a++,k=k.concat((f=c._m)?f.b:c);g=c?b.delegate(c[l]):{};for(s=c&&(f=c._m)?b.delegate(f.w):{constructor:2};0<D;--D)if(j=k[D],f=j._m,d(g,f&&f.h||j[l]),f)for(x in y=f.w)s[x]=(+s[x]||0)|y[x];for(x in i)e(f=i[x])?s[x]=+s[x]||0:g[x]=f;n={b:k,h:i,w:s,c:{}};k[0]={_m:n,prototype:g};j=g;f=n.w;s=n.b;y=n.c;for(m in f)j[m]=b._sb(f[m],s,m,y);m=g[h];m._m=n;m[l]=g;k[0]=m;return b._p(m)}function f(a){this.f=a}function e(a){return a instanceof
f}var a=0,h="constructor",l="prototype",j=function(){},c={},d,k,i,m,n;(d=function(a,c){for(var d in c)a[d]=c[d]})(b,{mix:d,delegate:function(a){j[l]=a;a=new j;j[l]=null;return a},Super:f,superCall:function(a){return new f(a)},_p:function(a){return a},_e:function(a){throw Error("dcl: "+a);},_f:function(a,c){var d=a.f(c);d.ctr=a.ctr;return d},_ec:k=function(a,d,b){for(var i=a.length-1,h=[],k,j,f="f"==b;k=a[i];--i)if((j=k._m)?(j=j.h).hasOwnProperty(d)&&(e(j=j[d])?f?j.f:j=j[b]:f):f&&(j=k[l][d])&&j!==
c[d])j.ctr=k,h.push(j);return h},_sc:m=function(a){var c=a.length,d;return!c?0:1==c?(d=a[0],function(){d.apply(this,arguments)}):function(){for(var d=0;d<c;++d)a[d].apply(this,arguments)}},_ss:i=function(a,d){for(var i=0,g,k=c[d];g=a[i];++i)k=e(g)?a[i]=b._f(g,k,d):g;return d!=h?k:function(){k.apply(this,arguments)}},_st:n=function(a,c,d){for(var i=0,k,j,f=0;k=a[i];++i)e(k)&&(j=i-f,a[i]=b._f(k,!j?0:1==j?a[f]:c(a.slice(f,i)),d),f=i);j=i-f;return!j?0:1==j&&d!=h?a[f]:c(f?a.slice(f):a)},_sb:function(a,
c,d,b){c=b[d]=k(c,d,"f");return(a?n(c,m,d):i(c,d))||function(){}}});return b})},"frozen/box2d/entities/Entity":function(){define(["dcl","dcl/bases/Mixer","lodash"],function(b,f,e){return b(f,{declaredClass:"frozen/box2d/entities/Entity",id:0,x:0,y:0,scale:null,angle:0,center:null,restitution:0.3,density:1,friction:0.9,linearDamping:0,linearVelocity:null,angularVelocity:0,angularDamping:0,staticBody:!1,fillStyle:"rgba(128,128,128,0.5)",strokeStyle:"#000",lineWidth:1,maskBits:null,categoryBits:null,
groupIndex:null,sensor:!1,update:function(a){e.assign(this,a)},draw:function(a,b){var b=b||this.scale||1,e=a.lineWidth;a.lineWidth=this.lineWidth;a.fillStyle=this.strokeStyle;a.beginPath();a.arc(this.x*b,this.y*b,4,0,2*Math.PI,!0);a.closePath();a.fill();if(this.center)a.fillStyle="yellow",a.beginPath(),a.arc(this.center.x*b,this.center.y*b,2,0,2*Math.PI,!0),a.closePath(),a.fill();a.lineWidth=e},scaleShape:function(a){this.x*=a;this.y*=a;this.alreadyScaled=!0}})})},"dcl/bases/Mixer":function(){(function(b){"undefined"!=
typeof define?define(["../mini"],b):"undefined"!=typeof module?module.exports=b(require("../mini")):dclBasesMixer=b(dcl)})(function(b){return b(null,{declaredClass:"dcl/bases/Mixer",constructor:function(f){b.mix(this,f)}})})},"frozen/box2d/entities/MultiPolygon":function(){define(["dcl","./Entity","../../utils/scalePoints","../../utils/pointInPolygon","../../utils/translatePoints"],function(b,f,e,a,h){return b(f,{declaredClass:"frozen/box2d/entities/MultiPolygon",polys:[],draw:b.superCall(function(a){return function(b,
c){var c=c||this.scale||1,d=b.lineWidth;b.lineWidth=this.lineWidth;b.save();b.translate(this.x*c,this.y*c);b.rotate(this.angle);b.translate(-this.x*c,-this.y*c);b.fillStyle=this.fillStyle;b.strokeStyle=this.strokeStyle;for(var e=0;e<this.polys.length;e++){b.beginPath();b.moveTo((this.x+this.polys[e][0].x)*c,(this.y+this.polys[e][0].y)*c);for(var i=1;i<this.polys[e].length;i++)b.lineTo((this.polys[e][i].x+this.x)*c,(this.polys[e][i].y+this.y)*c);b.lineTo((this.x+this.polys[e][0].x)*c,(this.y+this.polys[e][0].y)*
c);b.closePath();b.fill();b.stroke()}b.restore();b.lineWidth=d;a.apply(this,[b,c])}}),scaleShape:b.superCall(function(a){return function(b){this.polys=e(this.polys,b);a.apply(this,[b])}}),pointInShape:function(b){for(var e=0;e<this.polys.length;e++)if(a(b,h(this.polys[e],this)))return!0;return!1}})})},"frozen/box2d/entities/Polygon":function(){define(["dcl","./Entity","../../utils/scalePoints","../../utils/pointInPolygon","../../utils/translatePoints"],function(b,f,e,a,h){return b(f,{declaredClass:"frozen/box2d/entities/Polygon",
points:[],draw:b.superCall(function(a){return function(b,c){var c=c||this.scale||1,d=b.lineWidth;b.lineWidth=this.lineWidth;b.save();b.translate(this.x*c,this.y*c);b.rotate(this.angle);b.translate(-this.x*c,-this.y*c);b.fillStyle=this.fillStyle;b.strokeStyle=this.strokeStyle;b.beginPath();b.moveTo((this.x+this.points[0].x)*c,(this.y+this.points[0].y)*c);for(var e=1;e<this.points.length;e++)b.lineTo((this.points[e].x+this.x)*c,(this.points[e].y+this.y)*c);b.lineTo((this.x+this.points[0].x)*c,(this.y+
this.points[0].y)*c);b.closePath();b.fill();b.stroke();b.restore();b.lineWidth=d;a.apply(this,[b,c])}}),scaleShape:b.superCall(function(a){return function(b){this.points=e(this.points,b);a.apply(this,[b])}}),pointInShape:function(b){return a(b,h(this.points,this))}})})},"frozen/box2d/entities/Rectangle":function(){define(["dcl","./Entity"],function(b,f){return b(f,{declaredClass:"frozen/box2d/entities/Rectangle",halfWidth:1,halfHeight:1,draw:b.superCall(function(b){return function(a,h){var h=h||this.scale||
1,f=a.lineWidth;a.lineWidth=this.lineWidth;a.save();a.translate(this.x*h,this.y*h);a.rotate(this.angle);a.translate(-this.x*h,-this.y*h);a.fillStyle=this.fillStyle;a.strokeStyle=this.strokeStyle;a.fillRect((this.x-this.halfWidth)*h,(this.y-this.halfHeight)*h,2*this.halfWidth*h,2*this.halfHeight*h);a.strokeRect((this.x-this.halfWidth)*h,(this.y-this.halfHeight)*h,2*this.halfWidth*h,2*this.halfHeight*h);a.restore();a.lineWidth=f;b.apply(this,[a,h])}}),scaleShape:b.superCall(function(b){return function(a){this.halfHeight*=
a;this.halfWidth*=a;b.apply(this,[a])}}),pointInShape:function(b){return b.x>=this.x-this.halfWidth&&b.x<=this.x+this.halfWidth&&b.y>=this.y-this.halfHeight&&b.y<=this.y+this.halfHeight}})})},"frozen/box2d/joints":function(){define(["./joints/Distance","./joints/Prismatic","./joints/Revolute"],function(){for(var b=Array.prototype.slice.call(arguments),f={},e=0;e<b.length;e++){var a=b[e],h=a.prototype.declaredClass.replace("frozen/box2d/joints/","");f[h]=a}return f})},"frozen/box2d/joints/Distance":function(){define(["dcl",
"lodash","./Joint"],function(b,f,e){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.Joints.b2DistanceJointDef;return b(e,{declaredClass:"frozen/box2d/joints/Distance",bodyPoint2:null,scaleJointLocation:b.superCall(function(a){return function(b){if(b&&this.bodyPoint2)this.bodyPoint2.x*=b,this.bodyPoint2.y*=b,this.alreadyScaled=!0;a.apply(this,[b])}}),createB2Joint:function(b){if(b&&b.bodiesMap&&b.b2World&&b.jointsMap&&!b.jointsMap[this.id]){var e=b.bodiesMap[this.bodyId1],c=b.bodiesMap[this.bodyId2];
if(e&&c){var d,k;this.bodyPoint1&&(d=new a(this.bodyPoint1.x,this.bodyPoint1.y));this.bodyPoint2&&(k=new a(this.bodyPoint2.x,this.bodyPoint2.y));d=d||e.GetWorldCenter();k=k||c.GetWorldCenter();var i=new h;i.Initialize(e,c,d,k);this.jointAttributes&&f.assign(i,this.jointAttributes);return b.b2World.CreateJoint(i)}}}})})},"frozen/box2d/joints/Joint":function(){define(["dcl","dcl/bases/Mixer"],function(b,f){return b(f,{declaredClass:"frozen/box2d/joints/Joint",bodyId1:null,bodyId2:null,bodyPoint1:null,
jointAttributes:null,scaleJointLocation:function(b){if(b&&this.bodyPoint1)this.bodyPoint1.x*=b,this.bodyPoint1.y*=b,this.alreadyScaled=!0}})})},"frozen/box2d/joints/Prismatic":function(){define(["dcl","lodash","./Joint"],function(b,f,e){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.Joints.b2PrismaticJointDef;return b(e,{declaredClass:"frozen/box2d/joints/Prismatic",axisScale:null,createB2Joint:function(b){if(b&&b.bodiesMap&&b.b2World&&b.jointsMap&&!b.jointsMap[this.id]){var e=b.bodiesMap[this.bodyId1],
c=b.bodiesMap[this.bodyId2];if(e&&c){var d;this.bodyPoint1&&(d=new a(this.bodyPoint1.x,this.bodyPoint1.y));d=d||e.GetWorldCenter();var k=new h,i;i=this.axisScale?new a(this.axisScale.x,this.axisScale.y):new a(1,0);k.Initialize(e,c,d,i);this.jointAttributes&&f.assign(k,this.jointAttributes);return b.b2World.CreateJoint(k)}}}})})},"frozen/box2d/joints/Revolute":function(){define(["dcl","lodash","./Joint"],function(b,f,e){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.Joints.b2RevoluteJointDef;return b(e,
{declaredClass:"frozen/box2d/joints/Revolute",createB2Joint:function(b){if(b&&b.bodiesMap&&b.b2World&&b.jointsMap&&!b.jointsMap[this.id]){var e=b.bodiesMap[this.bodyId1],c=b.bodiesMap[this.bodyId2];if(e&&c){var d;this.bodyPoint1&&(d=new a(this.bodyPoint1.x,this.bodyPoint1.y));d=d||e.GetWorldCenter();var k=new h;k.Initialize(e,c,d,void 0);this.jointAttributes&&f.assign(k,this.jointAttributes);return b.b2World.CreateJoint(k)}}}})})},"frozen/box2d/Box":function(){define(["dcl","dcl/bases/Mixer","./listeners/Contact"],
function(b,f,e){var a=Box2D.Common.Math.b2Vec2,h=Box2D.Dynamics.b2BodyDef,l=Box2D.Dynamics.b2Body,j=Box2D.Dynamics.b2FixtureDef,c=Box2D.Dynamics.b2World,d=Box2D.Collision.Shapes.b2PolygonShape,k=Box2D.Collision.Shapes.b2CircleShape;return b(f,{intervalRate:60,adaptive:!1,bodiesMap:null,fixturesMap:null,jointsMap:null,b2World:null,gravityX:0,gravityY:9.8,allowSleep:!0,resolveCollisions:!1,contactListener:null,collisions:null,scale:30,constructor:function(d){if(d&&d.intervalRate)this.intervalRate=parseInt(d.intervalRate,
10);this.bodiesMap={};this.fixturesMap={};this.jointsMap={};this.b2World=new c(new a(this.gravityX,this.gravityY),this.allowSleep);if(this.resolveCollisions)this.contactListener=new e;this.contactListener&&this.addContactListener(this.contactListener)},update:function(a){this.contactListener&&this.contactListener.reset&&this.contactListener.reset();var c=Date.now();a?this.b2World.Step(a/1E3,10,10):this.b2World.Step(this.adaptive?(c-this.lastTimestamp)/1E3:1/this.intervalRate,10,10);this.b2World.ClearForces();
return Date.now()-c},getState:function(){for(var a={},c=this.b2World.GetBodyList();c;c=c.m_next)if(c.IsActive()&&"undefined"!==typeof c.GetUserData()&&null!==c.GetUserData()&&(a[c.GetUserData()]={x:c.GetPosition().x,y:c.GetPosition().y,angle:c.GetAngle(),center:{x:c.GetWorldCenter().x,y:c.GetWorldCenter().y},linearVelocity:c.m_linearVelocity,angularVelocity:c.m_angularVelocity},this.contactListener&&this.contactListener.collisions))a[c.GetUserData()].collisions=this.contactListener.collisions[c.GetUserData()]||
null;return a},updateExternalState:function(a){var c=this.getState(),d;for(d in c){var b=a[d];b&&!b.staticBody&&b.update(c[d])}},setBodies:function(a){for(var c in a)this.addBody(a[c]);this.ready=!0},addBody:function(c){if(!c.alreadyScaled)c.scaleShape(1/this.scale),c.scale=this.scale;var b=new h,e=new j,f,q,p,g;e.restitution=c.restitution;e.density=c.density;e.friction=c.friction;e.isSensor=c.sensor||!1;if(null!=c.maskBits)e.filter.maskBits=c.maskBits;if(null!=c.categoryBits)e.filter.categoryBits=
c.categoryBits;if(null!=c.groupIndex)e.filter.groupIndex=c.groupIndex;b.type=c.staticBody?l.b2_staticBody:l.b2_dynamicBody;b.position.x=c.x;b.position.y=c.y;b.userData=c.id;b.angle=c.angle;b.linearDamping=c.linearDamping;b.angularDamping=c.angularDamping;var v=this.b2World.CreateBody(b);if(c.radius)e.shape=new k(c.radius),v.CreateFixture(e);else if(c.points){q=[];for(b=0;b<c.points.length;b++)p=new a,p.Set(c.points[b].x,c.points[b].y),q[b]=p;e.shape=new d;e.shape.SetAsArray(q,q.length);v.CreateFixture(e)}else if(c.polys)for(f=
0;f<c.polys.length;f++){q=c.polys[f];g=[];for(b=0;b<q.length;b++)p=new a,p.Set(q[b].x,q[b].y),g[b]=p;e.shape=new d;e.shape.SetAsArray(g,g.length);v.CreateFixture(e)}else e.shape=new d,e.shape.SetAsBox(c.halfWidth,c.halfHeight),v.CreateFixture(e);this.bodiesMap[c.id]=v},setPosition:function(c,b,d){this.bodiesMap[c].SetPosition(new a(b,d))},setAngle:function(a,c){this.bodiesMap[a].SetAngle(c)},setLinearVelocity:function(c,b,d){this.bodiesMap[c].SetLinearVelocity(new a(b,d))},setAngularVelocity:function(a,
c){this.bodiesMap[a].SetAngularVelocity(c)},applyImpulseDegrees:function(c,b,d){c=this.bodiesMap[c];c.ApplyImpulse(new a(Math.sin(b*(Math.PI/180))*d,-1*Math.cos(b*(Math.PI/180))*d),c.GetWorldCenter())},applyForceDegrees:function(c,b,d){c=this.bodiesMap[c];c.ApplyForce(new a(Math.sin(b*(Math.PI/180))*d,-1*Math.cos(b*(Math.PI/180))*d),c.GetWorldCenter())},applyImpulse:function(c,b,d){c=this.bodiesMap[c];c.ApplyImpulse(new a(Math.sin(b)*d,-1*Math.cos(b)*d),c.GetWorldCenter())},applyForce:function(c,
b,d){c=this.bodiesMap[c];c.ApplyForce(new a(Math.sin(b)*d,-1*Math.cos(b)*d),c.GetWorldCenter())},applyTorque:function(a,c){this.bodiesMap[a].ApplyTorque(c)},setGravity:function(c){this.b2World.SetGravity(new a(c.x,c.y))},removeBody:function(a){this.bodiesMap[a]&&(this.fixturesMap[a]&&this.bodiesMap[a].DestroyFixture(this.fixturesMap[a]),this.b2World.DestroyBody(this.bodiesMap[a]),delete this.bodiesMap[a])},wakeUpBody:function(a){this.bodiesMap[a]&&this.bodiesMap[a].SetAwake(!0)},addContactListener:function(a){var c=
new Box2D.Dynamics.b2ContactListener;if(a.beginContact)c.BeginContact=function(c){a.beginContact(c.m_fixtureA.m_body.m_userData,c.m_fixtureB.m_body.m_userData,c)};if(a.endContact)c.EndContact=function(c){a.endContact(c.m_fixtureA.m_body.m_userData,c.m_fixtureB.m_body.m_userData,c)};if(a.preSolve)c.PreSolve=function(c,b){a.preSolve(c.m_fixtureA.m_body.m_userData,c.m_fixtureB.m_body.m_userData,b,c)};if(a.postSolve)c.PostSolve=function(c,b){a.postSolve(c.m_fixtureA.m_body.m_userData,c.m_fixtureB.m_body.m_userData,
b,c)};this.b2World.SetContactListener(c)},removeJoint:function(a){this.jointsMap[a]&&(this.b2World.DestroyJoint(this.jointsMap[a]),delete this.jointsMap[a])},addJoint:function(a){if(a&&a.id&&!this.jointsMap[a.id]){if(!a.alreadyScaled&&a.scaleJointLocation)a.scaleJointLocation(1/this.scale),a.scale=this.scale;var c=a.createB2Joint(this);c&&(this.jointsMap[a.id]=c)}}})})},"frozen/box2d/listeners/Contact":function(){define(["dcl","dcl/bases/Mixer"],function(b,f){return b(f,{declaredClass:"frozen/box2d/listeners/Contact",
constructor:function(){this.collisions=this.collisions||{}},collisions:null,reset:function(){this.collisions={}},postSolve:function(b,a,h){this.collisions[b]=this.collisions[b]||[];this.collisions[b].push({id:a,impulse:h.normalImpulses[0]});this.collisions[a]=this.collisions[a]||[];this.collisions[a].push({id:b,impulse:h.normalImpulses[0]})}})})},"frozen/box2d/BoxGame":function(){define(["../GameCore","./Box","lodash","dcl"],function(b,f,e,a){return a(b,{box:null,boxUpdating:!0,entities:null,joints:null,
constructor:function(){if(!this.box)this.box=new f;if(!this.entities)this.entities={};if(!this.joints)this.joints={}},beforeUpdate:function(a){this.boxUpdating&&(this.box.update(a),this.box.updateExternalState(this.entities))},addBody:function(a){this.entities[a.id]=a;this.box.addBody(a)},addBodies:function(){var a=e.flatten(arguments,!0),b=this;e.forEach(a,function(a){b.addBody(a)})},removeBody:function(a){this.box.removeBody(a.id);delete this.entities[a.id]},removeBodies:function(){var a=e.flatten(arguments,
!0),b=this;e.forEach(a,function(a){b.removeBody(a)})},addJoint:function(a){this.joints[a.id]=a;this.box.addJoint(a)},addJoints:function(){var a=e.flatten(arguments,!0),b=this;e.forEach(a,function(a){b.addJoint(a)})},removeJoint:function(a){this.box.removeJoint(a.id);delete this.joints[a.id]},removeJoints:function(){var a=e.flatten(arguments,!0),b=this;e.forEach(a,function(a){b.removeJoint(a)})}})})},"frozen/GameCore":function(){define("dcl,dcl/advise,dcl/bases/Mixer,lodash,./InputManager,./ResourceManager,./shims/RAF".split(","),
function(b,f,e,a,h,l){return b(e,{statics:{FONT_SIZE:24},isRunning:!1,canvasId:null,maxStep:40,contextType:"2d",height:0,width:0,resourceManager:null,inputManager:null,loadingForeground:"#00F",loadingBackground:"#FFF",gameAreaId:null,canvasPercentage:0,requestId:null,constructor:function(){var a=this.preUpdate||this.beforeUpdate;a&&f.before(this,"update",a)},setHeight:function(a){this.height=a;this.canvas.height=a},setWidth:function(a){this.width=a;this.canvas.width=a},stop:function(){window.cancelAnimationFrame(this.requestId);
this.requestId=null;this.isRunning=!1},run:function(){this.isRunning||(this.init(),this.loadResources(this.resourceManager),this.initInput(this.inputManager),this.launchLoop())},loadResources:function(){},init:function(){if(!this.canvas)this.canvas=document.getElementById(this.canvasId);if(this.canvas){if(!this.context)this.context=this.canvas.getContext(this.contextType);if(this.context){this.setHeight(this.height||this.canvas.height);this.setWidth(this.width||this.canvas.width);if(!this.inputManager)this.inputManager=
this.gameAreaId&&this.canvasPercentage?new h({canvas:this.canvas,gameArea:document.getElementById(this.gameAreaId),canvasPercentage:this.canvasPercentage}):new h({canvas:this.canvas});this.inputManager.resize();if(!this.resourceManager)this.resourceManager=new l;this.loadResources(this.resourceManager);this.isRunning=!0}else alert("Sorry, your browser does not support a "+this.contextType+" drawing surface on canvas.  I recommend any browser but Internet Explorer")}else alert("Sorry, your browser does not support canvas.  I recommend any browser but Internet Explorer")},
initInput:function(){},handleInput:function(){},gameLoop:function(){this.currTime=(new Date).getTime();this.elapsedTime=Math.min(this.currTime-this.prevTime,this.maxStep);this.prevTime=this.currTime;this.resourceManager&&!this.resourceManager.resourcesReady()?(this.updateLoadingScreen(this.elapsedTime),this.drawLoadingScreen(this.context)):(this.handleInput(this.inputManager,this.elapsedTime),this.paused||this.update(this.elapsedTime),this.context.save(),this.draw(this.context),this.context.restore())},
launchLoop:function(){this.elapsedTime=0;var b=Date.now();this.prevTime=this.currTime=b;this.loopRunner=a.bind(this.loopRunner,this);this.requestId=window.requestAnimationFrame(this.loopRunner)},loopRunner:function(){this.gameLoop();this.requestId=window.requestAnimationFrame(this.loopRunner)},update:function(){},updateLoadingScreen:function(){},draw:function(a){if("2d"===this.contextType)a.font="14px sans-serif",a.fillText("This game does not have its own draw function!",10,50)},drawLoadingScreen:function(a){if(this.resourceManager&&
"2d"===this.contextType)a.fillStyle=this.loadingBackground,a.fillRect(0,0,this.width,this.height),a.fillStyle=this.loadingForeground,a.strokeStyle=this.loadingForeground,a.font="bold "+Math.floor(this.height/12)+"px sans-serif",a.fillText("Loading... "+this.resourceManager.getPercentComplete()+"%",0.1*this.width,0.55*this.height),a.strokeRect(0.1*this.width,0.7*this.height,0.8*this.width,0.1*this.height),a.fillRect(0.1*this.width,0.7*this.height,0.8*this.width*this.resourceManager.getPercentComplete()/
100,0.1*this.height),a.lineWidth=4}})})},"dcl/advise":function(){(function(b){"undefined"!=typeof define?define([],b):"undefined"!=typeof module?module.exports=b():advise=b()})(function(){function b(a,b){this.nb=this.pb=this.na=this.pa=this.nf=this.pf=this;this.i=a;this.n=b}function f(a){var b=function(){var b,c,d=arguments;for(b=a.pb;b!==a;b=b.pb)b.b.apply(this,d);try{a.pf!==a&&(c=a.pf.f.apply(this,d))}catch(e){c=e}for(b=a.na;b!==a;b=b.na)b.a.call(this,d,c);if(c instanceof Error)throw c;return c};
b.adviceNode=a;return b}function e(a,e,j){var c=a[e],d;c&&c.adviceNode&&c.adviceNode instanceof b?d=c.adviceNode:(d=new b(a,e),c&&c.advices?(c=c.advices,d.a(c.b,c.a,c.f)):d.a(0,0,c),a[e]=f(d));"function"==typeof j&&(j=j(e,a));return d.a(j.before,j.after,0,j.around)}var a=b.prototype={a:function(a,f,j,c){var d=new b(this.i,this.n);d.p=this;d.b=a;this._a("b",d);d.a=f;this._a("a",d);d.f=j;this._a("f",d,c);if(d.o=c)d.f=e._f(c,d.pf.f,this);return d},_a:function(a,b,e){if(b[a]||e)e="n"+a,a="p"+a,(b[a]=
this[a])[e]=(b[e]=this)[a]=b},r:function(a){this._r("b",a);this._r("a",a);this._r("f",a)},_r:function(a,b){var e="n"+a,c="p"+a;b[e][c]=b[c];b[c][e]=b[e]},destroy:function(){var a=this.pf.f,b=this.nf,f=this.p;this.r(this);if(b!==this)for(;b!==f;a=b.f,b=b.nf)if(b.o)b.f=e._f(b.o,a,this);this.i=0}};a.unadvise=a.destroy;e.before=function(a,b,f){return e(a,b,{before:f})};e.after=function(a,b,f){return e(a,b,{after:f})};e.around=function(a,b,f){return e(a,b,{around:f})};e.Node=b;e._f=function(a,b){return a(b)};
return e})},"frozen/InputManager":function(){define("./GameAction,./MouseAction,./TouchAction,./utils/insideCanvas,dcl,dcl/bases/Mixer,dcl/mixins/Cleanup,dojo/has,dojo/on,lodash,hammer,dojo/domReady!".split(","),function(b,f,e,a,h,l,j,c,d,k,i){return h([l,j],{keyActions:null,mouseAction:null,touchAction:null,canvas:null,handleMouse:!0,handleTouch:!0,handleKeys:!0,gameArea:null,canvasPercentage:null,emulateMouse:!0,hammer:null,on:function(a,c){var b=this.hammer,d=this.removeCleanup;b.on(a,c);var e=
this.pushCleanup([a,c],function(a){b.off.apply(b,a)});return{remove:function(){d(e);e()}}},constructor:function(){function a(c){c.remove()}k.bindAll(this);if(!this.hammer)this.hammer=i(document,{drag_max_touches:0,hold:!1});if(!this.keyActions)this.keyActions={};this.handleKeys&&(this.pushCleanup(d(document,"keydown",this.keydown),a),this.pushCleanup(d(document,"keyup",this.keyup),a));if(this.emulateMouse){if(this.on("touch",this.mousedown),this.on("drag",this.mousemove),this.on("release",this.mouseup),
!this.mouseAction)this.mouseAction=new f}else if(this.on("touch",this.touchstart),this.on("drag",this.touchmove),this.on("release",this.touchend),!this.touchAction)this.touchAction=new e;this.gameArea&&this.canvasPercentage&&(this.pushCleanup(d(window,"resize",this.resize),a),this.pushCleanup(d(window,"orientationchange",this.resize),a))},insideCanvas:function(c){return a(c,this.canvas)},mapToKey:function(a,c){this.keyActions[c]=a},addKeyAction:function(a,c){var d=new b;if(c)d.behavior=d.statics.DETECT_INITAL_PRESS_ONLY;
this.mapToKey(d,a);return d},mouseUp:function(a){this.mouseup(a)},mouseup:function(a){this.mouseAction.release(this.normalizePoint(a.gesture.touches[0]))},mouseDown:function(a){this.mousedown(a)},mousedown:function(a){this.mouseAction.release(null);a=this.normalizePoint(a.gesture.touches[0]);this.mouseAction.insideCanvas=this.insideCanvas(a);this.mouseAction.press(a)},mouseMove:function(a){this.mousemove(a)},mousemove:function(a){this.mouseAction.position=this.normalizePoint(a.gesture?a.gesture.touches[0]:
a)},touchStart:function(a){this.touchstart(a)},touchstart:function(a){this.touchAction.release(null);a=k.map(a.gesture.touches,this.normalizePoint);this.touchAction.insideCanvas=k.some(a,this.insideCanvas);this.touchAction.press(a)},touchEnd:function(a){this.touchend(a)},touchend:function(a){this.touchAction.release(k.map(a.gesture.touches,this.normalizePoint))},touchMove:function(a){this.touchmove(a)},touchmove:function(a){this.touchAction.positions=k.map(a.gesture.touches,this.normalizePoint);this.touchAction.startPositions&&
a.preventDefault()},getKeyAction:function(a){return this.keyActions?this.keyActions[a.keyCode]||this.keyActions[String.fromCharCode(a.keyCode)]:null},keyPressed:function(a){this.keydown(a)},keyDown:function(a){this.keydown(a)},keydown:function(a){(a=this.getKeyAction(a))&&!a.isPressed()&&a.press()},keyReleased:function(a){this.keyup(a)},keyup:function(a){(a=this.getKeyAction(a))&&a.release()},getMouseLoc:function(a){return this.normalizePoint(a)},normalizePoint:function(a){var c,b;b=this.canvas.getBoundingClientRect();
c=b.left;b=b.top;return this.zoomRatio?{x:Math.round((a.clientX-c)/this.zoomRatio),y:Math.round((a.clientY-b)/this.zoomRatio)}:{x:Math.round(a.clientX-c),y:Math.round(a.clientY-b)}},resize:function(){var a,c;if(this.gameArea&&this.canvasPercentage&&this.canvas){var b=this.canvas.width,d=this.canvas.height,e=window.getComputedStyle(document.body,null)||{};a=parseFloat(e.marginLeft)||0;var g=parseFloat(e.marginTop)||0;c=parseFloat(e.marginRight)||0;e=parseFloat(e.marginBottom)||0;a+=c;c=g+e;g=window.innerWidth-
a;a=window.innerHeight-c;d=b/d;e=c="";g/a>d?(g=a*d,c=g+"px",e=a+"px"):(c=g+"px",e=Math.round(g/d)+"px");this.zoomRatio=g/b*this.canvasPercentage;this.gameArea.style.width=c;this.gameArea.style.height=e;b=Math.floor(100*this.canvasPercentage)+"%";this.canvas.style.width=b;this.canvas.style.height=b;this.canvas.style.display="block";this.canvas.style.marginLeft="auto";this.canvas.style.marginRight="auto"}}})})},"frozen/GameAction":function(){define(["dcl","dcl/bases/Mixer"],function(b,f){return b(f,
{name:null,behavior:0,amount:0,state:0,statics:{NORMAL:0,DETECT_INITAL_PRESS_ONLY:1,STATE_RELEASED:0,STATE_PRESSED:1,STATE_WAITING_FOR_RELEASE:2,STATE_MOVED:3},constructor:function(){this.reset()},reset:function(){this.state=this.statics.STATE_RELEASED;this.amount=0},tap:function(){this.press();this.release()},press:function(){this.state=this.statics.STATE_PRESSED;this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY&&this.pressAmt(1)},pressAmt:function(b){if(this.state!==this.statics.STATE_WAITING_FOR_RELEASE)this.amount+=
b,this.state=this.statics.STATE_WAITING_FOR_RELEASE},release:function(){this.state=this.statics.STATE_RELEASED},isPressed:function(){return this.state===this.statics.STATE_PRESSED?!0:!1},getAmount:function(){var b=this.amount;if(0!==b)if(this.state===this.statics.STATE_RELEASED)this.amount=0;else if(this.behavior===this.statics.DETECT_INITAL_PRESS_ONLY)this.state=this.statics.STATE_WAITING_FOR_RELEASE,this.amount=0;return b}})})},"frozen/MouseAction":function(){define(["dcl","./GameAction"],function(b,
f){return b(f,{startPosition:null,endPosition:null,position:null,insideCanvas:null,press:b.superCall(function(b){return function(a){this.position=this.startPosition=a;b.apply(this)}}),release:b.superCall(function(b){return function(a){this.endPosition=a;b.apply(this)}})})})},"frozen/TouchAction":function(){define(["dcl","./GameAction"],function(b,f){return b(f,{startPositions:null,endPositions:null,positions:null,insideCanvas:null,press:b.superCall(function(b){return function(a){this.positions=this.startPositions=
a;b.apply(this)}}),release:b.superCall(function(b){return function(a){this.endPositions=a;b.apply(this)}})})})},"dcl/mixins/Cleanup":function(){(function(b){"undefined"!=typeof define?define(["../dcl","./Destroyable"],b):"undefined"!=typeof module?module.exports=b(require("../dcl"),require("./Destroyable")):dclMixinsCleanup=b(dcl,dclMixinsDestroyable)})(function(b,f){return b(f,{declaredClass:"dcl/mixins/Cleanup",constructor:function(){this.__cleanupStack=[]},pushCleanup:function(b,a){var f=a?function(){a(b)}:
function(){b.destroy()};this.__cleanupStack.push(f);return f},popCleanup:function(b){if(b)return this.__cleanupStack.pop();this.__cleanupStack.pop()()},removeCleanup:function(b){for(var a=this.__cleanupStack.length-1;0<=a;--a)if(this.__cleanupStack[a]===b)return this.__cleanupStack.splice(a,1),!0},cleanup:function(){for(;this.__cleanupStack.length;)this.__cleanupStack.pop()()},destroy:function(){this.cleanup()}})})},"dcl/mixins/Destroyable":function(){(function(b){"undefined"!=typeof define?define(["../dcl"],
b):"undefined"!=typeof module?module.exports=b(require("../dcl")):dclMixinsDestroyable=b(dcl)})(function(b){var f=b(null,{declaredClass:"dcl/mixins/Destroyable"});b.chainBefore(f,"destroy");return f})},"hammer/hammer":function(){(function(b,f){function e(){if(!a.READY){a.event.determineEventTypes();for(var c in a.gestures)a.gestures.hasOwnProperty(c)&&a.detection.register(a.gestures[c]);a.event.onTouch(a.DOCUMENT,a.EVENT_MOVE,a.detection.detect);a.event.onTouch(a.DOCUMENT,a.EVENT_END,a.detection.detect);
a.READY=!0}}var a=function(c,b){return new a.Instance(c,b||{})};a.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};a.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled;a.HAS_TOUCHEVENTS="ontouchstart"in b;a.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;a.NO_MOUSEEVENTS=a.HAS_TOUCHEVENTS&&navigator.userAgent.match(a.MOBILE_REGEX);a.EVENT_TYPES={};a.DIRECTION_DOWN=
"down";a.DIRECTION_LEFT="left";a.DIRECTION_UP="up";a.DIRECTION_RIGHT="right";a.POINTER_MOUSE="mouse";a.POINTER_TOUCH="touch";a.POINTER_PEN="pen";a.EVENT_START="start";a.EVENT_MOVE="move";a.EVENT_END="end";a.DOCUMENT=document;a.plugins={};a.READY=!1;a.Instance=function(c,b){var f=this;e();this.element=c;this.enabled=!0;this.options=a.utils.extend(a.utils.extend({},a.defaults),b||{});this.options.stop_browser_behavior&&a.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);
a.event.onTouch(c,a.EVENT_START,function(c){f.enabled&&a.detection.startDetect(f,c)});return this};a.Instance.prototype={on:function(a,b){for(var e=a.split(" "),i=0;i<e.length;i++)this.element.addEventListener(e[i],b,!1);return this},off:function(a,b){for(var e=a.split(" "),i=0;i<e.length;i++)this.element.removeEventListener(e[i],b,!1);return this},trigger:function(c,b){var e=a.DOCUMENT.createEvent("Event");e.initEvent(c,!0,!0);e.gesture=b;var i=this.element;if(a.utils.hasParent(b.target,i))i=b.target;
i.dispatchEvent(e);return this},enable:function(a){this.enabled=a;return this}};var h=null,l=!1,j=!1;a.event={bindDom:function(a,b,e){for(var b=b.split(" "),i=0;i<b.length;i++)a.addEventListener(b[i],e,!1)},onTouch:function(c,b,e){var i=this;this.bindDom(c,a.EVENT_TYPES[b],function(f){var n=f.type.toLowerCase();if(!n.match(/mouse/)||!j){n.match(/touch/)||n.match(/pointerdown/)||n.match(/mouse/)&&1===f.which?l=!0:n.match(/mouse/)&&1!==f.which&&(l=!1);n.match(/touch|pointer/)&&(j=!0);var o=0;if(l){a.HAS_POINTEREVENTS&&
b!=a.EVENT_END?o=a.PointerEvent.updatePointer(b,f):n.match(/touch/)?o=f.touches.length:j||(o=n.match(/up/)?0:1);if(0<o&&b==a.EVENT_END)b=a.EVENT_MOVE;else if(!o)b=a.EVENT_END;!o&&null!==h?f=h:h=f;e.call(a.detection,i.collectEventData(c,b,f));a.HAS_POINTEREVENTS&&b==a.EVENT_END&&(o=a.PointerEvent.updatePointer(b,f))}o||(h=null,j=l=!1,a.PointerEvent.reset())}})},determineEventTypes:function(){var c;c=a.HAS_POINTEREVENTS?a.PointerEvent.getEvents():a.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:
["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];a.EVENT_TYPES[a.EVENT_START]=c[0];a.EVENT_TYPES[a.EVENT_MOVE]=c[1];a.EVENT_TYPES[a.EVENT_END]=c[2]},getTouchList:function(c){if(a.HAS_POINTEREVENTS)return a.PointerEvent.getTouchList();if(c.touches)return c.touches;c.indentifier=1;return[c]},collectEventData:function(c,b,e){var c=this.getTouchList(e,b),i=a.POINTER_TOUCH;if(e.type.match(/mouse/)||a.PointerEvent.matchType(a.POINTER_MOUSE,e))i=a.POINTER_MOUSE;return{center:a.utils.getCenter(c),
timeStamp:(new Date).getTime(),target:e.target,touches:c,eventType:b,pointerType:i,srcEvent:e,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return a.detection.stopDetect()}}}};a.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];Object.keys(a.pointers).sort().forEach(function(e){b.push(a.pointers[e])});
return b},updatePointer:function(c,b){c==a.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b);return Object.keys(this.pointers).length},matchType:function(c,b){if(!b.pointerType)return!1;var e={};e[a.POINTER_MOUSE]=b.pointerType==b.MSPOINTER_TYPE_MOUSE||b.pointerType==a.POINTER_MOUSE;e[a.POINTER_TOUCH]=b.pointerType==b.MSPOINTER_TYPE_TOUCH||b.pointerType==a.POINTER_TOUCH;e[a.POINTER_PEN]=b.pointerType==b.MSPOINTER_TYPE_PEN||b.pointerType==a.POINTER_PEN;return e[c]},
getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};a.utils={extend:function(a,b,e){for(var i in b)a[i]!==f&&e||(a[i]=b[i]);return a},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],e=[],i=0,f=a.length;i<f;i++)b.push(a[i].pageX),e.push(a[i].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,
e)+Math.max.apply(Math,e))/2}},getVelocity:function(a,b,e){return{x:Math.abs(b/a)||0,y:Math.abs(e/a)||0}},getAngle:function(a,b){return 180*Math.atan2(b.pageY-a.pageY,b.pageX-a.pageX)/Math.PI},getDirection:function(c,b){var e=Math.abs(c.pageX-b.pageX),f=Math.abs(c.pageY-b.pageY);return e>=f?0<c.pageX-b.pageX?a.DIRECTION_LEFT:a.DIRECTION_RIGHT:0<c.pageY-b.pageY?a.DIRECTION_UP:a.DIRECTION_DOWN},getDistance:function(a,b){var e=b.pageX-a.pageX,f=b.pageY-a.pageY;return Math.sqrt(e*e+f*f)},getScale:function(a,
b){return 2<=a.length&&2<=b.length?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return 2<=a.length&&2<=b.length?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(c){return c==a.DIRECTION_UP||c==a.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var e,f="webkit,khtml,moz,ms,o,".split(",");if(b&&a.style){for(var h=0;h<f.length;h++)for(var j in b)b.hasOwnProperty(j)&&(e=j,f[h]&&(e=f[h]+e.substring(0,1).toUpperCase()+e.substring(1)),
a.style[e]=b[j]);if("none"==b.userSelect)a.onselectstart=function(){return!1}}}};a.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(c,b){if(!this.current)this.stopped=!1,this.current={inst:c,startEvent:a.utils.extend({},b),lastEvent:!1,name:""},this.detect(b)},detect:function(c){if(this.current&&!this.stopped){for(var c=this.extendEventData(c),b=this.current.inst.options,e=0,f=this.gestures.length;e<f;e++){var h=this.gestures[e];if(!this.stopped&&!1!==b[h.name]&&!1===
h.handler.call(h,c,this.current.inst)){this.stopDetect();break}}if(this.current)this.current.lastEvent=c;c.eventType==a.EVENT_END&&!c.touches.length-1&&this.stopDetect();return c}},stopDetect:function(){this.previous=a.utils.extend({},this.current);this.current=null;this.stopped=!0},extendEventData:function(c){var b=this.current.startEvent;if(b&&(c.touches.length!=b.touches.length||c.touches===b.touches)){b.touches=[];for(var e=0,f=c.touches.length;e<f;e++)b.touches.push(a.utils.extend({},c.touches[e]))}var e=
c.timeStamp-b.timeStamp,f=c.center.pageX-b.center.pageX,h=c.center.pageY-b.center.pageY,j=a.utils.getVelocity(e,f,h);a.utils.extend(c,{deltaTime:e,deltaX:f,deltaY:h,velocityX:j.x,velocityY:j.y,distance:a.utils.getDistance(b.center,c.center),angle:a.utils.getAngle(b.center,c.center),direction:a.utils.getDirection(b.center,c.center),scale:a.utils.getScale(b.touches,c.touches),rotation:a.utils.getRotation(b.touches,c.touches),startEvent:b});return c},register:function(c){var b=c.defaults||{};b[c.name]===
f&&(b[c.name]=!0);a.utils.extend(a.defaults,b,!0);c.index=c.index||1E3;this.gestures.push(c);this.gestures.sort(function(a,c){return a.index<c.index?-1:a.index>c.index?1:0});return this.gestures}};a.gestures=a.gestures||{};a.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(c,b){switch(c.eventType){case a.EVENT_START:clearTimeout(this.timer);a.detection.current.name=this.name;this.timer=setTimeout(function(){"hold"==a.detection.current.name&&
b.trigger("hold",c)},b.options.hold_timeout);break;case a.EVENT_MOVE:c.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case a.EVENT_END:clearTimeout(this.timer)}}};a.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(c,b){if(c.eventType==a.EVENT_END){var e=a.detection.previous,f=!1;if(!(c.deltaTime>b.options.tap_max_touchtime||c.distance>b.options.tap_max_distance))if(e&&
"tap"==e.name&&c.timeStamp-e.lastEvent.timeStamp<b.options.doubletap_interval&&c.distance<b.options.doubletap_distance&&(b.trigger("doubletap",c),f=!0),!f||b.options.tap_always)a.detection.current.name="tap",b.trigger(a.detection.current.name,c)}}};a.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(b,d){if(b.eventType==a.EVENT_END&&!(0<d.options.swipe_max_touches&&b.touches.length>d.options.swipe_max_touches)&&(b.velocityX>d.options.swipe_velocity||
b.velocityY>d.options.swipe_velocity))d.trigger(this.name,b),d.trigger(this.name+b.direction,b)}};a.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(b,d){if(a.detection.current.name!=this.name&&this.triggered)d.trigger(this.name+"end",b),this.triggered=!1;else if(!(0<d.options.drag_max_touches&&b.touches.length>
d.options.drag_max_touches))switch(b.eventType){case a.EVENT_START:this.triggered=!1;break;case a.EVENT_MOVE:if(b.distance<d.options.drag_min_distance&&a.detection.current.name!=this.name)break;if(a.detection.current.name!=this.name&&(a.detection.current.name=this.name,d.options.correct_for_drag_min_distance)){var e=Math.abs(d.options.drag_min_distance/b.distance);a.detection.current.startEvent.center.pageX+=b.deltaX*e;a.detection.current.startEvent.center.pageY+=b.deltaY*e;b=a.detection.extendEventData(b)}if(a.detection.current.lastEvent.drag_locked_to_axis||
d.options.drag_lock_to_axis&&d.options.drag_lock_min_distance<=b.distance)b.drag_locked_to_axis=!0;e=a.detection.current.lastEvent.direction;if(b.drag_locked_to_axis&&e!==b.direction)b.direction=a.utils.isVertical(e)?0>b.deltaY?a.DIRECTION_UP:a.DIRECTION_DOWN:0>b.deltaX?a.DIRECTION_LEFT:a.DIRECTION_RIGHT;if(!this.triggered)d.trigger(this.name+"start",b),this.triggered=!0;d.trigger(this.name,b);d.trigger(this.name+b.direction,b);(d.options.drag_block_vertical&&a.utils.isVertical(b.direction)||d.options.drag_block_horizontal&&
!a.utils.isVertical(b.direction))&&b.preventDefault();break;case a.EVENT_END:this.triggered&&d.trigger(this.name+"end",b),this.triggered=!1}}};a.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(b,d){if(a.detection.current.name!=this.name&&this.triggered)d.trigger(this.name+"end",b),this.triggered=!1;else if(!(2>b.touches.length))switch(d.options.transform_always_block&&b.preventDefault(),
b.eventType){case a.EVENT_START:this.triggered=!1;break;case a.EVENT_MOVE:var e=Math.abs(1-b.scale),f=Math.abs(b.rotation);if(e<d.options.transform_min_scale&&f<d.options.transform_min_rotation)break;a.detection.current.name=this.name;if(!this.triggered)d.trigger(this.name+"start",b),this.triggered=!0;d.trigger(this.name,b);f>d.options.transform_min_rotation&&d.trigger("rotate",b);e>d.options.transform_min_scale&&(d.trigger("pinch",b),d.trigger("pinch"+(1>b.scale?"in":"out"),b));break;case a.EVENT_END:this.triggered&&
d.trigger(this.name+"end",b),this.triggered=!1}}};a.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(b,d){d.options.prevent_mouseevents&&b.pointerType==a.POINTER_MOUSE?b.stopDetect():(d.options.prevent_default&&b.preventDefault(),b.eventType==a.EVENT_START&&d.trigger(this.name,b))}};a.gestures.Release={name:"release",index:Infinity,handler:function(b,d){b.eventType==a.EVENT_END&&d.trigger(this.name,b)}};"function"==typeof define&&"object"==
typeof define.amd&&define.amd?(b.Hammer=a,define(function(){return a})):"object"===typeof module&&"object"===typeof module.exports?module.exports=a:b.Hammer=a})(this)},"frozen/ResourceManager":function(){define("require,./plugins/sound!,dcl,dcl/bases/Mixer,lodash,dojo/on".split(","),function(b,f,e,a,h,l){function j(a,b){var c=b;a&&(c=[a,b].join("/"));return c.replace(/\/{2,}/g,"/")}function c(a){var b=document.createElement("canvas");b.height=a.height;b.width=a.width;var c=b.getContext("2d");c.translate(b.width,
0);c.scale(-1,1);c.drawImage(a,0,0);return b.toDataURL()}function d(a){var b=document.createElement("canvas");b.height=a.height;b.width=a.width;var c=b.getContext("2d");c.translate(0,b.height);c.scale(1,-1);c.drawImage(a,0,0);return b.toDataURL()}var k=e(null,{name:"",img:null,complete:!1,constructor:function(a){var b=this;b.name=a;b.img=new Image;l.once(b.img,"load",function(){b.complete=!0})},load:function(){this.img.src=b.toUrl(this.name)}});return e(a,{allLoaded:!1,imageDir:null,soundDir:null,
resourceList:{},loadImage:function(a){var b=!1;if("object"!==typeof a)if("string"===typeof a)b=!0,a=[a];else return;var c=this,a=h.transform(a,function(a,b,d){b=j(c.imageDir,b);if(c.resourceList[b])return a[d]=c.resourceList[b].img;c.allLoaded=!1;var e=new k(b);e.load();c.resourceList[b]=e;a[d]=e.img});return b?a[0]:a},loadSound:function(a){var b=!1;if("object"!==typeof a)if("string"===typeof a)b=!0,a=[a];else return;var c=this,a=h.transform(a,function(a,b,d){b=j(c.soundDir,b);if(c.resourceList[b])return a[d]=
c.resourceList[b];c.allLoaded=!1;var e=new f(b);c.resourceList[b]=e;a[d]=e});return b?a[0]:a},flipImage:function(a,b,c){this.allLoaded=!1;var d=new k(a);this.resourceList[a]=d;l.once(b,"load",function(){d.img.src=c(b)});h.any(this.resourceList,function(a){if(a.img===b&&a.complete)return d.img.src=c(b),!0});return d.img},flipImageX:function(a,b){return this.flipImage(a,b,c)},flipImageY:function(a,b){return this.flipImage(a,b,d)},resourcesReady:function(){if(!this.allLoaded){for(var a in this.resourceList)if(!this.resourceList[a].complete)return!1;
this.allLoaded=!0}return!0},getPercentComplete:function(){var a=0,b=0,c;for(c in this.resourceList){var d=this.resourceList[c];b++;d.complete&&(a+=1)}return 0===b?0:Math.round(100*(a/b))}})})},"frozen/plugins/sound":function(){define(["../sounds/Sound","../sounds/WebAudio","../sounds/HTML5Audio","dojo/has"],function(b,f,e,a){return{load:function(h,l,j){return a("WebAudio")?j(f):a("HTML5Audio")?j(e):j(b)}}})},"frozen/sounds/Sound":function(){define(["dcl","dojo/has","dojo/sniff"],function(b,f){f.add("shittySound",
function(){return!(!f("android")&&!f("ios")||!f("webkit"))});return b(null,{declaredClass:"frozen/sounds/Sound",name:null,complete:!1,formats:{"audio/mpeg":".mp3","audio/webm":".webm","audio/ogg":".ogg","audio/wav":".wav","audio/aac":".aac","audio/x-m4a":".m4a"},probably:null,maybe:null,constructor:function(b){if(!this.probably)this.probably=[];if(!this.maybe)this.maybe=[];"string"===typeof b&&this.load(b)},load:function(b){this.name=b;this.complete=!0},loop:function(){},play:function(){},_initAudio:function(){},
_chooseFormat:function(){if(!this.probably.length&&!this.maybe.length){var b=new Audio,a,f;for(a in this.formats)f=b.canPlayType(a),"probably"===f?this.probably.push(this.formats[a]):"maybe"===f&&this.maybe.push(this.formats[a])}return this.probably.length?this.probably[0]:this.maybe.length?this.maybe[0]:""},_nextFormat:function(){if(1<this.probably.length)return this.probably.shift(),this.probably[0];if(1===this.probably.length&&(this.probably.length=0,this.maybe.length))return this.maybe[0];if(1<
this.maybe.length)return this.maybe.shift(),this.maybe[0];if(1===this.maybe.length)this.maybe.length=0;return""}})})},"frozen/sounds/WebAudio":function(){define("require,./Sound,../utils/removeExtension,dcl,dojo/on,dojo/has,../shims/AudioContext".split(","),function(b,f,e,a,h,l){l.add("WebAudio",function(a){return!!a.AudioContext});var j=null;if(l("WebAudio")&&(j=new window.AudioContext,l("shittySound")))h.once(document,"touchstart",function(){var a=j.createBufferSource();a.buffer=j.createBuffer(1,
1,22050);a.connect(j.destination);a.noteOn(0)});return a(f,{declaredClass:"frozen/sounds/WebAudio",audioContext:j,buffer:null,load:function(a){var d=this;this.name=a;var f=e(a);f===a&&(a=f+this._chooseFormat());a=b.toUrl(a);f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType="arraybuffer";h.once(f,"load",function(a){d.audioContext.decodeAudioData(a.target.response,function(a){d.buffer=a;d.complete=!0},function(){d._nextFormat()?d.load(d.name):d.complete=!0})});f.send()},loop:function(a){this.buffer&&
this._initAudio(a,!0).noteOn(0)},play:function(a,b){this.buffer&&this._initAudio(a,!1).noteOn(b||0)},_initAudio:function(a,b){var b="boolean"===typeof b?b:!1,e=this.audioContext.createBufferSource();e.buffer=this.buffer;e.loop=b;if(a){var f=this.audioContext.createGainNode();f.gain.value=a;e.connect(f);f.connect(this.audioContext.destination)}else e.connect(this.audioContext.destination);return e}})})},"frozen/utils/removeExtension":function(){define(function(){return function(b){return b.replace(/(.*)\.[^.]{1,4}$/,
"")}})},"frozen/shims/AudioContext":function(){define(function(){for(var b=["ms","moz","webkit","o"],f=0;f<b.length&&!window.AudioContext;++f)window.AudioContext=window[b[f]+"AudioContext"]})},"frozen/sounds/HTML5Audio":function(){define("require,./Sound,../utils/removeExtension,dcl,dojo/on,dojo/has".split(","),function(b,f,e,a,h,l){l.add("HTML5Audio",function(a){return!!a.Audio});return a(f,{declaredClass:"frozen/sounds/HTML5Audio",audio:null,load:function(a){this.audio=new Audio;var c=this;this.name=
a;var d=e(a);d===a&&(a=d+this._chooseFormat());a=b.toUrl(a);if(l("shittySound"))h.once(document,"touchstart",function(){var a=c.audio.volume;c.audio.volume=0;c.audio.play();c.audio.pause();c.audio.volume=a}),this._updateCurrentTime=null,h.once(this.audio,"progress",function(){null!==c._updateCurrentTime&&c._updateCurrentTime()});this.audio.pause();this.audio.preload="auto";h.once(this.audio,"error",function(){c._nextFormat()?c.load(c.name):(c.audio.src=null,c.complete=!0)});h.once(this.audio,"loadeddata",
function(){c.complete=!0});this.audio.src=a},loop:function(a){var b=this._initAudio(a,!0);h.once(b,"loadeddata",function(){b.play()})},play:function(a,b){b=b||0;if(l("shittySound"))try{return this.audio.currentTime=b/1E3,this.audio.play()}catch(d){return this._updateCurrentTime=function(){this._updateCurrentTime=null;this.audio.currentTime=b/1E3;return this.audio.play()},this.audio.play()}var e=this._initAudio(a,!1);h.once(e,"loadeddata",function(){e.currentTime=b/1E3;e.play()})},_initAudio:function(a,
b){var b="boolean"===typeof b?b:!1,d=new Audio;d.pause();d.volume=a||1;d.loop=b;d.preload="auto";d.mozLoadFrom?d.mozLoadFrom(this.audio):d.src=this.audio.currentSrc;return d}})})},"frozen/shims/RAF":function(){define(function(){for(var b=0,f=["ms","moz","webkit","o"],e=0;e<f.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[f[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[e]+"CancelAnimationFrame"]||window[f[e]+"CancelRequestAnimationFrame"];if(!window.requestAnimationFrame)window.requestAnimationFrame=
function(a){var e=(new Date).getTime(),f=Math.max(0,16-(e-b)),j=window.setTimeout(function(){a(e+f)},f);b=e+f;return j};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(a){clearTimeout(a)}})},"game/ui/CanvasDND":function(){define(["../state","../createBodies","./DNDFileController","dcl"],function(b,f,e,a){return a([e],{id:"canvas",game:null,drop:function(a){var e=this;try{var f=a.dataTransfer.files;if(f&&1===f.length&&f[0].type.match(/image.*/)){var c=f[0],d=new FileReader;d.onerror=
function(){};d.onload=function(a){if(a.target.readyState===FileReader.DONE){var c=new Image;c.onload=function(){e.game.stop();b.backImg=c;e.game.setHeight(c.height);e.game.setWidth(c.width);e.game.createBodies();e.game.run()};c.src=a.target.result}};d.readAsDataURL(c);this.dragleave(a)}}catch(k){}}})})},"game/ui/DNDFileController":function(){define("dcl,dcl/bases/Mixer,dojo/_base/lang,dojo/on,dojo/dom,dojo/domReady!".split(","),function(b,f,e,a,h){return b([f],{node:null,borderStyle:null,borderDropStyle:"3px dashed red",
constructor:function(){if(!this.node)this.node=h.byId(this.id);a(this.node,"dragenter",e.hitch(this,"dragenter"));a(this.node,"dragover",e.hitch(this,"dragover"));a(this.node,"dragleave",e.hitch(this,"dragleave"));a(this.node,"drop",e.hitch(this,"drop"));this.borderStyle=this.node.style.border},dragenter:function(a){a.stopPropagation();a.preventDefault();this.node.style.border=this.borderDropStyle},dragover:function(a){a.stopPropagation();a.preventDefault()},dragleave:function(a){a.stopPropagation();
a.preventDefault();this.node.style.border=this.borderStyle},preDrop:function(a){this.node.style.border=this.borderStyle;a.stopPropagation();a.preventDefault();this.drop(a)},drop:function(a){var b=function(){},c=function(){return function(){}};try{for(var d=a.dataTransfer.files,a=0;a<d.length;a++){var e=new FileReader;e.onerror=b;e.onload=c(d[a]);e.readAsDataURL(d[a])}return!1}catch(f){}}})})},"frozen/plugins/loadImage":function(){define(["../ResourceManager","../utils/parseString"],function(b,f){var e=
new b;return{load:function(a,b,l){a=f(a);a=e.loadImage(a);l(a)}}})},"frozen/utils/parseString":function(){define(function(){return function(b){0===b.indexOf("{")&&b.lastIndexOf("}")===b.length-1?b=JSON.parse(b.replace(/,/g,'","').replace(/:(?!\/\/)/g,'":"').replace(/\{/,'{"').replace(/\}/,'"}')):0===b.indexOf("[")&&b.lastIndexOf("]")===b.length-1&&(b=JSON.parse(b.replace(/,/g,'","').replace(/\[/g,'["').replace(/\]/g,'"]')));return b}})},"frozen/plugins/loadSound":function(){define(["../ResourceManager",
"../utils/parseString"],function(b,f){var e=new b;return{load:function(a,b,l){a=f(a);a=e.loadSound(a);l(a)}}})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(b,f,e,a,h){function l(c,d){var f=c.xhr;c.status=c.xhr.status;c.text=f.responseText;if("xml"===c.options.handleAs)c.data=f.responseXML;if(!d)try{e(c)}catch(i){d=i}d?this.reject(d):a.checkStatus(f.status)?this.resolve(c):(d=new b("Unable to load "+c.url+" status: "+f.status,c),
this.reject(d))}function j(e,g,o){var q=a.parseArgs(e,a.deepCreate(n,g),h("native-formdata")&&g&&g.data&&g.data instanceof FormData),e=q.url,g=q.options,t,u=a.deferred(q,i,c,d,l,function(){t&&t()}),s=q.xhr=j._create();if(!s)return u.cancel(new b("XHR was not created")),o?u:u.promise;q.getHeader=function(a){return this.xhr.getResponseHeader(a)};k&&(t=k(s,u,q));var y=g.data,E=!g.sync,D=g.method;try{s.open(D,e,E,g.user||m,g.password||m);if(g.withCredentials)s.withCredentials=g.withCredentials;var x=
g.headers,O;if(x)for(var F in x)"content-type"===F.toLowerCase()?O=x[F]:x[F]&&s.setRequestHeader(F,x[F]);O&&!1!==O&&s.setRequestHeader("Content-Type",O);(!x||!("X-Requested-With"in x))&&s.setRequestHeader("X-Requested-With","XMLHttpRequest");a.notify&&a.notify.emit("send",q,u.promise.cancel);s.send(y)}catch(ka){u.reject(ka)}f(u);s=null;return o?u:u.promise}h.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});h.add("dojo-force-activex-xhr",function(){return h("activex")&&!document.addEventListener&&
"file:"===window.location.protocol});h.add("native-xhr2",function(){if(h("native-xhr")){var a=new XMLHttpRequest;return"undefined"!==typeof a.addEventListener&&("undefined"===typeof opera||"undefined"!==typeof a.upload)}});h.add("native-formdata",function(){return"function"===typeof FormData});var c,d,k,i;h("native-xhr2")?(c=function(){return!this.isFulfilled()},i=function(a,b){b.xhr.abort()},k=function(a,c,d){function e(){c.handleResponse(d)}function f(a){a=new b("Unable to load "+d.url+" status: "+
a.target.status,d);c.handleResponse(d,a)}function i(a){if(a.lengthComputable)d.loaded=a.loaded,d.total=a.total,c.progress(d)}a.addEventListener("load",e,!1);a.addEventListener("error",f,!1);a.addEventListener("progress",i,!1);return function(){a.removeEventListener("load",e,!1);a.removeEventListener("error",f,!1);a.removeEventListener("progress",i,!1)}}):(c=function(a){return a.xhr.readyState},d=function(a){return 4===a.xhr.readyState},i=function(a,b){var c=b.xhr,d=typeof c.abort;("function"===d||
"object"===d||"unknown"===d)&&c.abort()});var m,n={data:null,query:null,sync:!1,method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}};j._create=function(){throw Error("XMLHTTP not available");};if(h("native-xhr")&&!h("dojo-force-activex-xhr"))j._create=function(){return new XMLHttpRequest};else if(h("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),j._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(o){try{new ActiveXObject("Microsoft.XMLHTTP"),j._create=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}catch(q){}}a.addCommonMethods(j);
return j})},"dojo/errors/RequestError":function(){define(["./create"],function(b){return b("RequestError",function(b,e){this.response=e})})},"dojo/errors/create":function(){define(["../_base/lang"],function(b){return function(f,e,a,h){var a=a||Error,l=function(b){if(a===Error){Error.captureStackTrace&&Error.captureStackTrace(this,l);var c=Error.call(this,b),d;for(d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.message=b;this.stack=c.stack}else a.apply(this,arguments);e&&e.apply(this,arguments)};l.prototype=
b.delegate(a.prototype,h);l.prototype.name=f;return l.prototype.constructor=l}})},"dojo/request/watch":function(){define("./util,../errors/RequestTimeoutError,../errors/CancelError,../_base/array,../_base/window,require".split(","),function(b,f,e,a,h,l){function j(){for(var a=+new Date,b=0,e;b<k.length&&(e=k[b]);b++){var h=e.response,j=h.options;if(e.isCanceled&&e.isCanceled()||e.isValid&&!e.isValid(h))k.splice(b--,1),c._onAction&&c._onAction();else if(e.isReady&&e.isReady(h))k.splice(b--,1),e.handleResponse(h),
c._onAction&&c._onAction();else if(e.startTime&&e.startTime+(j.timeout||0)<a)k.splice(b--,1),e.cancel(new f("Timeout exceeded",h)),c._onAction&&c._onAction()}c._onInFlight&&c._onInFlight(e);k.length||(clearInterval(d),d=null)}function c(a){if(a.response.options.timeout)a.startTime=+new Date;a.isFulfilled()||(k.push(a),d||(d=setInterval(j,50)),a.response.options.sync&&j())}var d=null,k=[];c.cancelAll=function(){try{a.forEach(k,function(a){try{a.cancel(new e("All requests canceled."))}catch(b){}})}catch(b){}};
h&&l&&h.doc.attachEvent&&l(h.global,"unload",function(){c.cancelAll()});return c})},"dojo/request/util":function(){define("exports,../errors/RequestError,../errors/CancelError,../Deferred,../io-query,../_base/array,../_base/lang".split(","),function(b,f,e,a,h,l,j){function c(a){return d(a)}b.deepCopy=function(a,c){for(var d in c){var e=a[d],f=c[d];e!==f&&(e&&"object"===typeof e&&f&&"object"===typeof f?b.deepCopy(e,f):a[d]=f)}return a};b.deepCreate=function(a,c){var c=c||{},d=j.delegate(a),e,f;for(e in a)(f=
a[e])&&"object"===typeof f&&(d[e]=b.deepCreate(f,c[e]));return b.deepCopy(d,c)};var d=Object.freeze||function(a){return a};b.deferred=function(h,i,l,n,o,q){var p=new a(function(a){i&&i(p,h);return!a||!(a instanceof f)&&!(a instanceof e)?new e("Request canceled",h):a});p.response=h;p.isValid=l;p.isReady=n;p.handleResponse=o;l=p.then(c).otherwise(function(a){a.response=h;throw a;});b.notify&&l.then(j.hitch(b.notify,"emit","load"),j.hitch(b.notify,"emit","error"));n=l.then(function(a){return a.data||
a.text});l=d(j.delegate(n,{response:l}));q&&p.then(function(a){q.call(p,a)},function(a){q.call(p,h,a)});p.promise=l;p.then=l.then;return p};b.addCommonMethods=function(a,b){l.forEach(b||["GET","POST","PUT","DELETE"],function(b){a[("DELETE"===b?"DEL":b).toLowerCase()]=function(c,d){d=j.delegate(d||{});d.method=b;return a(c,d)}})};b.parseArgs=function(a,b,c){var d=b.data,e=b.query;if(d&&!c&&"object"===typeof d)b.data=h.objectToQuery(d);e?("object"===typeof e&&(e=h.objectToQuery(e)),b.preventCache&&
(e+=(e?"&":"")+"request.preventCache="+ +new Date)):b.preventCache&&(e="request.preventCache="+ +new Date);a&&e&&(a+=(~a.indexOf("?")?"&":"?")+e);return{url:a,options:b,getHeader:function(){return null}}};b.checkStatus=function(a){a=a||0;return 200<=a&&300>a||304===a||1223===a||!a}})},"dojo/errors/CancelError":function(){define(["./create"],function(b){return b("CancelError",null,null,{dojoType:"cancel"})})},"dojo/Deferred":function(){define("dojo/Deferred",["./has","./_base/lang","./errors/CancelError",
"./promise/Promise","require"],function(b,f,e,a,h){var l=Object.freeze||function(){},j=function(a,b,d,e){for(var f=0;f<a.length;f++)c(a[f],b,d,e)},c=function(a,b,c){var e=a[b],f=a.deferred;if(e)try{var g=e(c);0===b?"undefined"!==typeof g&&k(f,b,g):g&&"function"===typeof g.then?(a.cancel=g.cancel,g.then(d(f,1),d(f,2),d(f,0))):k(f,1,g)}catch(h){k(f,2,h)}else k(f,b,c)},d=function(a,b){return function(c){k(a,b,c)}},k=function(a,b,c){if(!a.isCanceled())switch(b){case 0:a.progress(c);break;case 1:a.resolve(c);
break;case 2:a.reject(c)}},i=function(b){var d=this.promise=new a,f=this,h,k,g=!1,v=[];this.isResolved=d.isResolved=function(){return 1===h};this.isRejected=d.isRejected=function(){return 2===h};this.isFulfilled=d.isFulfilled=function(){return!!h};this.isCanceled=d.isCanceled=function(){return g};this.progress=function(a,b){if(h){if(!0===b)throw Error("This deferred has already been fulfilled.");return d}j(v,0,a,null,f);return d};this.resolve=function(a,b){if(h){if(!0===b)throw Error("This deferred has already been fulfilled.");
return d}j(v,h=1,k=a,null,f);v=null;return d};var r=this.reject=function(a,b){if(h){if(!0===b)throw Error("This deferred has already been fulfilled.");return d}j(v,h=2,k=a,void 0,f);v=null;return d};this.then=d.then=function(a,b,e){var f=[e,a,b];f.cancel=d.cancel;f.deferred=new i(function(a){return f.cancel&&f.cancel(a)});h&&!v?c(f,h,k,void 0):v.push(f);return f.deferred.promise};this.cancel=d.cancel=function(a,c){if(h){if(!0===c)throw Error("This deferred has already been fulfilled.");}else{if(b)var d=
b(a),a="undefined"===typeof d?a:d;g=!0;if(h){if(2===h&&k===a)return a}else return"undefined"===typeof a&&(a=new e),r(a),a}};l(d)};i.prototype.toString=function(){return"[object Deferred]"};h&&h(i);return i})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(b){function f(){throw new TypeError("abstract");}return b.extend(function(){},{then:function(){f()},cancel:function(){f()},isResolved:function(){f()},isRejected:function(){f()},isFulfilled:function(){f()},isCanceled:function(){f()},
always:function(b){return this.then(b,b)},otherwise:function(b){return this.then(null,b)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},"dojo/io-query":function(){define(["./_base/lang"],function(b){var f={};return{objectToQuery:function(e){var a=encodeURIComponent,h=[],l;for(l in e){var j=e[l];if(j!=f[l]){var c=a(l)+"=";if(b.isArray(j))for(var d=0,k=j.length;d<k;++d)h.push(c+a(j[d]));else h.push(c+a(j))}}return h.join("&")},
queryToObject:function(e){for(var a=decodeURIComponent,e=e.split("&"),f={},l,j,c=0,d=e.length;c<d;++c)if(j=e[c],j.length){var k=j.indexOf("=");0>k?(l=a(j),j=""):(l=a(j.slice(0,k)),j=a(j.slice(k+1)));"string"==typeof f[l]&&(f[l]=[f[l]]);b.isArray(f[l])?f[l].push(j):f[l]=j}return f}}})},"dojo/errors/RequestTimeoutError":function(){define(["./create","./RequestError"],function(b,f){return b("RequestTimeoutError",null,f,{dojoType:"timeout"})})},"dojo/request/handlers":function(){define(["../json","../_base/kernel",
"../_base/array","../has"],function(b,f,e,a){function h(a){var b=c[a.options.handleAs];a.data=b?b(a):a.data||a.text;return a}a.add("activex","undefined"!==typeof ActiveXObject);var l;if(a("activex")){var j=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"];l=function(a){var b=a.data;if(!b||!b.documentElement){var c=a.text;e.some(j,function(a){try{var d=new ActiveXObject(a);d.async=!1;d.loadXML(c);b=d}catch(e){return!1}return!0})}return b}}var c={javascript:function(a){return f.eval(a.text||
"")},json:function(a){return b.parse(a.text||null)},xml:l};h.register=function(a,b){c[a]=b};return h})},"dojo/json":function(){define(["./has"],function(b){var f="undefined"!=typeof JSON;b.add("json-parse",f);b.add("json-stringify",f&&'{"a":1}'==JSON.stringify({a:0},function(a,b){return b||1}));if(b("json-stringify"))return JSON;var e=function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,
"\\r")};return{parse:b("json-parse")?JSON.parse:function(a,b){if(b&&!/^([\s\[\{]*(?:"(?:\\.|[^"])+"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(a))throw new SyntaxError("Invalid characters in JSON");return eval("("+a+")")},stringify:function(a,b,f){function j(a,k,i){b&&(a=b(i,a));var m;m=typeof a;if("number"==m)return isFinite(a)?a+"":"null";if("boolean"==m)return a+"";if(null===a)return"null";if("string"==typeof a)return e(a);if("function"==m||"undefined"==m)return c;
if("function"==typeof a.toJSON)return j(a.toJSON(i),k,i);if(a instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(b,c,e){b=a["getUTC"+c]()+(e?1:0);return 10>b?"0"+b:b});if(a.valueOf()!==a)return j(a.valueOf(),k,i);var n=f?k+f:"",o=f?" ":"",q=f?"\n":"";if(a instanceof Array){for(var o=a.length,p=[],i=0;i<o;i++)m=j(a[i],n,i),"string"!=typeof m&&(m="null"),p.push(q+n+m);return"["+p.join(",")+q+k+"]"}p=[];for(i in a){var g;if(a.hasOwnProperty(i)){if("number"==
typeof i)g='"'+i+'"';else if("string"==typeof i)g=e(i);else continue;m=j(a[i],n,i);"string"==typeof m&&p.push(q+n+g+":"+o+m)}}return"{"+p.join(",")+q+k+"}"}var c;"string"==typeof b&&(f=b,b=null);return j(a,"","")}}})}}});(function(){require({cache:{}});require.boot&&require.apply(null,require.boot)})();